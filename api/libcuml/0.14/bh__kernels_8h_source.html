<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
 <head>
  <meta content="text/xhtml;charset=utf-8" http-equiv="Content-Type"/>
  <meta content="IE=9" http-equiv="X-UA-Compatible"/>
  <meta content="Doxygen 1.8.18" name="generator"/>
  <meta content="width=device-width, initial-scale=1" name="viewport"/>
  <title>
   cuML C++ API: /rapids/cuml/cpp/src/tsne/bh_kernels.h Source File
  </title>
  <link href="tabs.css" rel="stylesheet" type="text/css"/>
  <script src="jquery.js" type="text/javascript">
  </script>
  <script src="dynsections.js" type="text/javascript">
  </script>
  <link href="search/search.css" rel="stylesheet" type="text/css"/>
  <script src="search/searchdata.js" type="text/javascript">
  </script>
  <script src="search/search.js" type="text/javascript">
  </script>
  <script type="text/x-mathjax-config">
   MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
  </script>
  <script async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js" type="text/javascript">
  </script>
  <link href="doxygen.css" rel="stylesheet" type="text/css"/>
  <link href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" id="rapids-fa-tag" rel="stylesheet"/>
  <link href="/assets/css/custom.css" id="rapids-selector-css" rel="stylesheet"/>
 </head>
 <body>
  <div id="top">
   <!-- do not remove this div, it is closed by doxygen! -->
   <div id="titlearea">
    <div id="rapids-doxygen-container">
     <div class="rapids-home-container">
      <a class="rapids-home-container__home-btn" href="/api">
       Home
      </a>
     </div>
     <div class="rapids-selector__container rapids-selector--hidden">
      <div class="rapids-selector__selected">
       libcuml
      </div>
      <div class="rapids-selector__menu">
       <a class="rapids-selector__menu-item" href="/api/clx/stable/api.html">
        clx
       </a>
       <a class="rapids-selector__menu-item" href="/api/cudf/stable/api.html">
        cudf
       </a>
       <a class="rapids-selector__menu-item" href="/api/cugraph/stable/api.html">
        cugraph
       </a>
       <a class="rapids-selector__menu-item" href="/api/cuml/stable/api.html">
        cuml
       </a>
       <a class="rapids-selector__menu-item" href="/api/cusignal/stable/api.html">
        cusignal
       </a>
       <a class="rapids-selector__menu-item" href="/api/cuspatial/stable/api.html">
        cuspatial
       </a>
       <a class="rapids-selector__menu-item" href="/api/cuxfilter/stable">
        cuxfilter
       </a>
       <a class="rapids-selector__menu-item" href="/api/libcudf/stable/namespacecudf.html">
        libcudf
       </a>
       <a class="rapids-selector__menu-item rapids-selector__menu-item--selected" href="/api/libcuml/nightly">
        libcuml
       </a>
       <a class="rapids-selector__menu-item" href="/api/libnvstrings/stable/annotated.html">
        libnvstrings
       </a>
       <a class="rapids-selector__menu-item" href="/api/nvstrings/stable/api.html">
        nvstrings
       </a>
       <a class="rapids-selector__menu-item" href="/api/rmm/stable/annotated.html">
        rmm
       </a>
      </div>
     </div>
     <div class="rapids-selector__container rapids-selector--hidden">
      <div class="rapids-selector__selected">
       nightly (0.14)
      </div>
      <div class="rapids-selector__menu">
       <a class="rapids-selector__menu-item rapids-selector__menu-item--selected" href="/api/libcuml/nightly">
        nightly (0.14)
       </a>
      </div>
     </div>
    </div>
   </div>
   <!-- end header part -->
   <!-- Generated by Doxygen 1.8.18 -->
   <script type="text/javascript">
    /* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
   </script>
   <script src="menudata.js" type="text/javascript">
   </script>
   <script src="menu.js" type="text/javascript">
   </script>
   <script type="text/javascript">
    /* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
   </script>
   <div id="main-nav">
   </div>
   <!-- window showing the filter options -->
   <div id="MSearchSelectWindow" onkeydown="return searchBox.OnSearchSelectKey(event)" onmouseout="return searchBox.OnSearchSelectHide()" onmouseover="return searchBox.OnSearchSelectShow()">
   </div>
   <!-- iframe showing the search results (closed by default) -->
   <div id="MSearchResultsWindow">
    <iframe frameborder="0" id="MSearchResults" name="MSearchResults" src="javascript:void(0)">
    </iframe>
   </div>
   <div class="navpath" id="nav-path">
    <ul>
     <li class="navelem">
      <a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">
       src
      </a>
     </li>
     <li class="navelem">
      <a class="el" href="dir_825cc03e83bcdede75bbfdbabb0c3eb0.html">
       tsne
      </a>
     </li>
    </ul>
   </div>
  </div>
  <!-- top -->
  <div class="header">
   <div class="headertitle">
    <div class="title">
     bh_kernels.h
    </div>
   </div>
  </div>
  <!--header-->
  <div class="contents">
   <a href="bh__kernels_8h.html">
    Go to the documentation of this file.
   </a>
   <div class="fragment">
    <div class="line">
     <a name="l00001">
     </a>
     <span class="lineno">
      1
     </span>
     <span class="comment">
      /*
     </span>
    </div>
    <div class="line">
     <a name="l00002">
     </a>
     <span class="lineno">
      2
     </span>
     <span class="comment">
      * Copyright (c) 2019, NVIDIA CORPORATION.
     </span>
    </div>
    <div class="line">
     <a name="l00003">
     </a>
     <span class="lineno">
      3
     </span>
     <span class="comment">
      *
     </span>
    </div>
    <div class="line">
     <a name="l00004">
     </a>
     <span class="lineno">
      4
     </span>
     <span class="comment">
      * Licensed under the Apache License, Version 2.0 (the "License");
     </span>
    </div>
    <div class="line">
     <a name="l00005">
     </a>
     <span class="lineno">
      5
     </span>
     <span class="comment">
      * you may not use this file except in compliance with the License.
     </span>
    </div>
    <div class="line">
     <a name="l00006">
     </a>
     <span class="lineno">
      6
     </span>
     <span class="comment">
      * You may obtain a copy of the License at
     </span>
    </div>
    <div class="line">
     <a name="l00007">
     </a>
     <span class="lineno">
      7
     </span>
     <span class="comment">
      *
     </span>
    </div>
    <div class="line">
     <a name="l00008">
     </a>
     <span class="lineno">
      8
     </span>
     <span class="comment">
      *     http://www.apache.org/licenses/LICENSE-2.0
     </span>
    </div>
    <div class="line">
     <a name="l00009">
     </a>
     <span class="lineno">
      9
     </span>
     <span class="comment">
      *
     </span>
    </div>
    <div class="line">
     <a name="l00010">
     </a>
     <span class="lineno">
      10
     </span>
     <span class="comment">
      * Unless required by applicable law or agreed to in writing, software
     </span>
    </div>
    <div class="line">
     <a name="l00011">
     </a>
     <span class="lineno">
      11
     </span>
     <span class="comment">
      * distributed under the License is distributed on an "AS IS" BASIS,
     </span>
    </div>
    <div class="line">
     <a name="l00012">
     </a>
     <span class="lineno">
      12
     </span>
     <span class="comment">
      * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     </span>
    </div>
    <div class="line">
     <a name="l00013">
     </a>
     <span class="lineno">
      13
     </span>
     <span class="comment">
      * See the License for the specific language governing permissions and
     </span>
    </div>
    <div class="line">
     <a name="l00014">
     </a>
     <span class="lineno">
      14
     </span>
     <span class="comment">
      * limitations under the License.
     </span>
    </div>
    <div class="line">
     <a name="l00015">
     </a>
     <span class="lineno">
      15
     </span>
     <span class="comment">
      */
     </span>
    </div>
    <div class="line">
     <a name="l00016">
     </a>
     <span class="lineno">
      16
     </span>
    </div>
    <div class="line">
     <a name="l00017">
     </a>
     <span class="lineno">
      17
     </span>
     <span class="preprocessor">
      #pragma once
     </span>
    </div>
    <div class="line">
     <a name="l00018">
     </a>
     <span class="lineno">
      18
     </span>
     <span class="preprocessor">
      #define restrict __restrict__
     </span>
    </div>
    <div class="line">
     <a name="l00019">
     </a>
     <span class="lineno">
      <a class="line" href="bh__kernels_8h.html#a080abdcb9c02438f1cd2bb707af25af8">
       19
      </a>
     </span>
    </div>
    <div class="line">
     <a name="l00020">
     </a>
     <span class="lineno">
      20
     </span>
     <span class="preprocessor">
      #define THREADS1 512
     </span>
    </div>
    <div class="line">
     <a name="l00021">
     </a>
     <span class="lineno">
      <a class="line" href="bh__kernels_8h.html#a6cac1d001fa4d6c00a794bc587dac1d2">
       21
      </a>
     </span>
     <span class="preprocessor">
      #define THREADS2 512
     </span>
    </div>
    <div class="line">
     <a name="l00022">
     </a>
     <span class="lineno">
      <a class="line" href="bh__kernels_8h.html#a86edd6193b14e2e0597fddab89881e3a">
       22
      </a>
     </span>
     <span class="preprocessor">
      #define THREADS3 768
     </span>
    </div>
    <div class="line">
     <a name="l00023">
     </a>
     <span class="lineno">
      <a class="line" href="bh__kernels_8h.html#a508375c867f31fb42c1135881ddfd8f3">
       23
      </a>
     </span>
     <span class="preprocessor">
      #define THREADS4 128
     </span>
    </div>
    <div class="line">
     <a name="l00024">
     </a>
     <span class="lineno">
      <a class="line" href="bh__kernels_8h.html#a8c1f847aac207a6afbed48210310c789">
       24
      </a>
     </span>
     <span class="preprocessor">
      #define THREADS5 1024
     </span>
    </div>
    <div class="line">
     <a name="l00025">
     </a>
     <span class="lineno">
      <a class="line" href="bh__kernels_8h.html#a12498f409c0023a090abf74f90b511f8">
       25
      </a>
     </span>
     <span class="preprocessor">
      #define THREADS6 1024
     </span>
    </div>
    <div class="line">
     <a name="l00026">
     </a>
     <span class="lineno">
      <a class="line" href="bh__kernels_8h.html#a3c4ca86a6531f092f92f04ae336be835">
       26
      </a>
     </span>
     <span class="preprocessor">
      #define THREADS7 1024
     </span>
    </div>
    <div class="line">
     <a name="l00027">
     </a>
     <span class="lineno">
      <a class="line" href="bh__kernels_8h.html#a8d61fa102b51bbd8eb2e10c64b983f2a">
       27
      </a>
     </span>
    </div>
    <div class="line">
     <a name="l00028">
     </a>
     <span class="lineno">
      28
     </span>
     <span class="preprocessor">
      #define FACTOR1 3
     </span>
    </div>
    <div class="line">
     <a name="l00029">
     </a>
     <span class="lineno">
      <a class="line" href="bh__kernels_8h.html#a4b50b75600a4385c7affd1c82998eef2">
       29
      </a>
     </span>
     <span class="preprocessor">
      #define FACTOR2 3
     </span>
    </div>
    <div class="line">
     <a name="l00030">
     </a>
     <span class="lineno">
      <a class="line" href="bh__kernels_8h.html#ab64e4c5074162a06e839885cba787ecc">
       30
      </a>
     </span>
     <span class="preprocessor">
      #define FACTOR3 1
     </span>
    </div>
    <div class="line">
     <a name="l00031">
     </a>
     <span class="lineno">
      <a class="line" href="bh__kernels_8h.html#a996f9a6fd15089ce39bccf4143a01a50">
       31
      </a>
     </span>
     <span class="preprocessor">
      #define FACTOR4 4
     </span>
    </div>
    <div class="line">
     <a name="l00032">
     </a>
     <span class="lineno">
      <a class="line" href="bh__kernels_8h.html#a07bf054e2784d6caf726da0080fc176b">
       32
      </a>
     </span>
     <span class="preprocessor">
      #define FACTOR5 2
     </span>
    </div>
    <div class="line">
     <a name="l00033">
     </a>
     <span class="lineno">
      <a class="line" href="bh__kernels_8h.html#a48c2c174863ddcf744426fb56be31ef6">
       33
      </a>
     </span>
     <span class="preprocessor">
      #define FACTOR6 2
     </span>
    </div>
    <div class="line">
     <a name="l00034">
     </a>
     <span class="lineno">
      <a class="line" href="bh__kernels_8h.html#a09496545d22a86a5d0293a80bb1920f7">
       34
      </a>
     </span>
     <span class="preprocessor">
      #define FACTOR7 1
     </span>
    </div>
    <div class="line">
     <a name="l00035">
     </a>
     <span class="lineno">
      <a class="line" href="bh__kernels_8h.html#aa2620e251169d063885806d9faba7cbd">
       35
      </a>
     </span>
    </div>
    <div class="line">
     <a name="l00036">
     </a>
     <span class="lineno">
      36
     </span>
     <span class="preprocessor">
      #include &lt;
      <a class="code" href="cudart__utils_8h.html">
       common/cudart_utils.h
      </a>
      &gt;
     </span>
    </div>
    <div class="line">
     <a name="l00037">
     </a>
     <span class="lineno">
      37
     </span>
     <span class="preprocessor">
      #include &lt;float.h&gt;
     </span>
    </div>
    <div class="line">
     <a name="l00038">
     </a>
     <span class="lineno">
      38
     </span>
     <span class="preprocessor">
      #include &lt;
      <a class="code" href="math_8h.html">
       math.h
      </a>
      &gt;
     </span>
    </div>
    <div class="line">
     <a name="l00039">
     </a>
     <span class="lineno">
      39
     </span>
    </div>
    <div class="line">
     <a name="l00040">
     </a>
     <span class="lineno">
      40
     </span>
     <span class="keyword">
      namespace
     </span>
     <a class="code" href="namespaceML.html">
      ML
     </a>
     {
    </div>
    <div class="line">
     <a name="l00041">
     </a>
     <span class="lineno">
      41
     </span>
     <span class="keyword">
      namespace
     </span>
     TSNE {
    </div>
    <div class="line">
     <a name="l00042">
     </a>
     <span class="lineno">
      42
     </span>
    </div>
    <div class="line">
     <a name="l00046">
     </a>
     <span class="lineno">
      <a class="line" href="namespaceML_1_1TSNE.html#a019429a6bfc09e7fbab8fe40e179bf9c">
       46
      </a>
     </span>
     __global__
     <span class="keywordtype">
      void
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a019429a6bfc09e7fbab8fe40e179bf9c">
      InitializationKernel
     </a>
     (
     <span class="comment">
      /*int *restrict errd, */
     </span>
    </div>
    <div class="line">
     <a name="l00047">
     </a>
     <span class="lineno">
      47
     </span>
     <span class="keywordtype">
      unsigned
     </span>
     *
     <a class="code" href="bh__kernels_8h.html#a080abdcb9c02438f1cd2bb707af25af8">
      restrict
     </a>
     <a class="code" href="namespaceML_1_1TSNE.html#a562384af697c8fbd87301bdadf156b10">
      limiter
     </a>
     ,
    </div>
    <div class="line">
     <a name="l00048">
     </a>
     <span class="lineno">
      48
     </span>
     <span class="keywordtype">
      int
     </span>
     *
     <a class="code" href="bh__kernels_8h.html#a080abdcb9c02438f1cd2bb707af25af8">
      restrict
     </a>
     <a class="code" href="namespaceML_1_1TSNE.html#aa2dfafe57a92a0075fe925a8a7dc45f5">
      maxdepthd
     </a>
     ,
    </div>
    <div class="line">
     <a name="l00049">
     </a>
     <span class="lineno">
      49
     </span>
     <span class="keywordtype">
      float
     </span>
     *
     <a class="code" href="bh__kernels_8h.html#a080abdcb9c02438f1cd2bb707af25af8">
      restrict
     </a>
     <a class="code" href="namespaceML_1_1TSNE.html#a167f3c550a51b8a44d7d6fed46db0546">
      radiusd
     </a>
     ) {
    </div>
    <div class="line">
     <a name="l00050">
     </a>
     <span class="lineno">
      50
     </span>
     <span class="comment">
      // errd[0] = 0;
     </span>
    </div>
    <div class="line">
     <a name="l00051">
     </a>
     <span class="lineno">
      51
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#aa2dfafe57a92a0075fe925a8a7dc45f5">
      maxdepthd
     </a>
     [0] = 1;
    </div>
    <div class="line">
     <a name="l00052">
     </a>
     <span class="lineno">
      52
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a562384af697c8fbd87301bdadf156b10">
      limiter
     </a>
     [0] = 0;
    </div>
    <div class="line">
     <a name="l00053">
     </a>
     <span class="lineno">
      53
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a167f3c550a51b8a44d7d6fed46db0546">
      radiusd
     </a>
     [0] = 0.0f;
    </div>
    <div class="line">
     <a name="l00054">
     </a>
     <span class="lineno">
      54
     </span>
     }
    </div>
    <div class="line">
     <a name="l00055">
     </a>
     <span class="lineno">
      55
     </span>
    </div>
    <div class="line">
     <a name="l00059">
     </a>
     <span class="lineno">
      <a class="line" href="namespaceML_1_1TSNE.html#adb88a27bf03841d34d49c4e0b29ab152">
       59
      </a>
     </span>
     __global__
     <span class="keywordtype">
      void
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#adb88a27bf03841d34d49c4e0b29ab152">
      Reset_Normalization
     </a>
     (
     <span class="keywordtype">
      float
     </span>
     *
     <a class="code" href="bh__kernels_8h.html#a080abdcb9c02438f1cd2bb707af25af8">
      restrict
     </a>
     <a class="code" href="namespaceML_1_1TSNE.html#ad530b26f03ad51d5eb7fce1926dd2360">
      Z_norm
     </a>
     ,
    </div>
    <div class="line">
     <a name="l00060">
     </a>
     <span class="lineno">
      60
     </span>
     <span class="keywordtype">
      float
     </span>
     *
     <a class="code" href="bh__kernels_8h.html#a080abdcb9c02438f1cd2bb707af25af8">
      restrict
     </a>
     <a class="code" href="namespaceML_1_1TSNE.html#aad1e315a2fa14c6112ce621379d92b4b">
      radiusd_squared
     </a>
     ,
    </div>
    <div class="line">
     <a name="l00061">
     </a>
     <span class="lineno">
      61
     </span>
     <span class="keywordtype">
      int
     </span>
     *
     <a class="code" href="bh__kernels_8h.html#a080abdcb9c02438f1cd2bb707af25af8">
      restrict
     </a>
     <a class="code" href="namespaceML_1_1TSNE.html#aa94ac12848f403e7c569e5de3037b206">
      bottomd
     </a>
     ,
     <span class="keyword">
      const
     </span>
     <span class="keywordtype">
      int
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a1d775ae44089726fc5f8d66f78528ada">
      NNODES
     </a>
     ,
    </div>
    <div class="line">
     <a name="l00062">
     </a>
     <span class="lineno">
      62
     </span>
     <span class="keyword">
      const
     </span>
     <span class="keywordtype">
      float
     </span>
     *
     <a class="code" href="bh__kernels_8h.html#a080abdcb9c02438f1cd2bb707af25af8">
      restrict
     </a>
     <a class="code" href="namespaceML_1_1TSNE.html#a167f3c550a51b8a44d7d6fed46db0546">
      radiusd
     </a>
     ) {
    </div>
    <div class="line">
     <a name="l00063">
     </a>
     <span class="lineno">
      63
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#ad530b26f03ad51d5eb7fce1926dd2360">
      Z_norm
     </a>
     [0] = 0.0f;
    </div>
    <div class="line">
     <a name="l00064">
     </a>
     <span class="lineno">
      64
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#aad1e315a2fa14c6112ce621379d92b4b">
      radiusd_squared
     </a>
     [0] =
     <a class="code" href="namespaceML_1_1TSNE.html#a167f3c550a51b8a44d7d6fed46db0546">
      radiusd
     </a>
     [0] *
     <a class="code" href="namespaceML_1_1TSNE.html#a167f3c550a51b8a44d7d6fed46db0546">
      radiusd
     </a>
     [0];
    </div>
    <div class="line">
     <a name="l00065">
     </a>
     <span class="lineno">
      65
     </span>
     <span class="comment">
      // create root node
     </span>
    </div>
    <div class="line">
     <a name="l00066">
     </a>
     <span class="lineno">
      66
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#aa94ac12848f403e7c569e5de3037b206">
      bottomd
     </a>
     [0] =
     <a class="code" href="namespaceML_1_1TSNE.html#a1d775ae44089726fc5f8d66f78528ada">
      NNODES
     </a>
     ;
    </div>
    <div class="line">
     <a name="l00067">
     </a>
     <span class="lineno">
      67
     </span>
     }
    </div>
    <div class="line">
     <a name="l00068">
     </a>
     <span class="lineno">
      68
     </span>
    </div>
    <div class="line">
     <a name="l00072">
     </a>
     <span class="lineno">
      <a class="line" href="namespaceML_1_1TSNE.html#ad15b73f1ef85613a669b3acb6ed86d07">
       72
      </a>
     </span>
     __global__
     <span class="keywordtype">
      void
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#ad15b73f1ef85613a669b3acb6ed86d07">
      Find_Normalization
     </a>
     (
     <span class="keywordtype">
      float
     </span>
     *
     <a class="code" href="bh__kernels_8h.html#a080abdcb9c02438f1cd2bb707af25af8">
      restrict
     </a>
     <a class="code" href="namespaceML_1_1TSNE.html#ad530b26f03ad51d5eb7fce1926dd2360">
      Z_norm
     </a>
     ,
     <span class="keyword">
      const
     </span>
     <span class="keywordtype">
      float
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a7086cebb5fe77bd10499d494328ba1c1">
      N
     </a>
     ) {
    </div>
    <div class="line">
     <a name="l00073">
     </a>
     <span class="lineno">
      73
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#ad530b26f03ad51d5eb7fce1926dd2360">
      Z_norm
     </a>
     [0] = 1.0f / (
     <a class="code" href="namespaceML_1_1TSNE.html#ad530b26f03ad51d5eb7fce1926dd2360">
      Z_norm
     </a>
     [0] -
     <a class="code" href="namespaceML_1_1TSNE.html#a7086cebb5fe77bd10499d494328ba1c1">
      N
     </a>
     );
    </div>
    <div class="line">
     <a name="l00074">
     </a>
     <span class="lineno">
      74
     </span>
     }
    </div>
    <div class="line">
     <a name="l00075">
     </a>
     <span class="lineno">
      75
     </span>
    </div>
    <div class="line">
     <a name="l00079">
     </a>
     <span class="lineno">
      <a class="line" href="namespaceML_1_1TSNE.html#a3fd0469bdd73eaf1f777c1ff1aee929b">
       79
      </a>
     </span>
     __global__
     <a class="code" href="namespaceML_1_1TSNE.html#a3fd0469bdd73eaf1f777c1ff1aee929b">
      __launch_bounds__
     </a>
     (
     <a class="code" href="bh__kernels_8h.html#a6cac1d001fa4d6c00a794bc587dac1d2">
      THREADS1
     </a>
     ,
     <a class="code" href="bh__kernels_8h.html#a4b50b75600a4385c7affd1c82998eef2">
      FACTOR1
     </a>
     )
     <span class="keywordtype">
      void
     </span>
     BoundingBoxKernel(
    </div>
    <div class="line">
     <a name="l00080">
     </a>
     <span class="lineno">
      <a class="line" href="namespaceML_1_1TSNE.html#aaeba4f3e347780328e08a424e719255e">
       80
      </a>
     </span>
     <span class="keywordtype">
      int
     </span>
     *
     <a class="code" href="bh__kernels_8h.html#a080abdcb9c02438f1cd2bb707af25af8">
      restrict
     </a>
     <a class="code" href="namespaceML_1_1TSNE.html#a2732a645713566a20477f67210871121">
      startd
     </a>
     ,
     <span class="keywordtype">
      int
     </span>
     *
     <a class="code" href="bh__kernels_8h.html#a080abdcb9c02438f1cd2bb707af25af8">
      restrict
     </a>
     <a class="code" href="namespaceML_1_1TSNE.html#ad7b00d371d403bb26f2bb196659e9c56">
      childd
     </a>
     ,
     <span class="keywordtype">
      float
     </span>
     *
     <a class="code" href="bh__kernels_8h.html#a080abdcb9c02438f1cd2bb707af25af8">
      restrict
     </a>
     <a class="code" href="namespaceML_1_1TSNE.html#aaeba4f3e347780328e08a424e719255e">
      massd
     </a>
     ,
    </div>
    <div class="line">
     <a name="l00081">
     </a>
     <span class="lineno">
      <a class="line" href="namespaceML_1_1TSNE.html#abe37b2672d24fb0a19db8757502e120f">
       81
      </a>
     </span>
     <span class="keywordtype">
      float
     </span>
     *
     <a class="code" href="bh__kernels_8h.html#a080abdcb9c02438f1cd2bb707af25af8">
      restrict
     </a>
     <a class="code" href="namespaceML_1_1TSNE.html#ad5c3a149f16c2850ff03ca0d4182b594">
      posxd
     </a>
     ,
     <span class="keywordtype">
      float
     </span>
     *
     <a class="code" href="bh__kernels_8h.html#a080abdcb9c02438f1cd2bb707af25af8">
      restrict
     </a>
     <a class="code" href="namespaceML_1_1TSNE.html#abe37b2672d24fb0a19db8757502e120f">
      posyd
     </a>
     ,
     <span class="keywordtype">
      float
     </span>
     *
     <a class="code" href="bh__kernels_8h.html#a080abdcb9c02438f1cd2bb707af25af8">
      restrict
     </a>
     <a class="code" href="namespaceML_1_1TSNE.html#ad3a3689aa3be4fbe7d26112ea7371752">
      maxxd
     </a>
     ,
    </div>
    <div class="line">
     <a name="l00082">
     </a>
     <span class="lineno">
      <a class="line" href="namespaceML_1_1TSNE.html#a56fd57480279a12a41953990a3175ea0">
       82
      </a>
     </span>
     <span class="keywordtype">
      float
     </span>
     *
     <a class="code" href="bh__kernels_8h.html#a080abdcb9c02438f1cd2bb707af25af8">
      restrict
     </a>
     <a class="code" href="namespaceML_1_1TSNE.html#aabce7570ae4f899219545908eaf4a0fb">
      maxyd
     </a>
     ,
     <span class="keywordtype">
      float
     </span>
     *
     <a class="code" href="bh__kernels_8h.html#a080abdcb9c02438f1cd2bb707af25af8">
      restrict
     </a>
     <a class="code" href="namespaceML_1_1TSNE.html#aa617976838732bc2568391834aca41b5">
      minxd
     </a>
     ,
     <span class="keywordtype">
      float
     </span>
     *
     <a class="code" href="bh__kernels_8h.html#a080abdcb9c02438f1cd2bb707af25af8">
      restrict
     </a>
     <a class="code" href="namespaceML_1_1TSNE.html#a56fd57480279a12a41953990a3175ea0">
      minyd
     </a>
     ,
    </div>
    <div class="line">
     <a name="l00083">
     </a>
     <span class="lineno">
      <a class="line" href="namespaceML_1_1TSNE.html#a1d775ae44089726fc5f8d66f78528ada">
       83
      </a>
     </span>
     <span class="keyword">
      const
     </span>
     <span class="keywordtype">
      int
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#ad506ff98589c53814844d9f8663a127d">
      FOUR_NNODES
     </a>
     ,
     <span class="keyword">
      const
     </span>
     <span class="keywordtype">
      int
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a1d775ae44089726fc5f8d66f78528ada">
      NNODES
     </a>
     ,
     <span class="keyword">
      const
     </span>
     <span class="keywordtype">
      int
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a7086cebb5fe77bd10499d494328ba1c1">
      N
     </a>
     ,
    </div>
    <div class="line">
     <a name="l00084">
     </a>
     <span class="lineno">
      <a class="line" href="namespaceML_1_1TSNE.html#a167f3c550a51b8a44d7d6fed46db0546">
       84
      </a>
     </span>
     <span class="keywordtype">
      unsigned
     </span>
     *
     <a class="code" href="bh__kernels_8h.html#a080abdcb9c02438f1cd2bb707af25af8">
      restrict
     </a>
     <a class="code" href="namespaceML_1_1TSNE.html#a562384af697c8fbd87301bdadf156b10">
      limiter
     </a>
     ,
     <span class="keywordtype">
      float
     </span>
     *
     <a class="code" href="bh__kernels_8h.html#a080abdcb9c02438f1cd2bb707af25af8">
      restrict
     </a>
     <a class="code" href="namespaceML_1_1TSNE.html#a167f3c550a51b8a44d7d6fed46db0546">
      radiusd
     </a>
     ) {
    </div>
    <div class="line">
     <a name="l00085">
     </a>
     <span class="lineno">
      85
     </span>
     <span class="keywordtype">
      float
     </span>
     val,
     <a class="code" href="namespaceML_1_1TSNE.html#a89f30c48ab5b3f4e240579701f20c187">
      minx
     </a>
     , maxx,
     <a class="code" href="namespaceML_1_1TSNE.html#a7ad23cd0bd45879aa59a05d2fc8acf98">
      miny
     </a>
     , maxy;
    </div>
    <div class="line">
     <a name="l00086">
     </a>
     <span class="lineno">
      <a class="line" href="namespaceML_1_1TSNE.html#aea214671864d82984f60a37e821b63a6">
       86
      </a>
     </span>
     __shared__
     <span class="keywordtype">
      float
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a375949168735d67d84b0db0ef9ae7006">
      sminx
     </a>
     [
     <a class="code" href="bh__kernels_8h.html#a6cac1d001fa4d6c00a794bc587dac1d2">
      THREADS1
     </a>
     ],
     <a class="code" href="namespaceML_1_1TSNE.html#aef77c1ba4db5586bb012d8a9f6ed22be">
      smaxx
     </a>
     [
     <a class="code" href="bh__kernels_8h.html#a6cac1d001fa4d6c00a794bc587dac1d2">
      THREADS1
     </a>
     ],
     <a class="code" href="namespaceML_1_1TSNE.html#aea214671864d82984f60a37e821b63a6">
      sminy
     </a>
     [
     <a class="code" href="bh__kernels_8h.html#a6cac1d001fa4d6c00a794bc587dac1d2">
      THREADS1
     </a>
     ],
    </div>
    <div class="line">
     <a name="l00087">
     </a>
     <span class="lineno">
      <a class="line" href="namespaceML_1_1TSNE.html#a5b23a524a62bfbdfc7a822f7986fff81">
       87
      </a>
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a5b23a524a62bfbdfc7a822f7986fff81">
      smaxy
     </a>
     [
     <a class="code" href="bh__kernels_8h.html#a6cac1d001fa4d6c00a794bc587dac1d2">
      THREADS1
     </a>
     ];
    </div>
    <div class="line">
     <a name="l00088">
     </a>
     <span class="lineno">
      88
     </span>
    </div>
    <div class="line">
     <a name="l00089">
     </a>
     <span class="lineno">
      89
     </span>
     <span class="comment">
      // initialize with valid data (in case #bodies &lt; #threads)
     </span>
    </div>
    <div class="line">
     <a name="l00090">
     </a>
     <span class="lineno">
      <a class="line" href="namespaceML_1_1TSNE.html#a89f30c48ab5b3f4e240579701f20c187">
       90
      </a>
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a89f30c48ab5b3f4e240579701f20c187">
      minx
     </a>
     = maxx =
     <a class="code" href="namespaceML_1_1TSNE.html#ad5c3a149f16c2850ff03ca0d4182b594">
      posxd
     </a>
     [0];
    </div>
    <div class="line">
     <a name="l00091">
     </a>
     <span class="lineno">
      <a class="line" href="namespaceML_1_1TSNE.html#a7ad23cd0bd45879aa59a05d2fc8acf98">
       91
      </a>
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a7ad23cd0bd45879aa59a05d2fc8acf98">
      miny
     </a>
     = maxy =
     <a class="code" href="namespaceML_1_1TSNE.html#abe37b2672d24fb0a19db8757502e120f">
      posyd
     </a>
     [0];
    </div>
    <div class="line">
     <a name="l00092">
     </a>
     <span class="lineno">
      92
     </span>
    </div>
    <div class="line">
     <a name="l00093">
     </a>
     <span class="lineno">
      93
     </span>
     <span class="comment">
      // scan all bodies
     </span>
    </div>
    <div class="line">
     <a name="l00094">
     </a>
     <span class="lineno">
      <a class="line" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
       94
      </a>
     </span>
     <span class="keyword">
      const
     </span>
     <span class="keywordtype">
      int
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     = threadIdx.x;
    </div>
    <div class="line">
     <a name="l00095">
     </a>
     <span class="lineno">
      <a class="line" href="namespaceML_1_1TSNE.html#acfb1787f01f8a74fab3ad6d557ec9ffe">
       95
      </a>
     </span>
     <span class="keyword">
      const
     </span>
     <span class="keywordtype">
      int
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#acfb1787f01f8a74fab3ad6d557ec9ffe">
      inc
     </a>
     =
     <a class="code" href="bh__kernels_8h.html#a6cac1d001fa4d6c00a794bc587dac1d2">
      THREADS1
     </a>
     * gridDim.x;
    </div>
    <div class="line">
     <a name="l00096">
     </a>
     <span class="lineno">
      <a class="line" href="namespaceML_1_1TSNE.html#ade251d9108c2e6c34695f53f591907a2">
       96
      </a>
     </span>
     <span class="keywordflow">
      for
     </span>
     (
     <span class="keywordtype">
      int
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#aa7af7a282a727812d02249e36b56d7cb">
      j
     </a>
     =
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     + blockIdx.x *
     <a class="code" href="bh__kernels_8h.html#a6cac1d001fa4d6c00a794bc587dac1d2">
      THREADS1
     </a>
     ;
     <a class="code" href="namespaceML_1_1TSNE.html#aa7af7a282a727812d02249e36b56d7cb">
      j
     </a>
     &lt;
     <a class="code" href="namespaceML_1_1TSNE.html#a7086cebb5fe77bd10499d494328ba1c1">
      N
     </a>
     ;
     <a class="code" href="namespaceML_1_1TSNE.html#aa7af7a282a727812d02249e36b56d7cb">
      j
     </a>
     +=
     <a class="code" href="namespaceML_1_1TSNE.html#acfb1787f01f8a74fab3ad6d557ec9ffe">
      inc
     </a>
     ) {
    </div>
    <div class="line">
     <a name="l00097">
     </a>
     <span class="lineno">
      97
     </span>
     val =
     <a class="code" href="namespaceML_1_1TSNE.html#ad5c3a149f16c2850ff03ca0d4182b594">
      posxd
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#aa7af7a282a727812d02249e36b56d7cb">
      j
     </a>
     ];
    </div>
    <div class="line">
     <a name="l00098">
     </a>
     <span class="lineno">
      98
     </span>
     <span class="keywordflow">
      if
     </span>
     (val &lt;
     <a class="code" href="namespaceML_1_1TSNE.html#a89f30c48ab5b3f4e240579701f20c187">
      minx
     </a>
     )
    </div>
    <div class="line">
     <a name="l00099">
     </a>
     <span class="lineno">
      99
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a89f30c48ab5b3f4e240579701f20c187">
      minx
     </a>
     = val;
    </div>
    <div class="line">
     <a name="l00100">
     </a>
     <span class="lineno">
      100
     </span>
     <span class="keywordflow">
      else
     </span>
     <span class="keywordflow">
      if
     </span>
     (val &gt; maxx)
    </div>
    <div class="line">
     <a name="l00101">
     </a>
     <span class="lineno">
      101
     </span>
     maxx = val;
    </div>
    <div class="line">
     <a name="l00102">
     </a>
     <span class="lineno">
      102
     </span>
    </div>
    <div class="line">
     <a name="l00103">
     </a>
     <span class="lineno">
      103
     </span>
     val =
     <a class="code" href="namespaceML_1_1TSNE.html#abe37b2672d24fb0a19db8757502e120f">
      posyd
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#aa7af7a282a727812d02249e36b56d7cb">
      j
     </a>
     ];
    </div>
    <div class="line">
     <a name="l00104">
     </a>
     <span class="lineno">
      104
     </span>
     <span class="keywordflow">
      if
     </span>
     (val &lt;
     <a class="code" href="namespaceML_1_1TSNE.html#a7ad23cd0bd45879aa59a05d2fc8acf98">
      miny
     </a>
     )
    </div>
    <div class="line">
     <a name="l00105">
     </a>
     <span class="lineno">
      105
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a7ad23cd0bd45879aa59a05d2fc8acf98">
      miny
     </a>
     = val;
    </div>
    <div class="line">
     <a name="l00106">
     </a>
     <span class="lineno">
      106
     </span>
     <span class="keywordflow">
      else
     </span>
     <span class="keywordflow">
      if
     </span>
     (val &gt; maxy)
    </div>
    <div class="line">
     <a name="l00107">
     </a>
     <span class="lineno">
      107
     </span>
     maxy = val;
    </div>
    <div class="line">
     <a name="l00108">
     </a>
     <span class="lineno">
      108
     </span>
     }
    </div>
    <div class="line">
     <a name="l00109">
     </a>
     <span class="lineno">
      109
     </span>
    </div>
    <div class="line">
     <a name="l00110">
     </a>
     <span class="lineno">
      110
     </span>
     <span class="comment">
      // reduction in shared memory
     </span>
    </div>
    <div class="line">
     <a name="l00111">
     </a>
     <span class="lineno">
      111
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a375949168735d67d84b0db0ef9ae7006">
      sminx
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     ] =
     <a class="code" href="namespaceML_1_1TSNE.html#a89f30c48ab5b3f4e240579701f20c187">
      minx
     </a>
     ;
    </div>
    <div class="line">
     <a name="l00112">
     </a>
     <span class="lineno">
      112
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#aef77c1ba4db5586bb012d8a9f6ed22be">
      smaxx
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     ] = maxx;
    </div>
    <div class="line">
     <a name="l00113">
     </a>
     <span class="lineno">
      113
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#aea214671864d82984f60a37e821b63a6">
      sminy
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     ] =
     <a class="code" href="namespaceML_1_1TSNE.html#a7ad23cd0bd45879aa59a05d2fc8acf98">
      miny
     </a>
     ;
    </div>
    <div class="line">
     <a name="l00114">
     </a>
     <span class="lineno">
      114
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a5b23a524a62bfbdfc7a822f7986fff81">
      smaxy
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     ] = maxy;
    </div>
    <div class="line">
     <a name="l00115">
     </a>
     <span class="lineno">
      115
     </span>
    </div>
    <div class="line">
     <a name="l00116">
     </a>
     <span class="lineno">
      <a class="line" href="namespaceML_1_1TSNE.html#afa7ff633885b71e8a5630ca7bbc596fe">
       116
      </a>
     </span>
     <span class="keywordflow">
      for
     </span>
     (
     <span class="keywordtype">
      int
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#aa7af7a282a727812d02249e36b56d7cb">
      j
     </a>
     =
     <a class="code" href="bh__kernels_8h.html#a6cac1d001fa4d6c00a794bc587dac1d2">
      THREADS1
     </a>
     / 2;
     <a class="code" href="namespaceML_1_1TSNE.html#aa7af7a282a727812d02249e36b56d7cb">
      j
     </a>
     &gt;
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     ;
     <a class="code" href="namespaceML_1_1TSNE.html#aa7af7a282a727812d02249e36b56d7cb">
      j
     </a>
     /= 2) {
    </div>
    <div class="line">
     <a name="l00117">
     </a>
     <span class="lineno">
      117
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a98168b1bb13bc28991297eef583f11fe">
      __syncthreads
     </a>
     ();
    </div>
    <div class="line">
     <a name="l00118">
     </a>
     <span class="lineno">
      118
     </span>
     <span class="keyword">
      const
     </span>
     <span class="keywordtype">
      int
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#afb851e919e0cd78a7c66faf65d407452">
      k
     </a>
     =
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     +
     <a class="code" href="namespaceML_1_1TSNE.html#aa7af7a282a727812d02249e36b56d7cb">
      j
     </a>
     ;
    </div>
    <div class="line">
     <a name="l00119">
     </a>
     <span class="lineno">
      119
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a375949168735d67d84b0db0ef9ae7006">
      sminx
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     ] =
     <a class="code" href="namespaceML_1_1TSNE.html#a89f30c48ab5b3f4e240579701f20c187">
      minx
     </a>
     = fminf(
     <a class="code" href="namespaceML_1_1TSNE.html#a89f30c48ab5b3f4e240579701f20c187">
      minx
     </a>
     ,
     <a class="code" href="namespaceML_1_1TSNE.html#a375949168735d67d84b0db0ef9ae7006">
      sminx
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#afb851e919e0cd78a7c66faf65d407452">
      k
     </a>
     ]);
    </div>
    <div class="line">
     <a name="l00120">
     </a>
     <span class="lineno">
      120
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#aef77c1ba4db5586bb012d8a9f6ed22be">
      smaxx
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     ] = maxx = fmaxf(maxx,
     <a class="code" href="namespaceML_1_1TSNE.html#aef77c1ba4db5586bb012d8a9f6ed22be">
      smaxx
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#afb851e919e0cd78a7c66faf65d407452">
      k
     </a>
     ]);
    </div>
    <div class="line">
     <a name="l00121">
     </a>
     <span class="lineno">
      121
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#aea214671864d82984f60a37e821b63a6">
      sminy
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     ] =
     <a class="code" href="namespaceML_1_1TSNE.html#a7ad23cd0bd45879aa59a05d2fc8acf98">
      miny
     </a>
     = fminf(
     <a class="code" href="namespaceML_1_1TSNE.html#a7ad23cd0bd45879aa59a05d2fc8acf98">
      miny
     </a>
     ,
     <a class="code" href="namespaceML_1_1TSNE.html#aea214671864d82984f60a37e821b63a6">
      sminy
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#afb851e919e0cd78a7c66faf65d407452">
      k
     </a>
     ]);
    </div>
    <div class="line">
     <a name="l00122">
     </a>
     <span class="lineno">
      122
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a5b23a524a62bfbdfc7a822f7986fff81">
      smaxy
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     ] = maxy = fmaxf(maxy,
     <a class="code" href="namespaceML_1_1TSNE.html#a5b23a524a62bfbdfc7a822f7986fff81">
      smaxy
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#afb851e919e0cd78a7c66faf65d407452">
      k
     </a>
     ]);
    </div>
    <div class="line">
     <a name="l00123">
     </a>
     <span class="lineno">
      123
     </span>
     }
    </div>
    <div class="line">
     <a name="l00124">
     </a>
     <span class="lineno">
      124
     </span>
    </div>
    <div class="line">
     <a name="l00125">
     </a>
     <span class="lineno">
      <a class="line" href="namespaceML_1_1TSNE.html#a5e6127c8e89f25aba2fc545044afcb4a">
       125
      </a>
     </span>
     <span class="keywordflow">
      if
     </span>
     (
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     == 0) {
    </div>
    <div class="line">
     <a name="l00126">
     </a>
     <span class="lineno">
      126
     </span>
     <span class="comment">
      // write block result to global memory
     </span>
    </div>
    <div class="line">
     <a name="l00127">
     </a>
     <span class="lineno">
      127
     </span>
     <span class="keyword">
      const
     </span>
     <span class="keywordtype">
      int
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#afb851e919e0cd78a7c66faf65d407452">
      k
     </a>
     = blockIdx.x;
    </div>
    <div class="line">
     <a name="l00128">
     </a>
     <span class="lineno">
      128
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#aa617976838732bc2568391834aca41b5">
      minxd
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#afb851e919e0cd78a7c66faf65d407452">
      k
     </a>
     ] =
     <a class="code" href="namespaceML_1_1TSNE.html#a89f30c48ab5b3f4e240579701f20c187">
      minx
     </a>
     ;
    </div>
    <div class="line">
     <a name="l00129">
     </a>
     <span class="lineno">
      129
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#ad3a3689aa3be4fbe7d26112ea7371752">
      maxxd
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#afb851e919e0cd78a7c66faf65d407452">
      k
     </a>
     ] = maxx;
    </div>
    <div class="line">
     <a name="l00130">
     </a>
     <span class="lineno">
      130
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a56fd57480279a12a41953990a3175ea0">
      minyd
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#afb851e919e0cd78a7c66faf65d407452">
      k
     </a>
     ] =
     <a class="code" href="namespaceML_1_1TSNE.html#a7ad23cd0bd45879aa59a05d2fc8acf98">
      miny
     </a>
     ;
    </div>
    <div class="line">
     <a name="l00131">
     </a>
     <span class="lineno">
      131
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#aabce7570ae4f899219545908eaf4a0fb">
      maxyd
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#afb851e919e0cd78a7c66faf65d407452">
      k
     </a>
     ] = maxy;
    </div>
    <div class="line">
     <a name="l00132">
     </a>
     <span class="lineno">
      132
     </span>
     __threadfence();
    </div>
    <div class="line">
     <a name="l00133">
     </a>
     <span class="lineno">
      133
     </span>
    </div>
    <div class="line">
     <a name="l00134">
     </a>
     <span class="lineno">
      134
     </span>
     <span class="keyword">
      const
     </span>
     <span class="keywordtype">
      int
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#acfb1787f01f8a74fab3ad6d557ec9ffe">
      inc
     </a>
     = gridDim.x - 1;
    </div>
    <div class="line">
     <a name="l00135">
     </a>
     <span class="lineno">
      135
     </span>
     <span class="keywordflow">
      if
     </span>
     (
     <a class="code" href="namespaceML_1_1TSNE.html#acfb1787f01f8a74fab3ad6d557ec9ffe">
      inc
     </a>
     != atomicInc(
     <a class="code" href="namespaceML_1_1TSNE.html#a562384af697c8fbd87301bdadf156b10">
      limiter
     </a>
     ,
     <a class="code" href="namespaceML_1_1TSNE.html#acfb1787f01f8a74fab3ad6d557ec9ffe">
      inc
     </a>
     ))
     <span class="keywordflow">
      return
     </span>
     ;
    </div>
    <div class="line">
     <a name="l00136">
     </a>
     <span class="lineno">
      136
     </span>
    </div>
    <div class="line">
     <a name="l00137">
     </a>
     <span class="lineno">
      137
     </span>
     <span class="comment">
      // I'm the last block, so combine all block results
     </span>
    </div>
    <div class="line">
     <a name="l00138">
     </a>
     <span class="lineno">
      138
     </span>
     <span class="keywordflow">
      for
     </span>
     (
     <span class="keywordtype">
      int
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#aa7af7a282a727812d02249e36b56d7cb">
      j
     </a>
     = 0;
     <a class="code" href="namespaceML_1_1TSNE.html#aa7af7a282a727812d02249e36b56d7cb">
      j
     </a>
     &lt;=
     <a class="code" href="namespaceML_1_1TSNE.html#acfb1787f01f8a74fab3ad6d557ec9ffe">
      inc
     </a>
     ;
     <a class="code" href="namespaceML_1_1TSNE.html#aa7af7a282a727812d02249e36b56d7cb">
      j
     </a>
     ++) {
    </div>
    <div class="line">
     <a name="l00139">
     </a>
     <span class="lineno">
      139
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a89f30c48ab5b3f4e240579701f20c187">
      minx
     </a>
     = fminf(
     <a class="code" href="namespaceML_1_1TSNE.html#a89f30c48ab5b3f4e240579701f20c187">
      minx
     </a>
     ,
     <a class="code" href="namespaceML_1_1TSNE.html#aa617976838732bc2568391834aca41b5">
      minxd
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#aa7af7a282a727812d02249e36b56d7cb">
      j
     </a>
     ]);
    </div>
    <div class="line">
     <a name="l00140">
     </a>
     <span class="lineno">
      140
     </span>
     maxx = fmaxf(maxx,
     <a class="code" href="namespaceML_1_1TSNE.html#ad3a3689aa3be4fbe7d26112ea7371752">
      maxxd
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#aa7af7a282a727812d02249e36b56d7cb">
      j
     </a>
     ]);
    </div>
    <div class="line">
     <a name="l00141">
     </a>
     <span class="lineno">
      141
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a7ad23cd0bd45879aa59a05d2fc8acf98">
      miny
     </a>
     = fminf(
     <a class="code" href="namespaceML_1_1TSNE.html#a7ad23cd0bd45879aa59a05d2fc8acf98">
      miny
     </a>
     ,
     <a class="code" href="namespaceML_1_1TSNE.html#a56fd57480279a12a41953990a3175ea0">
      minyd
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#aa7af7a282a727812d02249e36b56d7cb">
      j
     </a>
     ]);
    </div>
    <div class="line">
     <a name="l00142">
     </a>
     <span class="lineno">
      142
     </span>
     maxy = fmaxf(maxy,
     <a class="code" href="namespaceML_1_1TSNE.html#aabce7570ae4f899219545908eaf4a0fb">
      maxyd
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#aa7af7a282a727812d02249e36b56d7cb">
      j
     </a>
     ]);
    </div>
    <div class="line">
     <a name="l00143">
     </a>
     <span class="lineno">
      143
     </span>
     }
    </div>
    <div class="line">
     <a name="l00144">
     </a>
     <span class="lineno">
      144
     </span>
    </div>
    <div class="line">
     <a name="l00145">
     </a>
     <span class="lineno">
      145
     </span>
     <span class="comment">
      // compute 'radius'
     </span>
    </div>
    <div class="line">
     <a name="l00146">
     </a>
     <span class="lineno">
      146
     </span>
     atomicExch(
     <a class="code" href="namespaceML_1_1TSNE.html#a167f3c550a51b8a44d7d6fed46db0546">
      radiusd
     </a>
     , fmaxf(maxx -
     <a class="code" href="namespaceML_1_1TSNE.html#a89f30c48ab5b3f4e240579701f20c187">
      minx
     </a>
     , maxy -
     <a class="code" href="namespaceML_1_1TSNE.html#a7ad23cd0bd45879aa59a05d2fc8acf98">
      miny
     </a>
     ) * 0.5
     <a class="code" href="namespaceUMAPAlgo_1_1Optimize.html#ad1d8470650aa6ea82693fdf61479e708">
      f
     </a>
     + 1e-5
     <a class="code" href="namespaceUMAPAlgo_1_1Optimize.html#ad1d8470650aa6ea82693fdf61479e708">
      f
     </a>
     );
    </div>
    <div class="line">
     <a name="l00147">
     </a>
     <span class="lineno">
      147
     </span>
    </div>
    <div class="line">
     <a name="l00148">
     </a>
     <span class="lineno">
      148
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#aaeba4f3e347780328e08a424e719255e">
      massd
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#a1d775ae44089726fc5f8d66f78528ada">
      NNODES
     </a>
     ] = -1.0f;
    </div>
    <div class="line">
     <a name="l00149">
     </a>
     <span class="lineno">
      149
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a2732a645713566a20477f67210871121">
      startd
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#a1d775ae44089726fc5f8d66f78528ada">
      NNODES
     </a>
     ] = 0;
    </div>
    <div class="line">
     <a name="l00150">
     </a>
     <span class="lineno">
      150
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#ad5c3a149f16c2850ff03ca0d4182b594">
      posxd
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#a1d775ae44089726fc5f8d66f78528ada">
      NNODES
     </a>
     ] = (
     <a class="code" href="namespaceML_1_1TSNE.html#a89f30c48ab5b3f4e240579701f20c187">
      minx
     </a>
     + maxx) * 0.5
     <a class="code" href="namespaceUMAPAlgo_1_1Optimize.html#ad1d8470650aa6ea82693fdf61479e708">
      f
     </a>
     ;
    </div>
    <div class="line">
     <a name="l00151">
     </a>
     <span class="lineno">
      151
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#abe37b2672d24fb0a19db8757502e120f">
      posyd
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#a1d775ae44089726fc5f8d66f78528ada">
      NNODES
     </a>
     ] = (
     <a class="code" href="namespaceML_1_1TSNE.html#a7ad23cd0bd45879aa59a05d2fc8acf98">
      miny
     </a>
     + maxy) * 0.5
     <a class="code" href="namespaceUMAPAlgo_1_1Optimize.html#ad1d8470650aa6ea82693fdf61479e708">
      f
     </a>
     ;
    </div>
    <div class="line">
     <a name="l00152">
     </a>
     <span class="lineno">
      152
     </span>
    </div>
    <div class="line">
     <a name="l00153">
     </a>
     <span class="lineno">
      153
     </span>
     <span class="preprocessor">
      #pragma unroll
     </span>
    </div>
    <div class="line">
     <a name="l00154">
     </a>
     <span class="lineno">
      154
     </span>
     <span class="keywordflow">
      for
     </span>
     (
     <span class="keywordtype">
      int
     </span>
     a = 0; a &lt; 4; a++)
     <a class="code" href="namespaceML_1_1TSNE.html#ad7b00d371d403bb26f2bb196659e9c56">
      childd
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#ad506ff98589c53814844d9f8663a127d">
      FOUR_NNODES
     </a>
     + a] = -1;
    </div>
    <div class="line">
     <a name="l00155">
     </a>
     <span class="lineno">
      155
     </span>
     }
    </div>
    <div class="line">
     <a name="l00156">
     </a>
     <span class="lineno">
      156
     </span>
     }
    </div>
    <div class="line">
     <a name="l00157">
     </a>
     <span class="lineno">
      157
     </span>
    </div>
    <div class="line">
     <a name="l00161">
     </a>
     <span class="lineno">
      <a class="line" href="namespaceML_1_1TSNE.html#a0043c56d003c177e0f65d2489a617cf3">
       161
      </a>
     </span>
     __global__
     <a class="code" href="namespaceML_1_1TSNE.html#a3fd0469bdd73eaf1f777c1ff1aee929b">
      __launch_bounds__
     </a>
     (1024, 1) void ClearKernel1(
     <span class="keywordtype">
      int
     </span>
     *
     <a class="code" href="bh__kernels_8h.html#a080abdcb9c02438f1cd2bb707af25af8">
      restrict
     </a>
     <a class="code" href="namespaceML_1_1TSNE.html#ad7b00d371d403bb26f2bb196659e9c56">
      childd
     </a>
     ,
    </div>
    <div class="line">
     <a name="l00162">
     </a>
     <span class="lineno">
      162
     </span>
     const
     <span class="keywordtype">
      int
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#ad506ff98589c53814844d9f8663a127d">
      FOUR_NNODES
     </a>
     ,
    </div>
    <div class="line">
     <a name="l00163">
     </a>
     <span class="lineno">
      <a class="line" href="namespaceML_1_1TSNE.html#abf75b02e7b11bdbcffd20d6895d97090">
       163
      </a>
     </span>
     const
     <span class="keywordtype">
      int
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#abf75b02e7b11bdbcffd20d6895d97090">
      FOUR_N
     </a>
     ) {
    </div>
    <div class="line">
     <a name="l00164">
     </a>
     <span class="lineno">
      164
     </span>
     <span class="keyword">
      const
     </span>
     <span class="keywordtype">
      int
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#acfb1787f01f8a74fab3ad6d557ec9ffe">
      inc
     </a>
     = blockDim.x * gridDim.x;
    </div>
    <div class="line">
     <a name="l00165">
     </a>
     <span class="lineno">
      <a class="line" href="namespaceML_1_1TSNE.html#afb851e919e0cd78a7c66faf65d407452">
       165
      </a>
     </span>
     <span class="keywordtype">
      int
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#afb851e919e0cd78a7c66faf65d407452">
      k
     </a>
     = (
     <a class="code" href="namespaceML_1_1TSNE.html#abf75b02e7b11bdbcffd20d6895d97090">
      FOUR_N
     </a>
     &amp; -32) + threadIdx.x + blockIdx.x * blockDim.x;
    </div>
    <div class="line">
     <a name="l00166">
     </a>
     <span class="lineno">
      <a class="line" href="namespaceML_1_1TSNE.html#a50ec2fb1e650657e8ae1a62783f8a889">
       166
      </a>
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a5e6127c8e89f25aba2fc545044afcb4a">
      if
     </a>
     (
     <a class="code" href="namespaceML_1_1TSNE.html#afb851e919e0cd78a7c66faf65d407452">
      k
     </a>
     &lt;
     <a class="code" href="namespaceML_1_1TSNE.html#abf75b02e7b11bdbcffd20d6895d97090">
      FOUR_N
     </a>
     )
     <a class="code" href="namespaceML_1_1TSNE.html#afb851e919e0cd78a7c66faf65d407452">
      k
     </a>
     +=
     <a class="code" href="namespaceML_1_1TSNE.html#acfb1787f01f8a74fab3ad6d557ec9ffe">
      inc
     </a>
     ;
    </div>
    <div class="line">
     <a name="l00167">
     </a>
     <span class="lineno">
      167
     </span>
    </div>
    <div class="line">
     <a name="l00168">
     </a>
     <span class="lineno">
      168
     </span>
     <span class="comment">
      // iterate over all cells assigned to thread
     </span>
    </div>
    <div class="line">
     <a name="l00169">
     </a>
     <span class="lineno">
      169
     </span>
     <span class="preprocessor">
      #pragma unroll
     </span>
    </div>
    <div class="line">
     <a name="l00170">
     </a>
     <span class="lineno">
      170
     </span>
     <span class="keywordflow">
      for
     </span>
     (;
     <a class="code" href="namespaceML_1_1TSNE.html#afb851e919e0cd78a7c66faf65d407452">
      k
     </a>
     &lt;
     <a class="code" href="namespaceML_1_1TSNE.html#ad506ff98589c53814844d9f8663a127d">
      FOUR_NNODES
     </a>
     ;
     <a class="code" href="namespaceML_1_1TSNE.html#afb851e919e0cd78a7c66faf65d407452">
      k
     </a>
     +=
     <a class="code" href="namespaceML_1_1TSNE.html#acfb1787f01f8a74fab3ad6d557ec9ffe">
      inc
     </a>
     )
     <a class="code" href="namespaceML_1_1TSNE.html#ad7b00d371d403bb26f2bb196659e9c56">
      childd
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#afb851e919e0cd78a7c66faf65d407452">
      k
     </a>
     ] = -1;
    </div>
    <div class="line">
     <a name="l00171">
     </a>
     <span class="lineno">
      171
     </span>
     }
    </div>
    <div class="line">
     <a name="l00172">
     </a>
     <span class="lineno">
      172
     </span>
    </div>
    <div class="line">
     <a name="l00176">
     </a>
     <span class="lineno">
      <a class="line" href="namespaceML_1_1TSNE.html#a9d78d3857b24a12489c7f11f554f7aba">
       176
      </a>
     </span>
     __global__
     <a class="code" href="namespaceML_1_1TSNE.html#a3fd0469bdd73eaf1f777c1ff1aee929b">
      __launch_bounds__
     </a>
     (
    </div>
    <div class="line">
     <a name="l00177">
     </a>
     <span class="lineno">
      177
     </span>
     <a class="code" href="bh__kernels_8h.html#a86edd6193b14e2e0597fddab89881e3a">
      THREADS2
     </a>
     ,
     <a class="code" href="bh__kernels_8h.html#ab64e4c5074162a06e839885cba787ecc">
      FACTOR2
     </a>
     )
     <span class="keywordtype">
      void
     </span>
     TreeBuildingKernel(
     <span class="comment">
      /* int *restrict errd, */
     </span>
    </div>
    <div class="line">
     <a name="l00178">
     </a>
     <span class="lineno">
      178
     </span>
     <span class="keywordtype">
      int
     </span>
     *
     <a class="code" href="bh__kernels_8h.html#a080abdcb9c02438f1cd2bb707af25af8">
      restrict
     </a>
     <a class="code" href="namespaceML_1_1TSNE.html#ad7b00d371d403bb26f2bb196659e9c56">
      childd
     </a>
     ,
    </div>
    <div class="line">
     <a name="l00179">
     </a>
     <span class="lineno">
      179
     </span>
     <span class="keyword">
      const
     </span>
     <span class="keywordtype">
      float
     </span>
     *
     <a class="code" href="bh__kernels_8h.html#a080abdcb9c02438f1cd2bb707af25af8">
      restrict
     </a>
     <a class="code" href="namespaceML_1_1TSNE.html#ad5c3a149f16c2850ff03ca0d4182b594">
      posxd
     </a>
     ,
    </div>
    <div class="line">
     <a name="l00180">
     </a>
     <span class="lineno">
      180
     </span>
     <span class="keyword">
      const
     </span>
     <span class="keywordtype">
      float
     </span>
     *
     <a class="code" href="bh__kernels_8h.html#a080abdcb9c02438f1cd2bb707af25af8">
      restrict
     </a>
     <a class="code" href="namespaceML_1_1TSNE.html#abe37b2672d24fb0a19db8757502e120f">
      posyd
     </a>
     ,
    </div>
    <div class="line">
     <a name="l00181">
     </a>
     <span class="lineno">
      181
     </span>
     <span class="keyword">
      const
     </span>
     <span class="keywordtype">
      int
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a1d775ae44089726fc5f8d66f78528ada">
      NNODES
     </a>
     ,
     <span class="keyword">
      const
     </span>
     <span class="keywordtype">
      int
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a7086cebb5fe77bd10499d494328ba1c1">
      N
     </a>
     ,
    </div>
    <div class="line">
     <a name="l00182">
     </a>
     <span class="lineno">
      <a class="line" href="namespaceML_1_1TSNE.html#aa2dfafe57a92a0075fe925a8a7dc45f5">
       182
      </a>
     </span>
     <span class="keywordtype">
      int
     </span>
     *
     <a class="code" href="bh__kernels_8h.html#a080abdcb9c02438f1cd2bb707af25af8">
      restrict
     </a>
     <a class="code" href="namespaceML_1_1TSNE.html#aa2dfafe57a92a0075fe925a8a7dc45f5">
      maxdepthd
     </a>
     ,
    </div>
    <div class="line">
     <a name="l00183">
     </a>
     <span class="lineno">
      <a class="line" href="namespaceML_1_1TSNE.html#aa94ac12848f403e7c569e5de3037b206">
       183
      </a>
     </span>
     <span class="keywordtype">
      int
     </span>
     *
     <a class="code" href="bh__kernels_8h.html#a080abdcb9c02438f1cd2bb707af25af8">
      restrict
     </a>
     <a class="code" href="namespaceML_1_1TSNE.html#aa94ac12848f403e7c569e5de3037b206">
      bottomd
     </a>
     ,
    </div>
    <div class="line">
     <a name="l00184">
     </a>
     <span class="lineno">
      184
     </span>
     <span class="keyword">
      const
     </span>
     <span class="keywordtype">
      float
     </span>
     *
     <a class="code" href="bh__kernels_8h.html#a080abdcb9c02438f1cd2bb707af25af8">
      restrict
     </a>
     <a class="code" href="namespaceML_1_1TSNE.html#a167f3c550a51b8a44d7d6fed46db0546">
      radiusd
     </a>
     ) {
    </div>
    <div class="line">
     <a name="l00185">
     </a>
     <span class="lineno">
      185
     </span>
     <span class="keywordtype">
      int
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#aa7af7a282a727812d02249e36b56d7cb">
      j
     </a>
     , depth;
    </div>
    <div class="line">
     <a name="l00186">
     </a>
     <span class="lineno">
      <a class="line" href="namespaceML_1_1TSNE.html#adb4b8ca36469774be6ffb11068071cbc">
       186
      </a>
     </span>
     <span class="keywordtype">
      float
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a5c7478abb28859ec13dec63fa777a04e">
      x
     </a>
     ,
     <a class="code" href="namespaceML_1_1TSNE.html#adb4b8ca36469774be6ffb11068071cbc">
      y
     </a>
     ,
     <a class="code" href="namespaceML_1_1TSNE.html#affcebed822e95c0573529aa4d3cd1609">
      r
     </a>
     ;
    </div>
    <div class="line">
     <a name="l00187">
     </a>
     <span class="lineno">
      <a class="line" href="namespaceML_1_1TSNE.html#a41a8f2080a734018c9bb091e0c551a10">
       187
      </a>
     </span>
     <span class="keywordtype">
      float
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a545006d7604664ff5e093702ff8fc196">
      px
     </a>
     ,
     <a class="code" href="namespaceML_1_1TSNE.html#a41a8f2080a734018c9bb091e0c551a10">
      py
     </a>
     ;
    </div>
    <div class="line">
     <a name="l00188">
     </a>
     <span class="lineno">
      <a class="line" href="namespaceML_1_1TSNE.html#aaa80214511d623eac23f6e19a154fc02">
       188
      </a>
     </span>
     <span class="keywordtype">
      int
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a8d0e55527f603695851cd43670718ac2">
      ch
     </a>
     ,
     <a class="code" href="namespaceML_1_1TSNE.html#a1cd86a623f64db84ca537da23b68223c">
      n
     </a>
     ,
     <a class="code" href="namespaceML_1_1TSNE.html#a7b19a2886fa3ed52496d77f9c2bbd440">
      locked
     </a>
     ,
     <a class="code" href="namespaceML_1_1TSNE.html#aaa80214511d623eac23f6e19a154fc02">
      patch
     </a>
     ;
    </div>
    <div class="line">
     <a name="l00189">
     </a>
     <span class="lineno">
      189
     </span>
    </div>
    <div class="line">
     <a name="l00190">
     </a>
     <span class="lineno">
      190
     </span>
     <span class="comment">
      // cache root data
     </span>
    </div>
    <div class="line">
     <a name="l00191">
     </a>
     <span class="lineno">
      <a class="line" href="namespaceML_1_1TSNE.html#a63100ce0727aa1b75a80b0d9651c133a">
       191
      </a>
     </span>
     <span class="keyword">
      const
     </span>
     <span class="keywordtype">
      float
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a63100ce0727aa1b75a80b0d9651c133a">
      radius
     </a>
     =
     <a class="code" href="namespaceML_1_1TSNE.html#a167f3c550a51b8a44d7d6fed46db0546">
      radiusd
     </a>
     [0];
    </div>
    <div class="line">
     <a name="l00192">
     </a>
     <span class="lineno">
      <a class="line" href="namespaceML_1_1TSNE.html#a5ce45a143c09583658ad00ac3c219c5e">
       192
      </a>
     </span>
     <span class="keyword">
      const
     </span>
     <span class="keywordtype">
      float
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a5ce45a143c09583658ad00ac3c219c5e">
      rootx
     </a>
     =
     <a class="code" href="namespaceML_1_1TSNE.html#ad5c3a149f16c2850ff03ca0d4182b594">
      posxd
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#a1d775ae44089726fc5f8d66f78528ada">
      NNODES
     </a>
     ];
    </div>
    <div class="line">
     <a name="l00193">
     </a>
     <span class="lineno">
      <a class="line" href="namespaceML_1_1TSNE.html#a10fffba66c9ffb66ba7102e04eecb2fd">
       193
      </a>
     </span>
     <span class="keyword">
      const
     </span>
     <span class="keywordtype">
      float
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a10fffba66c9ffb66ba7102e04eecb2fd">
      rooty
     </a>
     =
     <a class="code" href="namespaceML_1_1TSNE.html#abe37b2672d24fb0a19db8757502e120f">
      posyd
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#a1d775ae44089726fc5f8d66f78528ada">
      NNODES
     </a>
     ];
    </div>
    <div class="line">
     <a name="l00194">
     </a>
     <span class="lineno">
      194
     </span>
    </div>
    <div class="line">
     <a name="l00195">
     </a>
     <span class="lineno">
      <a class="line" href="namespaceML_1_1TSNE.html#a875e5b422b8d5c082b909357872daa59">
       195
      </a>
     </span>
     <span class="keywordtype">
      int
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a875e5b422b8d5c082b909357872daa59">
      localmaxdepth
     </a>
     = 1;
    </div>
    <div class="line">
     <a name="l00196">
     </a>
     <span class="lineno">
      <a class="line" href="namespaceML_1_1TSNE.html#a121d25f1b38a1dabf92d06f8bdbc681b">
       196
      </a>
     </span>
     <span class="keywordtype">
      int
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a121d25f1b38a1dabf92d06f8bdbc681b">
      skip
     </a>
     = 1;
    </div>
    <div class="line">
     <a name="l00197">
     </a>
     <span class="lineno">
      197
     </span>
     <span class="keyword">
      const
     </span>
     <span class="keywordtype">
      int
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#acfb1787f01f8a74fab3ad6d557ec9ffe">
      inc
     </a>
     = blockDim.x * gridDim.x;
    </div>
    <div class="line">
     <a name="l00198">
     </a>
     <span class="lineno">
      198
     </span>
     <span class="keywordtype">
      int
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     = threadIdx.x + blockIdx.x * blockDim.x;
    </div>
    <div class="line">
     <a name="l00199">
     </a>
     <span class="lineno">
      199
     </span>
    </div>
    <div class="line">
     <a name="l00200">
     </a>
     <span class="lineno">
      200
     </span>
     <span class="comment">
      // iterate over all bodies assigned to thread
     </span>
    </div>
    <div class="line">
     <a name="l00201">
     </a>
     <span class="lineno">
      <a class="line" href="namespaceML_1_1TSNE.html#ad7068f23951af58b6bdf4dd53041eefc">
       201
      </a>
     </span>
     <span class="keywordflow">
      while
     </span>
     (
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     &lt;
     <a class="code" href="namespaceML_1_1TSNE.html#a7086cebb5fe77bd10499d494328ba1c1">
      N
     </a>
     ) {
    </div>
    <div class="line">
     <a name="l00202">
     </a>
     <span class="lineno">
      202
     </span>
     <span class="keywordflow">
      if
     </span>
     (
     <a class="code" href="namespaceML_1_1TSNE.html#a121d25f1b38a1dabf92d06f8bdbc681b">
      skip
     </a>
     != 0) {
    </div>
    <div class="line">
     <a name="l00203">
     </a>
     <span class="lineno">
      203
     </span>
     <span class="comment">
      // new body, so start traversing at root
     </span>
    </div>
    <div class="line">
     <a name="l00204">
     </a>
     <span class="lineno">
      204
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a121d25f1b38a1dabf92d06f8bdbc681b">
      skip
     </a>
     = 0;
    </div>
    <div class="line">
     <a name="l00205">
     </a>
     <span class="lineno">
      205
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a1cd86a623f64db84ca537da23b68223c">
      n
     </a>
     =
     <a class="code" href="namespaceML_1_1TSNE.html#a1d775ae44089726fc5f8d66f78528ada">
      NNODES
     </a>
     ;
    </div>
    <div class="line">
     <a name="l00206">
     </a>
     <span class="lineno">
      206
     </span>
     depth = 1;
    </div>
    <div class="line">
     <a name="l00207">
     </a>
     <span class="lineno">
      207
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#affcebed822e95c0573529aa4d3cd1609">
      r
     </a>
     =
     <a class="code" href="namespaceML_1_1TSNE.html#a63100ce0727aa1b75a80b0d9651c133a">
      radius
     </a>
     * 0.5f;
    </div>
    <div class="line">
     <a name="l00208">
     </a>
     <span class="lineno">
      208
     </span>
    </div>
    <div class="line">
     <a name="l00209">
     </a>
     <span class="lineno">
      209
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a5c7478abb28859ec13dec63fa777a04e">
      x
     </a>
     =
     <a class="code" href="namespaceML_1_1TSNE.html#a5ce45a143c09583658ad00ac3c219c5e">
      rootx
     </a>
     + ((
     <a class="code" href="namespaceML_1_1TSNE.html#a5ce45a143c09583658ad00ac3c219c5e">
      rootx
     </a>
     &lt; (
     <a class="code" href="namespaceML_1_1TSNE.html#a545006d7604664ff5e093702ff8fc196">
      px
     </a>
     =
     <a class="code" href="namespaceML_1_1TSNE.html#ad5c3a149f16c2850ff03ca0d4182b594">
      posxd
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     ])) ? (
     <a class="code" href="namespaceML_1_1TSNE.html#aa7af7a282a727812d02249e36b56d7cb">
      j
     </a>
     = 1,
     <a class="code" href="namespaceML_1_1TSNE.html#affcebed822e95c0573529aa4d3cd1609">
      r
     </a>
     ) : (
     <a class="code" href="namespaceML_1_1TSNE.html#aa7af7a282a727812d02249e36b56d7cb">
      j
     </a>
     = 0, -
     <a class="code" href="namespaceML_1_1TSNE.html#affcebed822e95c0573529aa4d3cd1609">
      r
     </a>
     ));
    </div>
    <div class="line">
     <a name="l00210">
     </a>
     <span class="lineno">
      210
     </span>
    </div>
    <div class="line">
     <a name="l00211">
     </a>
     <span class="lineno">
      211
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#adb4b8ca36469774be6ffb11068071cbc">
      y
     </a>
     =
     <a class="code" href="namespaceML_1_1TSNE.html#a10fffba66c9ffb66ba7102e04eecb2fd">
      rooty
     </a>
     + ((
     <a class="code" href="namespaceML_1_1TSNE.html#a10fffba66c9ffb66ba7102e04eecb2fd">
      rooty
     </a>
     &lt; (
     <a class="code" href="namespaceML_1_1TSNE.html#a41a8f2080a734018c9bb091e0c551a10">
      py
     </a>
     =
     <a class="code" href="namespaceML_1_1TSNE.html#abe37b2672d24fb0a19db8757502e120f">
      posyd
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     ])) ? (
     <a class="code" href="namespaceML_1_1TSNE.html#aa7af7a282a727812d02249e36b56d7cb">
      j
     </a>
     |= 2,
     <a class="code" href="namespaceML_1_1TSNE.html#affcebed822e95c0573529aa4d3cd1609">
      r
     </a>
     ) : (-
     <a class="code" href="namespaceML_1_1TSNE.html#affcebed822e95c0573529aa4d3cd1609">
      r
     </a>
     ));
    </div>
    <div class="line">
     <a name="l00212">
     </a>
     <span class="lineno">
      212
     </span>
     }
    </div>
    <div class="line">
     <a name="l00213">
     </a>
     <span class="lineno">
      213
     </span>
    </div>
    <div class="line">
     <a name="l00214">
     </a>
     <span class="lineno">
      214
     </span>
     <span class="comment">
      // follow path to leaf cell
     </span>
    </div>
    <div class="line">
     <a name="l00215">
     </a>
     <span class="lineno">
      215
     </span>
     <span class="keywordflow">
      while
     </span>
     ((
     <a class="code" href="namespaceML_1_1TSNE.html#a8d0e55527f603695851cd43670718ac2">
      ch
     </a>
     =
     <a class="code" href="namespaceML_1_1TSNE.html#ad7b00d371d403bb26f2bb196659e9c56">
      childd
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#a1cd86a623f64db84ca537da23b68223c">
      n
     </a>
     * 4 +
     <a class="code" href="namespaceML_1_1TSNE.html#aa7af7a282a727812d02249e36b56d7cb">
      j
     </a>
     ]) &gt;=
     <a class="code" href="namespaceML_1_1TSNE.html#a7086cebb5fe77bd10499d494328ba1c1">
      N
     </a>
     ) {
    </div>
    <div class="line">
     <a name="l00216">
     </a>
     <span class="lineno">
      216
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a1cd86a623f64db84ca537da23b68223c">
      n
     </a>
     =
     <a class="code" href="namespaceML_1_1TSNE.html#a8d0e55527f603695851cd43670718ac2">
      ch
     </a>
     ;
    </div>
    <div class="line">
     <a name="l00217">
     </a>
     <span class="lineno">
      217
     </span>
     depth++;
    </div>
    <div class="line">
     <a name="l00218">
     </a>
     <span class="lineno">
      218
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#affcebed822e95c0573529aa4d3cd1609">
      r
     </a>
     *= 0.5f;
    </div>
    <div class="line">
     <a name="l00219">
     </a>
     <span class="lineno">
      219
     </span>
    </div>
    <div class="line">
     <a name="l00220">
     </a>
     <span class="lineno">
      220
     </span>
     <span class="comment">
      // determine which child to follow
     </span>
    </div>
    <div class="line">
     <a name="l00221">
     </a>
     <span class="lineno">
      221
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a5c7478abb28859ec13dec63fa777a04e">
      x
     </a>
     += ((
     <a class="code" href="namespaceML_1_1TSNE.html#a5c7478abb28859ec13dec63fa777a04e">
      x
     </a>
     &lt;
     <a class="code" href="namespaceML_1_1TSNE.html#a545006d7604664ff5e093702ff8fc196">
      px
     </a>
     ) ? (
     <a class="code" href="namespaceML_1_1TSNE.html#aa7af7a282a727812d02249e36b56d7cb">
      j
     </a>
     = 1,
     <a class="code" href="namespaceML_1_1TSNE.html#affcebed822e95c0573529aa4d3cd1609">
      r
     </a>
     ) : (
     <a class="code" href="namespaceML_1_1TSNE.html#aa7af7a282a727812d02249e36b56d7cb">
      j
     </a>
     = 0, -
     <a class="code" href="namespaceML_1_1TSNE.html#affcebed822e95c0573529aa4d3cd1609">
      r
     </a>
     ));
    </div>
    <div class="line">
     <a name="l00222">
     </a>
     <span class="lineno">
      222
     </span>
    </div>
    <div class="line">
     <a name="l00223">
     </a>
     <span class="lineno">
      223
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#adb4b8ca36469774be6ffb11068071cbc">
      y
     </a>
     += ((
     <a class="code" href="namespaceML_1_1TSNE.html#adb4b8ca36469774be6ffb11068071cbc">
      y
     </a>
     &lt;
     <a class="code" href="namespaceML_1_1TSNE.html#a41a8f2080a734018c9bb091e0c551a10">
      py
     </a>
     ) ? (
     <a class="code" href="namespaceML_1_1TSNE.html#aa7af7a282a727812d02249e36b56d7cb">
      j
     </a>
     |= 2,
     <a class="code" href="namespaceML_1_1TSNE.html#affcebed822e95c0573529aa4d3cd1609">
      r
     </a>
     ) : (-
     <a class="code" href="namespaceML_1_1TSNE.html#affcebed822e95c0573529aa4d3cd1609">
      r
     </a>
     ));
    </div>
    <div class="line">
     <a name="l00224">
     </a>
     <span class="lineno">
      224
     </span>
     }
    </div>
    <div class="line">
     <a name="l00225">
     </a>
     <span class="lineno">
      225
     </span>
    </div>
    <div class="line">
     <a name="l00226">
     </a>
     <span class="lineno">
      226
     </span>
     <span class="keywordflow">
      if
     </span>
     (
     <a class="code" href="namespaceML_1_1TSNE.html#a8d0e55527f603695851cd43670718ac2">
      ch
     </a>
     != -2) {
    </div>
    <div class="line">
     <a name="l00227">
     </a>
     <span class="lineno">
      227
     </span>
     <span class="comment">
      // skip if child pointer is locked and try again later
     </span>
    </div>
    <div class="line">
     <a name="l00228">
     </a>
     <span class="lineno">
      228
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a7b19a2886fa3ed52496d77f9c2bbd440">
      locked
     </a>
     =
     <a class="code" href="namespaceML_1_1TSNE.html#a1cd86a623f64db84ca537da23b68223c">
      n
     </a>
     * 4 +
     <a class="code" href="namespaceML_1_1TSNE.html#aa7af7a282a727812d02249e36b56d7cb">
      j
     </a>
     ;
    </div>
    <div class="line">
     <a name="l00229">
     </a>
     <span class="lineno">
      229
     </span>
    </div>
    <div class="line">
     <a name="l00230">
     </a>
     <span class="lineno">
      230
     </span>
     <span class="keywordflow">
      if
     </span>
     (
     <a class="code" href="namespaceML_1_1TSNE.html#a8d0e55527f603695851cd43670718ac2">
      ch
     </a>
     == -1) {
    </div>
    <div class="line">
     <a name="l00231">
     </a>
     <span class="lineno">
      231
     </span>
     <span class="keywordflow">
      if
     </span>
     (atomicCAS(&amp;
     <a class="code" href="namespaceML_1_1TSNE.html#ad7b00d371d403bb26f2bb196659e9c56">
      childd
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#a7b19a2886fa3ed52496d77f9c2bbd440">
      locked
     </a>
     ], -1,
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     ) == -1) {
    </div>
    <div class="line">
     <a name="l00232">
     </a>
     <span class="lineno">
      232
     </span>
     <span class="keywordflow">
      if
     </span>
     (depth &gt;
     <a class="code" href="namespaceML_1_1TSNE.html#a875e5b422b8d5c082b909357872daa59">
      localmaxdepth
     </a>
     )
     <a class="code" href="namespaceML_1_1TSNE.html#a875e5b422b8d5c082b909357872daa59">
      localmaxdepth
     </a>
     = depth;
    </div>
    <div class="line">
     <a name="l00233">
     </a>
     <span class="lineno">
      233
     </span>
    </div>
    <div class="line">
     <a name="l00234">
     </a>
     <span class="lineno">
      234
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     +=
     <a class="code" href="namespaceML_1_1TSNE.html#acfb1787f01f8a74fab3ad6d557ec9ffe">
      inc
     </a>
     ;
     <span class="comment">
      // move on to next body
     </span>
    </div>
    <div class="line">
     <a name="l00235">
     </a>
     <span class="lineno">
      235
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a121d25f1b38a1dabf92d06f8bdbc681b">
      skip
     </a>
     = 1;
    </div>
    <div class="line">
     <a name="l00236">
     </a>
     <span class="lineno">
      236
     </span>
     }
    </div>
    <div class="line">
     <a name="l00237">
     </a>
     <span class="lineno">
      237
     </span>
     }
     <span class="keywordflow">
      else
     </span>
     {
    </div>
    <div class="line">
     <a name="l00238">
     </a>
     <span class="lineno">
      238
     </span>
     <span class="keywordflow">
      if
     </span>
     (
     <a class="code" href="namespaceML_1_1TSNE.html#a8d0e55527f603695851cd43670718ac2">
      ch
     </a>
     == atomicCAS(&amp;
     <a class="code" href="namespaceML_1_1TSNE.html#ad7b00d371d403bb26f2bb196659e9c56">
      childd
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#a7b19a2886fa3ed52496d77f9c2bbd440">
      locked
     </a>
     ],
     <a class="code" href="namespaceML_1_1TSNE.html#a8d0e55527f603695851cd43670718ac2">
      ch
     </a>
     , -2)) {
    </div>
    <div class="line">
     <a name="l00239">
     </a>
     <span class="lineno">
      239
     </span>
     <span class="comment">
      // try to lock
     </span>
    </div>
    <div class="line">
     <a name="l00240">
     </a>
     <span class="lineno">
      240
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#aaa80214511d623eac23f6e19a154fc02">
      patch
     </a>
     = -1;
    </div>
    <div class="line">
     <a name="l00241">
     </a>
     <span class="lineno">
      241
     </span>
    </div>
    <div class="line">
     <a name="l00242">
     </a>
     <span class="lineno">
      242
     </span>
     <span class="keywordflow">
      while
     </span>
     (
     <a class="code" href="namespaceML_1_1TSNE.html#a8d0e55527f603695851cd43670718ac2">
      ch
     </a>
     &gt;= 0) {
    </div>
    <div class="line">
     <a name="l00243">
     </a>
     <span class="lineno">
      243
     </span>
     depth++;
    </div>
    <div class="line">
     <a name="l00244">
     </a>
     <span class="lineno">
      244
     </span>
    </div>
    <div class="line">
     <a name="l00245">
     </a>
     <span class="lineno">
      245
     </span>
     <span class="keyword">
      const
     </span>
     <span class="keywordtype">
      int
     </span>
     cell = atomicSub(
     <a class="code" href="namespaceML_1_1TSNE.html#aa94ac12848f403e7c569e5de3037b206">
      bottomd
     </a>
     , 1) - 1;
    </div>
    <div class="line">
     <a name="l00246">
     </a>
     <span class="lineno">
      246
     </span>
     <span class="keywordflow">
      if
     </span>
     (cell &lt;=
     <a class="code" href="namespaceML_1_1TSNE.html#a7086cebb5fe77bd10499d494328ba1c1">
      N
     </a>
     ) {
    </div>
    <div class="line">
     <a name="l00247">
     </a>
     <span class="lineno">
      247
     </span>
     <span class="comment">
      // atomicExch(errd, 1);
     </span>
    </div>
    <div class="line">
     <a name="l00248">
     </a>
     <span class="lineno">
      248
     </span>
     atomicExch(
     <a class="code" href="namespaceML_1_1TSNE.html#aa94ac12848f403e7c569e5de3037b206">
      bottomd
     </a>
     ,
     <a class="code" href="namespaceML_1_1TSNE.html#a1d775ae44089726fc5f8d66f78528ada">
      NNODES
     </a>
     );
    </div>
    <div class="line">
     <a name="l00249">
     </a>
     <span class="lineno">
      249
     </span>
     }
    </div>
    <div class="line">
     <a name="l00250">
     </a>
     <span class="lineno">
      250
     </span>
    </div>
    <div class="line">
     <a name="l00251">
     </a>
     <span class="lineno">
      251
     </span>
     <span class="keywordflow">
      if
     </span>
     (
     <a class="code" href="namespaceML_1_1TSNE.html#aaa80214511d623eac23f6e19a154fc02">
      patch
     </a>
     != -1)
     <a class="code" href="namespaceML_1_1TSNE.html#ad7b00d371d403bb26f2bb196659e9c56">
      childd
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#a1cd86a623f64db84ca537da23b68223c">
      n
     </a>
     * 4 +
     <a class="code" href="namespaceML_1_1TSNE.html#aa7af7a282a727812d02249e36b56d7cb">
      j
     </a>
     ] = cell;
    </div>
    <div class="line">
     <a name="l00252">
     </a>
     <span class="lineno">
      252
     </span>
    </div>
    <div class="line">
     <a name="l00253">
     </a>
     <span class="lineno">
      253
     </span>
     <span class="keywordflow">
      if
     </span>
     (cell &gt;
     <a class="code" href="namespaceML_1_1TSNE.html#aaa80214511d623eac23f6e19a154fc02">
      patch
     </a>
     )
     <a class="code" href="namespaceML_1_1TSNE.html#aaa80214511d623eac23f6e19a154fc02">
      patch
     </a>
     = cell;
    </div>
    <div class="line">
     <a name="l00254">
     </a>
     <span class="lineno">
      254
     </span>
    </div>
    <div class="line">
     <a name="l00255">
     </a>
     <span class="lineno">
      255
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#aa7af7a282a727812d02249e36b56d7cb">
      j
     </a>
     = (
     <a class="code" href="namespaceML_1_1TSNE.html#a5c7478abb28859ec13dec63fa777a04e">
      x
     </a>
     &lt;
     <a class="code" href="namespaceML_1_1TSNE.html#ad5c3a149f16c2850ff03ca0d4182b594">
      posxd
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#a8d0e55527f603695851cd43670718ac2">
      ch
     </a>
     ]) ? 1 : 0;
    </div>
    <div class="line">
     <a name="l00256">
     </a>
     <span class="lineno">
      256
     </span>
     <span class="keywordflow">
      if
     </span>
     (
     <a class="code" href="namespaceML_1_1TSNE.html#adb4b8ca36469774be6ffb11068071cbc">
      y
     </a>
     &lt;
     <a class="code" href="namespaceML_1_1TSNE.html#abe37b2672d24fb0a19db8757502e120f">
      posyd
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#a8d0e55527f603695851cd43670718ac2">
      ch
     </a>
     ])
     <a class="code" href="namespaceML_1_1TSNE.html#aa7af7a282a727812d02249e36b56d7cb">
      j
     </a>
     |= 2;
    </div>
    <div class="line">
     <a name="l00257">
     </a>
     <span class="lineno">
      257
     </span>
    </div>
    <div class="line">
     <a name="l00258">
     </a>
     <span class="lineno">
      258
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#ad7b00d371d403bb26f2bb196659e9c56">
      childd
     </a>
     [cell * 4 +
     <a class="code" href="namespaceML_1_1TSNE.html#aa7af7a282a727812d02249e36b56d7cb">
      j
     </a>
     ] =
     <a class="code" href="namespaceML_1_1TSNE.html#a8d0e55527f603695851cd43670718ac2">
      ch
     </a>
     ;
    </div>
    <div class="line">
     <a name="l00259">
     </a>
     <span class="lineno">
      259
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a1cd86a623f64db84ca537da23b68223c">
      n
     </a>
     = cell;
    </div>
    <div class="line">
     <a name="l00260">
     </a>
     <span class="lineno">
      260
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#affcebed822e95c0573529aa4d3cd1609">
      r
     </a>
     *= 0.5f;
    </div>
    <div class="line">
     <a name="l00261">
     </a>
     <span class="lineno">
      261
     </span>
    </div>
    <div class="line">
     <a name="l00262">
     </a>
     <span class="lineno">
      262
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a5c7478abb28859ec13dec63fa777a04e">
      x
     </a>
     += ((
     <a class="code" href="namespaceML_1_1TSNE.html#a5c7478abb28859ec13dec63fa777a04e">
      x
     </a>
     &lt;
     <a class="code" href="namespaceML_1_1TSNE.html#a545006d7604664ff5e093702ff8fc196">
      px
     </a>
     ) ? (
     <a class="code" href="namespaceML_1_1TSNE.html#aa7af7a282a727812d02249e36b56d7cb">
      j
     </a>
     = 1,
     <a class="code" href="namespaceML_1_1TSNE.html#affcebed822e95c0573529aa4d3cd1609">
      r
     </a>
     ) : (
     <a class="code" href="namespaceML_1_1TSNE.html#aa7af7a282a727812d02249e36b56d7cb">
      j
     </a>
     = 0, -
     <a class="code" href="namespaceML_1_1TSNE.html#affcebed822e95c0573529aa4d3cd1609">
      r
     </a>
     ));
    </div>
    <div class="line">
     <a name="l00263">
     </a>
     <span class="lineno">
      263
     </span>
    </div>
    <div class="line">
     <a name="l00264">
     </a>
     <span class="lineno">
      264
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#adb4b8ca36469774be6ffb11068071cbc">
      y
     </a>
     += ((
     <a class="code" href="namespaceML_1_1TSNE.html#adb4b8ca36469774be6ffb11068071cbc">
      y
     </a>
     &lt;
     <a class="code" href="namespaceML_1_1TSNE.html#a41a8f2080a734018c9bb091e0c551a10">
      py
     </a>
     ) ? (
     <a class="code" href="namespaceML_1_1TSNE.html#aa7af7a282a727812d02249e36b56d7cb">
      j
     </a>
     |= 2,
     <a class="code" href="namespaceML_1_1TSNE.html#affcebed822e95c0573529aa4d3cd1609">
      r
     </a>
     ) : (-
     <a class="code" href="namespaceML_1_1TSNE.html#affcebed822e95c0573529aa4d3cd1609">
      r
     </a>
     ));
    </div>
    <div class="line">
     <a name="l00265">
     </a>
     <span class="lineno">
      265
     </span>
    </div>
    <div class="line">
     <a name="l00266">
     </a>
     <span class="lineno">
      266
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a8d0e55527f603695851cd43670718ac2">
      ch
     </a>
     =
     <a class="code" href="namespaceML_1_1TSNE.html#ad7b00d371d403bb26f2bb196659e9c56">
      childd
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#a1cd86a623f64db84ca537da23b68223c">
      n
     </a>
     * 4 +
     <a class="code" href="namespaceML_1_1TSNE.html#aa7af7a282a727812d02249e36b56d7cb">
      j
     </a>
     ];
    </div>
    <div class="line">
     <a name="l00267">
     </a>
     <span class="lineno">
      267
     </span>
     <span class="keywordflow">
      if
     </span>
     (
     <a class="code" href="namespaceML_1_1TSNE.html#affcebed822e95c0573529aa4d3cd1609">
      r
     </a>
     &lt;= 1e-10)
     <span class="keywordflow">
      break
     </span>
     ;
    </div>
    <div class="line">
     <a name="l00268">
     </a>
     <span class="lineno">
      268
     </span>
     }
    </div>
    <div class="line">
     <a name="l00269">
     </a>
     <span class="lineno">
      269
     </span>
    </div>
    <div class="line">
     <a name="l00270">
     </a>
     <span class="lineno">
      270
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#ad7b00d371d403bb26f2bb196659e9c56">
      childd
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#a1cd86a623f64db84ca537da23b68223c">
      n
     </a>
     * 4 +
     <a class="code" href="namespaceML_1_1TSNE.html#aa7af7a282a727812d02249e36b56d7cb">
      j
     </a>
     ] =
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     ;
    </div>
    <div class="line">
     <a name="l00271">
     </a>
     <span class="lineno">
      271
     </span>
    </div>
    <div class="line">
     <a name="l00272">
     </a>
     <span class="lineno">
      272
     </span>
     <span class="keywordflow">
      if
     </span>
     (depth &gt;
     <a class="code" href="namespaceML_1_1TSNE.html#a875e5b422b8d5c082b909357872daa59">
      localmaxdepth
     </a>
     )
     <a class="code" href="namespaceML_1_1TSNE.html#a875e5b422b8d5c082b909357872daa59">
      localmaxdepth
     </a>
     = depth;
    </div>
    <div class="line">
     <a name="l00273">
     </a>
     <span class="lineno">
      273
     </span>
    </div>
    <div class="line">
     <a name="l00274">
     </a>
     <span class="lineno">
      274
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     +=
     <a class="code" href="namespaceML_1_1TSNE.html#acfb1787f01f8a74fab3ad6d557ec9ffe">
      inc
     </a>
     ;
     <span class="comment">
      // move on to next body
     </span>
    </div>
    <div class="line">
     <a name="l00275">
     </a>
     <span class="lineno">
      275
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a121d25f1b38a1dabf92d06f8bdbc681b">
      skip
     </a>
     = 2;
    </div>
    <div class="line">
     <a name="l00276">
     </a>
     <span class="lineno">
      276
     </span>
     }
    </div>
    <div class="line">
     <a name="l00277">
     </a>
     <span class="lineno">
      277
     </span>
     }
    </div>
    <div class="line">
     <a name="l00278">
     </a>
     <span class="lineno">
      278
     </span>
     }
    </div>
    <div class="line">
     <a name="l00279">
     </a>
     <span class="lineno">
      279
     </span>
     __threadfence();
    </div>
    <div class="line">
     <a name="l00280">
     </a>
     <span class="lineno">
      280
     </span>
    </div>
    <div class="line">
     <a name="l00281">
     </a>
     <span class="lineno">
      281
     </span>
     <span class="keywordflow">
      if
     </span>
     (
     <a class="code" href="namespaceML_1_1TSNE.html#a121d25f1b38a1dabf92d06f8bdbc681b">
      skip
     </a>
     == 2)
     <a class="code" href="namespaceML_1_1TSNE.html#ad7b00d371d403bb26f2bb196659e9c56">
      childd
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#a7b19a2886fa3ed52496d77f9c2bbd440">
      locked
     </a>
     ] =
     <a class="code" href="namespaceML_1_1TSNE.html#aaa80214511d623eac23f6e19a154fc02">
      patch
     </a>
     ;
    </div>
    <div class="line">
     <a name="l00282">
     </a>
     <span class="lineno">
      282
     </span>
     }
    </div>
    <div class="line">
     <a name="l00283">
     </a>
     <span class="lineno">
      283
     </span>
    </div>
    <div class="line">
     <a name="l00284">
     </a>
     <span class="lineno">
      284
     </span>
     <span class="comment">
      // record maximum tree depth
     </span>
    </div>
    <div class="line">
     <a name="l00285">
     </a>
     <span class="lineno">
      285
     </span>
     <span class="comment">
      // if (localmaxdepth &gt;= THREADS5)
     </span>
    </div>
    <div class="line">
     <a name="l00286">
     </a>
     <span class="lineno">
      286
     </span>
     <span class="comment">
      //   localmaxdepth = THREADS5 - 1;
     </span>
    </div>
    <div class="line">
     <a name="l00287">
     </a>
     <span class="lineno">
      <a class="line" href="namespaceML_1_1TSNE.html#a36475708a50853d9e12fd3b069e79ae4">
       287
      </a>
     </span>
     <span class="keywordflow">
      if
     </span>
     (
     <a class="code" href="namespaceML_1_1TSNE.html#a875e5b422b8d5c082b909357872daa59">
      localmaxdepth
     </a>
     &gt; 32)
     <a class="code" href="namespaceML_1_1TSNE.html#a875e5b422b8d5c082b909357872daa59">
      localmaxdepth
     </a>
     = 32;
    </div>
    <div class="line">
     <a name="l00288">
     </a>
     <span class="lineno">
      288
     </span>
    </div>
    <div class="line">
     <a name="l00289">
     </a>
     <span class="lineno">
      <a class="line" href="namespaceML_1_1TSNE.html#a3fefd48af2c466fc1b1c62023383ea7b">
       289
      </a>
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a3fefd48af2c466fc1b1c62023383ea7b">
      atomicMax
     </a>
     (
     <a class="code" href="namespaceML_1_1TSNE.html#aa2dfafe57a92a0075fe925a8a7dc45f5">
      maxdepthd
     </a>
     ,
     <a class="code" href="namespaceML_1_1TSNE.html#a875e5b422b8d5c082b909357872daa59">
      localmaxdepth
     </a>
     );
    </div>
    <div class="line">
     <a name="l00290">
     </a>
     <span class="lineno">
      290
     </span>
     }
    </div>
    <div class="line">
     <a name="l00291">
     </a>
     <span class="lineno">
      291
     </span>
    </div>
    <div class="line">
     <a name="l00295">
     </a>
     <span class="lineno">
      295
     </span>
     __global__
     <a class="code" href="namespaceML_1_1TSNE.html#a3fd0469bdd73eaf1f777c1ff1aee929b">
      __launch_bounds__
     </a>
     (1024,
    </div>
    <div class="line">
     <a name="l00296">
     </a>
     <span class="lineno">
      296
     </span>
     1) void ClearKernel2(
     <span class="keywordtype">
      int
     </span>
     *
     <a class="code" href="bh__kernels_8h.html#a080abdcb9c02438f1cd2bb707af25af8">
      restrict
     </a>
     <a class="code" href="namespaceML_1_1TSNE.html#a2732a645713566a20477f67210871121">
      startd
     </a>
     ,
    </div>
    <div class="line">
     <a name="l00297">
     </a>
     <span class="lineno">
      297
     </span>
     <span class="keywordtype">
      float
     </span>
     *
     <a class="code" href="bh__kernels_8h.html#a080abdcb9c02438f1cd2bb707af25af8">
      restrict
     </a>
     <a class="code" href="namespaceML_1_1TSNE.html#aaeba4f3e347780328e08a424e719255e">
      massd
     </a>
     ,
    </div>
    <div class="line">
     <a name="l00298">
     </a>
     <span class="lineno">
      298
     </span>
     const
     <span class="keywordtype">
      int
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a1d775ae44089726fc5f8d66f78528ada">
      NNODES
     </a>
     ,
    </div>
    <div class="line">
     <a name="l00299">
     </a>
     <span class="lineno">
      299
     </span>
     const
     <span class="keywordtype">
      int
     </span>
     *
     <a class="code" href="bh__kernels_8h.html#a080abdcb9c02438f1cd2bb707af25af8">
      restrict
     </a>
     <a class="code" href="namespaceML_1_1TSNE.html#aa94ac12848f403e7c569e5de3037b206">
      bottomd
     </a>
     ) {
    </div>
    <div class="line">
     <a name="l00300">
     </a>
     <span class="lineno">
      300
     </span>
     <span class="keyword">
      const
     </span>
     <span class="keywordtype">
      int
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#ac2ed5d1c15f05f27281f106028c4c525">
      bottom
     </a>
     =
     <a class="code" href="namespaceML_1_1TSNE.html#aa94ac12848f403e7c569e5de3037b206">
      bottomd
     </a>
     [0];
    </div>
    <div class="line">
     <a name="l00301">
     </a>
     <span class="lineno">
      301
     </span>
     <span class="keyword">
      const
     </span>
     <span class="keywordtype">
      int
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#acfb1787f01f8a74fab3ad6d557ec9ffe">
      inc
     </a>
     = blockDim.x * gridDim.x;
    </div>
    <div class="line">
     <a name="l00302">
     </a>
     <span class="lineno">
      302
     </span>
     <span class="keywordtype">
      int
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#afb851e919e0cd78a7c66faf65d407452">
      k
     </a>
     = (
     <a class="code" href="namespaceML_1_1TSNE.html#ac2ed5d1c15f05f27281f106028c4c525">
      bottom
     </a>
     &amp; -32) + threadIdx.x + blockIdx.x * blockDim.x;
    </div>
    <div class="line">
     <a name="l00303">
     </a>
     <span class="lineno">
      303
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a5e6127c8e89f25aba2fc545044afcb4a">
      if
     </a>
     (
     <a class="code" href="namespaceML_1_1TSNE.html#afb851e919e0cd78a7c66faf65d407452">
      k
     </a>
     &lt;
     <a class="code" href="namespaceML_1_1TSNE.html#ac2ed5d1c15f05f27281f106028c4c525">
      bottom
     </a>
     )
     <a class="code" href="namespaceML_1_1TSNE.html#afb851e919e0cd78a7c66faf65d407452">
      k
     </a>
     +=
     <a class="code" href="namespaceML_1_1TSNE.html#acfb1787f01f8a74fab3ad6d557ec9ffe">
      inc
     </a>
     ;
    </div>
    <div class="line">
     <a name="l00304">
     </a>
     <span class="lineno">
      304
     </span>
    </div>
    <div class="line">
     <a name="l00305">
     </a>
     <span class="lineno">
      305
     </span>
     <span class="comment">
      // iterate over all cells assigned to thread
     </span>
    </div>
    <div class="line">
     <a name="l00306">
     </a>
     <span class="lineno">
      306
     </span>
     <span class="preprocessor">
      #pragma unroll
     </span>
    </div>
    <div class="line">
     <a name="l00307">
     </a>
     <span class="lineno">
      307
     </span>
     <span class="keywordflow">
      for
     </span>
     (;
     <a class="code" href="namespaceML_1_1TSNE.html#afb851e919e0cd78a7c66faf65d407452">
      k
     </a>
     &lt;
     <a class="code" href="namespaceML_1_1TSNE.html#a1d775ae44089726fc5f8d66f78528ada">
      NNODES
     </a>
     ;
     <a class="code" href="namespaceML_1_1TSNE.html#afb851e919e0cd78a7c66faf65d407452">
      k
     </a>
     +=
     <a class="code" href="namespaceML_1_1TSNE.html#acfb1787f01f8a74fab3ad6d557ec9ffe">
      inc
     </a>
     ) {
    </div>
    <div class="line">
     <a name="l00308">
     </a>
     <span class="lineno">
      308
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#aaeba4f3e347780328e08a424e719255e">
      massd
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#afb851e919e0cd78a7c66faf65d407452">
      k
     </a>
     ] = -1.0f;
    </div>
    <div class="line">
     <a name="l00309">
     </a>
     <span class="lineno">
      309
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a2732a645713566a20477f67210871121">
      startd
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#afb851e919e0cd78a7c66faf65d407452">
      k
     </a>
     ] = -1;
    </div>
    <div class="line">
     <a name="l00310">
     </a>
     <span class="lineno">
      310
     </span>
     }
    </div>
    <div class="line">
     <a name="l00311">
     </a>
     <span class="lineno">
      311
     </span>
     }
    </div>
    <div class="line">
     <a name="l00312">
     </a>
     <span class="lineno">
      312
     </span>
    </div>
    <div class="line">
     <a name="l00316">
     </a>
     <span class="lineno">
      <a class="line" href="namespaceML_1_1TSNE.html#a50c51d1d22e979e9a9daf8729be21b03">
       316
      </a>
     </span>
     __global__
     <a class="code" href="namespaceML_1_1TSNE.html#a3fd0469bdd73eaf1f777c1ff1aee929b">
      __launch_bounds__
     </a>
     (
     <a class="code" href="bh__kernels_8h.html#a508375c867f31fb42c1135881ddfd8f3">
      THREADS3
     </a>
     ,
     <a class="code" href="bh__kernels_8h.html#a996f9a6fd15089ce39bccf4143a01a50">
      FACTOR3
     </a>
     )
     <span class="keywordtype">
      void
     </span>
     SummarizationKernel(
    </div>
    <div class="line">
     <a name="l00317">
     </a>
     <span class="lineno">
      317
     </span>
     <span class="keywordtype">
      int
     </span>
     *
     <a class="code" href="bh__kernels_8h.html#a080abdcb9c02438f1cd2bb707af25af8">
      restrict
     </a>
     <a class="code" href="namespaceML_1_1TSNE.html#a6f907825b88704a837d42ff66f3e77b7">
      countd
     </a>
     ,
     <span class="keyword">
      const
     </span>
     <span class="keywordtype">
      int
     </span>
     *
     <a class="code" href="bh__kernels_8h.html#a080abdcb9c02438f1cd2bb707af25af8">
      restrict
     </a>
     <a class="code" href="namespaceML_1_1TSNE.html#ad7b00d371d403bb26f2bb196659e9c56">
      childd
     </a>
     ,
    </div>
    <div class="line">
     <a name="l00318">
     </a>
     <span class="lineno">
      318
     </span>
     <span class="keyword">
      volatile
     </span>
     <span class="keywordtype">
      float
     </span>
     *
     <a class="code" href="bh__kernels_8h.html#a080abdcb9c02438f1cd2bb707af25af8">
      restrict
     </a>
     <a class="code" href="namespaceML_1_1TSNE.html#aaeba4f3e347780328e08a424e719255e">
      massd
     </a>
     ,
     <span class="keywordtype">
      float
     </span>
     *
     <a class="code" href="bh__kernels_8h.html#a080abdcb9c02438f1cd2bb707af25af8">
      restrict
     </a>
     <a class="code" href="namespaceML_1_1TSNE.html#ad5c3a149f16c2850ff03ca0d4182b594">
      posxd
     </a>
     ,
     <span class="keywordtype">
      float
     </span>
     *
     <a class="code" href="bh__kernels_8h.html#a080abdcb9c02438f1cd2bb707af25af8">
      restrict
     </a>
     <a class="code" href="namespaceML_1_1TSNE.html#abe37b2672d24fb0a19db8757502e120f">
      posyd
     </a>
     ,
    </div>
    <div class="line">
     <a name="l00319">
     </a>
     <span class="lineno">
      319
     </span>
     <span class="keyword">
      const
     </span>
     <span class="keywordtype">
      int
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a1d775ae44089726fc5f8d66f78528ada">
      NNODES
     </a>
     ,
     <span class="keyword">
      const
     </span>
     <span class="keywordtype">
      int
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a7086cebb5fe77bd10499d494328ba1c1">
      N
     </a>
     ,
     <span class="keyword">
      const
     </span>
     <span class="keywordtype">
      int
     </span>
     *
     <a class="code" href="bh__kernels_8h.html#a080abdcb9c02438f1cd2bb707af25af8">
      restrict
     </a>
     <a class="code" href="namespaceML_1_1TSNE.html#aa94ac12848f403e7c569e5de3037b206">
      bottomd
     </a>
     ) {
    </div>
    <div class="line">
     <a name="l00320">
     </a>
     <span class="lineno">
      320
     </span>
     <span class="keywordtype">
      bool
     </span>
     flag = 0;
    </div>
    <div class="line">
     <a name="l00321">
     </a>
     <span class="lineno">
      <a class="line" href="namespaceML_1_1TSNE.html#a5d845ae81f2e9512c6fde326db6193c3">
       321
      </a>
     </span>
     <span class="keywordtype">
      float
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a5d845ae81f2e9512c6fde326db6193c3">
      cm
     </a>
     ,
     <a class="code" href="namespaceML_1_1TSNE.html#a545006d7604664ff5e093702ff8fc196">
      px
     </a>
     ,
     <a class="code" href="namespaceML_1_1TSNE.html#a41a8f2080a734018c9bb091e0c551a10">
      py
     </a>
     ;
    </div>
    <div class="line">
     <a name="l00322">
     </a>
     <span class="lineno">
      <a class="line" href="namespaceML_1_1TSNE.html#a65b34cd3b27de3fc6cc33c96e19970e1">
       322
      </a>
     </span>
     __shared__
     <span class="keywordtype">
      int
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a65b34cd3b27de3fc6cc33c96e19970e1">
      child
     </a>
     [
     <a class="code" href="bh__kernels_8h.html#a508375c867f31fb42c1135881ddfd8f3">
      THREADS3
     </a>
     * 4];
    </div>
    <div class="line">
     <a name="l00323">
     </a>
     <span class="lineno">
      <a class="line" href="namespaceML_1_1TSNE.html#afbe45ee536ce9f686021d1d0a0a7e280">
       323
      </a>
     </span>
     __shared__
     <span class="keywordtype">
      float
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#afbe45ee536ce9f686021d1d0a0a7e280">
      mass
     </a>
     [
     <a class="code" href="bh__kernels_8h.html#a508375c867f31fb42c1135881ddfd8f3">
      THREADS3
     </a>
     * 4];
    </div>
    <div class="line">
     <a name="l00324">
     </a>
     <span class="lineno">
      324
     </span>
    </div>
    <div class="line">
     <a name="l00325">
     </a>
     <span class="lineno">
      <a class="line" href="namespaceML_1_1TSNE.html#ac2ed5d1c15f05f27281f106028c4c525">
       325
      </a>
     </span>
     <span class="keyword">
      const
     </span>
     <span class="keywordtype">
      int
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#ac2ed5d1c15f05f27281f106028c4c525">
      bottom
     </a>
     =
     <a class="code" href="namespaceML_1_1TSNE.html#aa94ac12848f403e7c569e5de3037b206">
      bottomd
     </a>
     [0];
    </div>
    <div class="line">
     <a name="l00326">
     </a>
     <span class="lineno">
      326
     </span>
     <span class="keyword">
      const
     </span>
     <span class="keywordtype">
      int
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#acfb1787f01f8a74fab3ad6d557ec9ffe">
      inc
     </a>
     = blockDim.x * gridDim.x;
    </div>
    <div class="line">
     <a name="l00327">
     </a>
     <span class="lineno">
      327
     </span>
     <span class="keywordtype">
      int
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#afb851e919e0cd78a7c66faf65d407452">
      k
     </a>
     = (
     <a class="code" href="namespaceML_1_1TSNE.html#ac2ed5d1c15f05f27281f106028c4c525">
      bottom
     </a>
     &amp; -32) + threadIdx.x + blockIdx.x * blockDim.x;
    </div>
    <div class="line">
     <a name="l00328">
     </a>
     <span class="lineno">
      328
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a5e6127c8e89f25aba2fc545044afcb4a">
      if
     </a>
     (
     <a class="code" href="namespaceML_1_1TSNE.html#afb851e919e0cd78a7c66faf65d407452">
      k
     </a>
     &lt;
     <a class="code" href="namespaceML_1_1TSNE.html#ac2ed5d1c15f05f27281f106028c4c525">
      bottom
     </a>
     )
     <a class="code" href="namespaceML_1_1TSNE.html#afb851e919e0cd78a7c66faf65d407452">
      k
     </a>
     +=
     <a class="code" href="namespaceML_1_1TSNE.html#acfb1787f01f8a74fab3ad6d557ec9ffe">
      inc
     </a>
     ;
    </div>
    <div class="line">
     <a name="l00329">
     </a>
     <span class="lineno">
      329
     </span>
    </div>
    <div class="line">
     <a name="l00330">
     </a>
     <span class="lineno">
      <a class="line" href="namespaceML_1_1TSNE.html#a2dfe618ef9e2266e96748bc7006d47fa">
       330
      </a>
     </span>
     <span class="keyword">
      const
     </span>
     <span class="keywordtype">
      int
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a2dfe618ef9e2266e96748bc7006d47fa">
      restart
     </a>
     =
     <a class="code" href="namespaceML_1_1TSNE.html#afb851e919e0cd78a7c66faf65d407452">
      k
     </a>
     ;
    </div>
    <div class="line">
     <a name="l00331">
     </a>
     <span class="lineno">
      331
     </span>
    </div>
    <div class="line">
     <a name="l00332">
     </a>
     <span class="lineno">
      332
     </span>
     <span class="keywordflow">
      for
     </span>
     (
     <span class="keywordtype">
      int
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#aa7af7a282a727812d02249e36b56d7cb">
      j
     </a>
     = 0;
     <a class="code" href="namespaceML_1_1TSNE.html#aa7af7a282a727812d02249e36b56d7cb">
      j
     </a>
     &lt; 5;
     <a class="code" href="namespaceML_1_1TSNE.html#aa7af7a282a727812d02249e36b56d7cb">
      j
     </a>
     ++)
     <span class="comment">
      // wait-free pre-passes
     </span>
    </div>
    <div class="line">
     <a name="l00333">
     </a>
     <span class="lineno">
      333
     </span>
     {
    </div>
    <div class="line">
     <a name="l00334">
     </a>
     <span class="lineno">
      334
     </span>
     <span class="comment">
      // iterate over all cells assigned to thread
     </span>
    </div>
    <div class="line">
     <a name="l00335">
     </a>
     <span class="lineno">
      335
     </span>
     <span class="keywordflow">
      while
     </span>
     (
     <a class="code" href="namespaceML_1_1TSNE.html#afb851e919e0cd78a7c66faf65d407452">
      k
     </a>
     &lt;=
     <a class="code" href="namespaceML_1_1TSNE.html#a1d775ae44089726fc5f8d66f78528ada">
      NNODES
     </a>
     ) {
    </div>
    <div class="line">
     <a name="l00336">
     </a>
     <span class="lineno">
      336
     </span>
     <span class="keywordflow">
      if
     </span>
     (
     <a class="code" href="namespaceML_1_1TSNE.html#aaeba4f3e347780328e08a424e719255e">
      massd
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#afb851e919e0cd78a7c66faf65d407452">
      k
     </a>
     ] &lt; 0.0
     <a class="code" href="namespaceUMAPAlgo_1_1Optimize.html#ad1d8470650aa6ea82693fdf61479e708">
      f
     </a>
     ) {
    </div>
    <div class="line">
     <a name="l00337">
     </a>
     <span class="lineno">
      337
     </span>
     <span class="keywordflow">
      for
     </span>
     (
     <span class="keywordtype">
      int
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     = 0;
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     &lt; 4;
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     ++) {
    </div>
    <div class="line">
     <a name="l00338">
     </a>
     <span class="lineno">
      338
     </span>
     <span class="keyword">
      const
     </span>
     <span class="keywordtype">
      int
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a8d0e55527f603695851cd43670718ac2">
      ch
     </a>
     =
     <a class="code" href="namespaceML_1_1TSNE.html#ad7b00d371d403bb26f2bb196659e9c56">
      childd
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#afb851e919e0cd78a7c66faf65d407452">
      k
     </a>
     * 4 +
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     ];
    </div>
    <div class="line">
     <a name="l00339">
     </a>
     <span class="lineno">
      339
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a65b34cd3b27de3fc6cc33c96e19970e1">
      child
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     *
     <a class="code" href="bh__kernels_8h.html#a508375c867f31fb42c1135881ddfd8f3">
      THREADS3
     </a>
     + threadIdx.x] =
     <a class="code" href="namespaceML_1_1TSNE.html#a8d0e55527f603695851cd43670718ac2">
      ch
     </a>
     ;
    </div>
    <div class="line">
     <a name="l00340">
     </a>
     <span class="lineno">
      340
     </span>
    </div>
    <div class="line">
     <a name="l00341">
     </a>
     <span class="lineno">
      341
     </span>
     <span class="keywordflow">
      if
     </span>
     ((
     <a class="code" href="namespaceML_1_1TSNE.html#a8d0e55527f603695851cd43670718ac2">
      ch
     </a>
     &gt;=
     <a class="code" href="namespaceML_1_1TSNE.html#a7086cebb5fe77bd10499d494328ba1c1">
      N
     </a>
     ) and
    </div>
    <div class="line">
     <a name="l00342">
     </a>
     <span class="lineno">
      342
     </span>
     ((
     <a class="code" href="namespaceML_1_1TSNE.html#afbe45ee536ce9f686021d1d0a0a7e280">
      mass
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     *
     <a class="code" href="bh__kernels_8h.html#a508375c867f31fb42c1135881ddfd8f3">
      THREADS3
     </a>
     + threadIdx.x] =
     <a class="code" href="namespaceML_1_1TSNE.html#aaeba4f3e347780328e08a424e719255e">
      massd
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#a8d0e55527f603695851cd43670718ac2">
      ch
     </a>
     ]) &lt; 0))
    </div>
    <div class="line">
     <a name="l00343">
     </a>
     <span class="lineno">
      343
     </span>
     <span class="keywordflow">
      goto
     </span>
     CONTINUE_LOOP;
    </div>
    <div class="line">
     <a name="l00344">
     </a>
     <span class="lineno">
      344
     </span>
     }
    </div>
    <div class="line">
     <a name="l00345">
     </a>
     <span class="lineno">
      345
     </span>
    </div>
    <div class="line">
     <a name="l00346">
     </a>
     <span class="lineno">
      346
     </span>
     <span class="comment">
      // all children are ready
     </span>
    </div>
    <div class="line">
     <a name="l00347">
     </a>
     <span class="lineno">
      347
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a5d845ae81f2e9512c6fde326db6193c3">
      cm
     </a>
     = 0.0f;
    </div>
    <div class="line">
     <a name="l00348">
     </a>
     <span class="lineno">
      348
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a545006d7604664ff5e093702ff8fc196">
      px
     </a>
     = 0.0f;
    </div>
    <div class="line">
     <a name="l00349">
     </a>
     <span class="lineno">
      349
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a41a8f2080a734018c9bb091e0c551a10">
      py
     </a>
     = 0.0f;
    </div>
    <div class="line">
     <a name="l00350">
     </a>
     <span class="lineno">
      350
     </span>
     <span class="keywordtype">
      int
     </span>
     cnt = 0;
    </div>
    <div class="line">
     <a name="l00351">
     </a>
     <span class="lineno">
      351
     </span>
    </div>
    <div class="line">
     <a name="l00352">
     </a>
     <span class="lineno">
      352
     </span>
     <span class="preprocessor">
      #pragma unroll
     </span>
    </div>
    <div class="line">
     <a name="l00353">
     </a>
     <span class="lineno">
      353
     </span>
     <span class="keywordflow">
      for
     </span>
     (
     <span class="keywordtype">
      int
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     = 0;
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     &lt; 4;
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     ++) {
    </div>
    <div class="line">
     <a name="l00354">
     </a>
     <span class="lineno">
      354
     </span>
     <span class="keyword">
      const
     </span>
     <span class="keywordtype">
      int
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a8d0e55527f603695851cd43670718ac2">
      ch
     </a>
     =
     <a class="code" href="namespaceML_1_1TSNE.html#a65b34cd3b27de3fc6cc33c96e19970e1">
      child
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     *
     <a class="code" href="bh__kernels_8h.html#a508375c867f31fb42c1135881ddfd8f3">
      THREADS3
     </a>
     + threadIdx.x];
    </div>
    <div class="line">
     <a name="l00355">
     </a>
     <span class="lineno">
      355
     </span>
     <span class="keywordflow">
      if
     </span>
     (
     <a class="code" href="namespaceML_1_1TSNE.html#a8d0e55527f603695851cd43670718ac2">
      ch
     </a>
     &gt;= 0) {
    </div>
    <div class="line">
     <a name="l00356">
     </a>
     <span class="lineno">
      356
     </span>
     <span class="keyword">
      const
     </span>
     <span class="keywordtype">
      float
     </span>
     <a class="code" href="namespaceMLCommon_1_1Distance.html#a2424d27a67d0483530b531f6ac12d07f">
      m
     </a>
     =
    </div>
    <div class="line">
     <a name="l00357">
     </a>
     <span class="lineno">
      357
     </span>
     (
     <a class="code" href="namespaceML_1_1TSNE.html#a8d0e55527f603695851cd43670718ac2">
      ch
     </a>
     &gt;=
     <a class="code" href="namespaceML_1_1TSNE.html#a7086cebb5fe77bd10499d494328ba1c1">
      N
     </a>
     ) ? (cnt +=
     <a class="code" href="namespaceML_1_1TSNE.html#a6f907825b88704a837d42ff66f3e77b7">
      countd
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#a8d0e55527f603695851cd43670718ac2">
      ch
     </a>
     ],
     <a class="code" href="namespaceML_1_1TSNE.html#afbe45ee536ce9f686021d1d0a0a7e280">
      mass
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     *
     <a class="code" href="bh__kernels_8h.html#a508375c867f31fb42c1135881ddfd8f3">
      THREADS3
     </a>
     + threadIdx.x])
    </div>
    <div class="line">
     <a name="l00358">
     </a>
     <span class="lineno">
      358
     </span>
     : (cnt++,
     <a class="code" href="namespaceML_1_1TSNE.html#aaeba4f3e347780328e08a424e719255e">
      massd
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#a8d0e55527f603695851cd43670718ac2">
      ch
     </a>
     ]);
    </div>
    <div class="line">
     <a name="l00359">
     </a>
     <span class="lineno">
      359
     </span>
     <span class="comment">
      // add child's contribution
     </span>
    </div>
    <div class="line">
     <a name="l00360">
     </a>
     <span class="lineno">
      360
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a5d845ae81f2e9512c6fde326db6193c3">
      cm
     </a>
     +=
     <a class="code" href="namespaceMLCommon_1_1Distance.html#a2424d27a67d0483530b531f6ac12d07f">
      m
     </a>
     ;
    </div>
    <div class="line">
     <a name="l00361">
     </a>
     <span class="lineno">
      361
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a545006d7604664ff5e093702ff8fc196">
      px
     </a>
     +=
     <a class="code" href="namespaceML_1_1TSNE.html#ad5c3a149f16c2850ff03ca0d4182b594">
      posxd
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#a8d0e55527f603695851cd43670718ac2">
      ch
     </a>
     ] *
     <a class="code" href="namespaceMLCommon_1_1Distance.html#a2424d27a67d0483530b531f6ac12d07f">
      m
     </a>
     ;
    </div>
    <div class="line">
     <a name="l00362">
     </a>
     <span class="lineno">
      362
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a41a8f2080a734018c9bb091e0c551a10">
      py
     </a>
     +=
     <a class="code" href="namespaceML_1_1TSNE.html#abe37b2672d24fb0a19db8757502e120f">
      posyd
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#a8d0e55527f603695851cd43670718ac2">
      ch
     </a>
     ] *
     <a class="code" href="namespaceMLCommon_1_1Distance.html#a2424d27a67d0483530b531f6ac12d07f">
      m
     </a>
     ;
    </div>
    <div class="line">
     <a name="l00363">
     </a>
     <span class="lineno">
      363
     </span>
     }
    </div>
    <div class="line">
     <a name="l00364">
     </a>
     <span class="lineno">
      364
     </span>
     }
    </div>
    <div class="line">
     <a name="l00365">
     </a>
     <span class="lineno">
      365
     </span>
    </div>
    <div class="line">
     <a name="l00366">
     </a>
     <span class="lineno">
      366
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a6f907825b88704a837d42ff66f3e77b7">
      countd
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#afb851e919e0cd78a7c66faf65d407452">
      k
     </a>
     ] = cnt;
    </div>
    <div class="line">
     <a name="l00367">
     </a>
     <span class="lineno">
      367
     </span>
     <span class="keyword">
      const
     </span>
     <span class="keywordtype">
      float
     </span>
     <a class="code" href="namespaceMLCommon_1_1Distance.html#a2424d27a67d0483530b531f6ac12d07f">
      m
     </a>
     = 1.0f /
     <a class="code" href="namespaceML_1_1TSNE.html#a5d845ae81f2e9512c6fde326db6193c3">
      cm
     </a>
     ;
    </div>
    <div class="line">
     <a name="l00368">
     </a>
     <span class="lineno">
      368
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#ad5c3a149f16c2850ff03ca0d4182b594">
      posxd
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#afb851e919e0cd78a7c66faf65d407452">
      k
     </a>
     ] =
     <a class="code" href="namespaceML_1_1TSNE.html#a545006d7604664ff5e093702ff8fc196">
      px
     </a>
     *
     <a class="code" href="namespaceMLCommon_1_1Distance.html#a2424d27a67d0483530b531f6ac12d07f">
      m
     </a>
     ;
    </div>
    <div class="line">
     <a name="l00369">
     </a>
     <span class="lineno">
      369
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#abe37b2672d24fb0a19db8757502e120f">
      posyd
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#afb851e919e0cd78a7c66faf65d407452">
      k
     </a>
     ] =
     <a class="code" href="namespaceML_1_1TSNE.html#a41a8f2080a734018c9bb091e0c551a10">
      py
     </a>
     *
     <a class="code" href="namespaceMLCommon_1_1Distance.html#a2424d27a67d0483530b531f6ac12d07f">
      m
     </a>
     ;
    </div>
    <div class="line">
     <a name="l00370">
     </a>
     <span class="lineno">
      370
     </span>
     __threadfence();
     <span class="comment">
      // make sure data are visible before setting mass
     </span>
    </div>
    <div class="line">
     <a name="l00371">
     </a>
     <span class="lineno">
      371
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#aaeba4f3e347780328e08a424e719255e">
      massd
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#afb851e919e0cd78a7c66faf65d407452">
      k
     </a>
     ] =
     <a class="code" href="namespaceML_1_1TSNE.html#a5d845ae81f2e9512c6fde326db6193c3">
      cm
     </a>
     ;
    </div>
    <div class="line">
     <a name="l00372">
     </a>
     <span class="lineno">
      372
     </span>
     }
    </div>
    <div class="line">
     <a name="l00373">
     </a>
     <span class="lineno">
      373
     </span>
    </div>
    <div class="line">
     <a name="l00374">
     </a>
     <span class="lineno">
      374
     </span>
     CONTINUE_LOOP:
    </div>
    <div class="line">
     <a name="l00375">
     </a>
     <span class="lineno">
      375
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#afb851e919e0cd78a7c66faf65d407452">
      k
     </a>
     +=
     <a class="code" href="namespaceML_1_1TSNE.html#acfb1787f01f8a74fab3ad6d557ec9ffe">
      inc
     </a>
     ;
     <span class="comment">
      // move on to next cell
     </span>
    </div>
    <div class="line">
     <a name="l00376">
     </a>
     <span class="lineno">
      376
     </span>
     }
    </div>
    <div class="line">
     <a name="l00377">
     </a>
     <span class="lineno">
      377
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#afb851e919e0cd78a7c66faf65d407452">
      k
     </a>
     =
     <a class="code" href="namespaceML_1_1TSNE.html#a2dfe618ef9e2266e96748bc7006d47fa">
      restart
     </a>
     ;
    </div>
    <div class="line">
     <a name="l00378">
     </a>
     <span class="lineno">
      378
     </span>
     }
    </div>
    <div class="line">
     <a name="l00379">
     </a>
     <span class="lineno">
      379
     </span>
    </div>
    <div class="line">
     <a name="l00380">
     </a>
     <span class="lineno">
      <a class="line" href="namespaceML_1_1TSNE.html#aa7af7a282a727812d02249e36b56d7cb">
       380
      </a>
     </span>
     <span class="keywordtype">
      int
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#aa7af7a282a727812d02249e36b56d7cb">
      j
     </a>
     = 0;
    </div>
    <div class="line">
     <a name="l00381">
     </a>
     <span class="lineno">
      381
     </span>
     <span class="comment">
      // iterate over all cells assigned to thread
     </span>
    </div>
    <div class="line">
     <a name="l00382">
     </a>
     <span class="lineno">
      <a class="line" href="namespaceML_1_1TSNE.html#ae571ca68ef031cd971657f8a1b0007df">
       382
      </a>
     </span>
     <span class="keywordflow">
      while
     </span>
     (
     <a class="code" href="namespaceML_1_1TSNE.html#afb851e919e0cd78a7c66faf65d407452">
      k
     </a>
     &lt;=
     <a class="code" href="namespaceML_1_1TSNE.html#a1d775ae44089726fc5f8d66f78528ada">
      NNODES
     </a>
     ) {
    </div>
    <div class="line">
     <a name="l00383">
     </a>
     <span class="lineno">
      383
     </span>
     <span class="keywordflow">
      if
     </span>
     (
     <a class="code" href="namespaceML_1_1TSNE.html#aaeba4f3e347780328e08a424e719255e">
      massd
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#afb851e919e0cd78a7c66faf65d407452">
      k
     </a>
     ] &gt;= 0) {
    </div>
    <div class="line">
     <a name="l00384">
     </a>
     <span class="lineno">
      384
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#afb851e919e0cd78a7c66faf65d407452">
      k
     </a>
     +=
     <a class="code" href="namespaceML_1_1TSNE.html#acfb1787f01f8a74fab3ad6d557ec9ffe">
      inc
     </a>
     ;
    </div>
    <div class="line">
     <a name="l00385">
     </a>
     <span class="lineno">
      385
     </span>
     <span class="keywordflow">
      goto
     </span>
     SKIP_LOOP;
    </div>
    <div class="line">
     <a name="l00386">
     </a>
     <span class="lineno">
      386
     </span>
     }
    </div>
    <div class="line">
     <a name="l00387">
     </a>
     <span class="lineno">
      387
     </span>
    </div>
    <div class="line">
     <a name="l00388">
     </a>
     <span class="lineno">
      388
     </span>
     <span class="keywordflow">
      if
     </span>
     (
     <a class="code" href="namespaceML_1_1TSNE.html#aa7af7a282a727812d02249e36b56d7cb">
      j
     </a>
     == 0) {
    </div>
    <div class="line">
     <a name="l00389">
     </a>
     <span class="lineno">
      389
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#aa7af7a282a727812d02249e36b56d7cb">
      j
     </a>
     = 4;
    </div>
    <div class="line">
     <a name="l00390">
     </a>
     <span class="lineno">
      390
     </span>
     <span class="keywordflow">
      for
     </span>
     (
     <span class="keywordtype">
      int
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     = 0;
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     &lt; 4;
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     ++) {
    </div>
    <div class="line">
     <a name="l00391">
     </a>
     <span class="lineno">
      391
     </span>
     <span class="keyword">
      const
     </span>
     <span class="keywordtype">
      int
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a8d0e55527f603695851cd43670718ac2">
      ch
     </a>
     =
     <a class="code" href="namespaceML_1_1TSNE.html#ad7b00d371d403bb26f2bb196659e9c56">
      childd
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#afb851e919e0cd78a7c66faf65d407452">
      k
     </a>
     * 4 +
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     ];
    </div>
    <div class="line">
     <a name="l00392">
     </a>
     <span class="lineno">
      392
     </span>
    </div>
    <div class="line">
     <a name="l00393">
     </a>
     <span class="lineno">
      393
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a65b34cd3b27de3fc6cc33c96e19970e1">
      child
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     *
     <a class="code" href="bh__kernels_8h.html#a508375c867f31fb42c1135881ddfd8f3">
      THREADS3
     </a>
     + threadIdx.x] =
     <a class="code" href="namespaceML_1_1TSNE.html#a8d0e55527f603695851cd43670718ac2">
      ch
     </a>
     ;
    </div>
    <div class="line">
     <a name="l00394">
     </a>
     <span class="lineno">
      394
     </span>
     <span class="keywordflow">
      if
     </span>
     ((
     <a class="code" href="namespaceML_1_1TSNE.html#a8d0e55527f603695851cd43670718ac2">
      ch
     </a>
     &lt;
     <a class="code" href="namespaceML_1_1TSNE.html#a7086cebb5fe77bd10499d494328ba1c1">
      N
     </a>
     ) or ((
     <a class="code" href="namespaceML_1_1TSNE.html#afbe45ee536ce9f686021d1d0a0a7e280">
      mass
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     *
     <a class="code" href="bh__kernels_8h.html#a508375c867f31fb42c1135881ddfd8f3">
      THREADS3
     </a>
     + threadIdx.x] =
     <a class="code" href="namespaceML_1_1TSNE.html#aaeba4f3e347780328e08a424e719255e">
      massd
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#a8d0e55527f603695851cd43670718ac2">
      ch
     </a>
     ]) &gt;= 0))
    </div>
    <div class="line">
     <a name="l00395">
     </a>
     <span class="lineno">
      395
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#aa7af7a282a727812d02249e36b56d7cb">
      j
     </a>
     --;
    </div>
    <div class="line">
     <a name="l00396">
     </a>
     <span class="lineno">
      396
     </span>
     }
    </div>
    <div class="line">
     <a name="l00397">
     </a>
     <span class="lineno">
      397
     </span>
     }
     <span class="keywordflow">
      else
     </span>
     {
    </div>
    <div class="line">
     <a name="l00398">
     </a>
     <span class="lineno">
      398
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#aa7af7a282a727812d02249e36b56d7cb">
      j
     </a>
     = 4;
    </div>
    <div class="line">
     <a name="l00399">
     </a>
     <span class="lineno">
      399
     </span>
     <span class="keywordflow">
      for
     </span>
     (
     <span class="keywordtype">
      int
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     = 0;
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     &lt; 4;
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     ++) {
    </div>
    <div class="line">
     <a name="l00400">
     </a>
     <span class="lineno">
      400
     </span>
     <span class="keyword">
      const
     </span>
     <span class="keywordtype">
      int
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a8d0e55527f603695851cd43670718ac2">
      ch
     </a>
     =
     <a class="code" href="namespaceML_1_1TSNE.html#a65b34cd3b27de3fc6cc33c96e19970e1">
      child
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     *
     <a class="code" href="bh__kernels_8h.html#a508375c867f31fb42c1135881ddfd8f3">
      THREADS3
     </a>
     + threadIdx.x];
    </div>
    <div class="line">
     <a name="l00401">
     </a>
     <span class="lineno">
      401
     </span>
    </div>
    <div class="line">
     <a name="l00402">
     </a>
     <span class="lineno">
      402
     </span>
     <span class="keywordflow">
      if
     </span>
     ((
     <a class="code" href="namespaceML_1_1TSNE.html#a8d0e55527f603695851cd43670718ac2">
      ch
     </a>
     &lt;
     <a class="code" href="namespaceML_1_1TSNE.html#a7086cebb5fe77bd10499d494328ba1c1">
      N
     </a>
     ) or (
     <a class="code" href="namespaceML_1_1TSNE.html#afbe45ee536ce9f686021d1d0a0a7e280">
      mass
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     *
     <a class="code" href="bh__kernels_8h.html#a508375c867f31fb42c1135881ddfd8f3">
      THREADS3
     </a>
     + threadIdx.x] &gt;= 0) or
    </div>
    <div class="line">
     <a name="l00403">
     </a>
     <span class="lineno">
      403
     </span>
     ((
     <a class="code" href="namespaceML_1_1TSNE.html#afbe45ee536ce9f686021d1d0a0a7e280">
      mass
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     *
     <a class="code" href="bh__kernels_8h.html#a508375c867f31fb42c1135881ddfd8f3">
      THREADS3
     </a>
     + threadIdx.x] =
     <a class="code" href="namespaceML_1_1TSNE.html#aaeba4f3e347780328e08a424e719255e">
      massd
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#a8d0e55527f603695851cd43670718ac2">
      ch
     </a>
     ]) &gt;= 0))
    </div>
    <div class="line">
     <a name="l00404">
     </a>
     <span class="lineno">
      404
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#aa7af7a282a727812d02249e36b56d7cb">
      j
     </a>
     --;
    </div>
    <div class="line">
     <a name="l00405">
     </a>
     <span class="lineno">
      405
     </span>
     }
    </div>
    <div class="line">
     <a name="l00406">
     </a>
     <span class="lineno">
      406
     </span>
     }
    </div>
    <div class="line">
     <a name="l00407">
     </a>
     <span class="lineno">
      407
     </span>
    </div>
    <div class="line">
     <a name="l00408">
     </a>
     <span class="lineno">
      408
     </span>
     <span class="keywordflow">
      if
     </span>
     (
     <a class="code" href="namespaceML_1_1TSNE.html#aa7af7a282a727812d02249e36b56d7cb">
      j
     </a>
     == 0) {
    </div>
    <div class="line">
     <a name="l00409">
     </a>
     <span class="lineno">
      409
     </span>
     <span class="comment">
      // all children are ready
     </span>
    </div>
    <div class="line">
     <a name="l00410">
     </a>
     <span class="lineno">
      410
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a5d845ae81f2e9512c6fde326db6193c3">
      cm
     </a>
     = 0.0f;
    </div>
    <div class="line">
     <a name="l00411">
     </a>
     <span class="lineno">
      411
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a545006d7604664ff5e093702ff8fc196">
      px
     </a>
     = 0.0f;
    </div>
    <div class="line">
     <a name="l00412">
     </a>
     <span class="lineno">
      412
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a41a8f2080a734018c9bb091e0c551a10">
      py
     </a>
     = 0.0f;
    </div>
    <div class="line">
     <a name="l00413">
     </a>
     <span class="lineno">
      413
     </span>
     <span class="keywordtype">
      int
     </span>
     cnt = 0;
    </div>
    <div class="line">
     <a name="l00414">
     </a>
     <span class="lineno">
      414
     </span>
    </div>
    <div class="line">
     <a name="l00415">
     </a>
     <span class="lineno">
      415
     </span>
     <span class="preprocessor">
      #pragma unroll
     </span>
    </div>
    <div class="line">
     <a name="l00416">
     </a>
     <span class="lineno">
      416
     </span>
     <span class="keywordflow">
      for
     </span>
     (
     <span class="keywordtype">
      int
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     = 0;
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     &lt; 4;
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     ++) {
    </div>
    <div class="line">
     <a name="l00417">
     </a>
     <span class="lineno">
      417
     </span>
     <span class="keyword">
      const
     </span>
     <span class="keywordtype">
      int
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a8d0e55527f603695851cd43670718ac2">
      ch
     </a>
     =
     <a class="code" href="namespaceML_1_1TSNE.html#a65b34cd3b27de3fc6cc33c96e19970e1">
      child
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     *
     <a class="code" href="bh__kernels_8h.html#a508375c867f31fb42c1135881ddfd8f3">
      THREADS3
     </a>
     + threadIdx.x];
    </div>
    <div class="line">
     <a name="l00418">
     </a>
     <span class="lineno">
      418
     </span>
     <span class="keywordflow">
      if
     </span>
     (
     <a class="code" href="namespaceML_1_1TSNE.html#a8d0e55527f603695851cd43670718ac2">
      ch
     </a>
     &gt;= 0) {
    </div>
    <div class="line">
     <a name="l00419">
     </a>
     <span class="lineno">
      419
     </span>
     <span class="keyword">
      const
     </span>
     <span class="keywordtype">
      float
     </span>
     <a class="code" href="namespaceMLCommon_1_1Distance.html#a2424d27a67d0483530b531f6ac12d07f">
      m
     </a>
     =
    </div>
    <div class="line">
     <a name="l00420">
     </a>
     <span class="lineno">
      420
     </span>
     (
     <a class="code" href="namespaceML_1_1TSNE.html#a8d0e55527f603695851cd43670718ac2">
      ch
     </a>
     &gt;=
     <a class="code" href="namespaceML_1_1TSNE.html#a7086cebb5fe77bd10499d494328ba1c1">
      N
     </a>
     ) ? (cnt +=
     <a class="code" href="namespaceML_1_1TSNE.html#a6f907825b88704a837d42ff66f3e77b7">
      countd
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#a8d0e55527f603695851cd43670718ac2">
      ch
     </a>
     ],
     <a class="code" href="namespaceML_1_1TSNE.html#afbe45ee536ce9f686021d1d0a0a7e280">
      mass
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     *
     <a class="code" href="bh__kernels_8h.html#a508375c867f31fb42c1135881ddfd8f3">
      THREADS3
     </a>
     + threadIdx.x])
    </div>
    <div class="line">
     <a name="l00421">
     </a>
     <span class="lineno">
      421
     </span>
     : (cnt++,
     <a class="code" href="namespaceML_1_1TSNE.html#aaeba4f3e347780328e08a424e719255e">
      massd
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#a8d0e55527f603695851cd43670718ac2">
      ch
     </a>
     ]);
    </div>
    <div class="line">
     <a name="l00422">
     </a>
     <span class="lineno">
      422
     </span>
     <span class="comment">
      // add child's contribution
     </span>
    </div>
    <div class="line">
     <a name="l00423">
     </a>
     <span class="lineno">
      423
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a5d845ae81f2e9512c6fde326db6193c3">
      cm
     </a>
     +=
     <a class="code" href="namespaceMLCommon_1_1Distance.html#a2424d27a67d0483530b531f6ac12d07f">
      m
     </a>
     ;
    </div>
    <div class="line">
     <a name="l00424">
     </a>
     <span class="lineno">
      424
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a545006d7604664ff5e093702ff8fc196">
      px
     </a>
     +=
     <a class="code" href="namespaceML_1_1TSNE.html#ad5c3a149f16c2850ff03ca0d4182b594">
      posxd
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#a8d0e55527f603695851cd43670718ac2">
      ch
     </a>
     ] *
     <a class="code" href="namespaceMLCommon_1_1Distance.html#a2424d27a67d0483530b531f6ac12d07f">
      m
     </a>
     ;
    </div>
    <div class="line">
     <a name="l00425">
     </a>
     <span class="lineno">
      425
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a41a8f2080a734018c9bb091e0c551a10">
      py
     </a>
     +=
     <a class="code" href="namespaceML_1_1TSNE.html#abe37b2672d24fb0a19db8757502e120f">
      posyd
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#a8d0e55527f603695851cd43670718ac2">
      ch
     </a>
     ] *
     <a class="code" href="namespaceMLCommon_1_1Distance.html#a2424d27a67d0483530b531f6ac12d07f">
      m
     </a>
     ;
    </div>
    <div class="line">
     <a name="l00426">
     </a>
     <span class="lineno">
      426
     </span>
     }
    </div>
    <div class="line">
     <a name="l00427">
     </a>
     <span class="lineno">
      427
     </span>
     }
    </div>
    <div class="line">
     <a name="l00428">
     </a>
     <span class="lineno">
      428
     </span>
    </div>
    <div class="line">
     <a name="l00429">
     </a>
     <span class="lineno">
      429
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a6f907825b88704a837d42ff66f3e77b7">
      countd
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#afb851e919e0cd78a7c66faf65d407452">
      k
     </a>
     ] = cnt;
    </div>
    <div class="line">
     <a name="l00430">
     </a>
     <span class="lineno">
      430
     </span>
     <span class="keyword">
      const
     </span>
     <span class="keywordtype">
      float
     </span>
     <a class="code" href="namespaceMLCommon_1_1Distance.html#a2424d27a67d0483530b531f6ac12d07f">
      m
     </a>
     = 1.0f /
     <a class="code" href="namespaceML_1_1TSNE.html#a5d845ae81f2e9512c6fde326db6193c3">
      cm
     </a>
     ;
    </div>
    <div class="line">
     <a name="l00431">
     </a>
     <span class="lineno">
      431
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#ad5c3a149f16c2850ff03ca0d4182b594">
      posxd
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#afb851e919e0cd78a7c66faf65d407452">
      k
     </a>
     ] =
     <a class="code" href="namespaceML_1_1TSNE.html#a545006d7604664ff5e093702ff8fc196">
      px
     </a>
     *
     <a class="code" href="namespaceMLCommon_1_1Distance.html#a2424d27a67d0483530b531f6ac12d07f">
      m
     </a>
     ;
    </div>
    <div class="line">
     <a name="l00432">
     </a>
     <span class="lineno">
      432
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#abe37b2672d24fb0a19db8757502e120f">
      posyd
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#afb851e919e0cd78a7c66faf65d407452">
      k
     </a>
     ] =
     <a class="code" href="namespaceML_1_1TSNE.html#a41a8f2080a734018c9bb091e0c551a10">
      py
     </a>
     *
     <a class="code" href="namespaceMLCommon_1_1Distance.html#a2424d27a67d0483530b531f6ac12d07f">
      m
     </a>
     ;
    </div>
    <div class="line">
     <a name="l00433">
     </a>
     <span class="lineno">
      433
     </span>
     flag = 1;
    </div>
    <div class="line">
     <a name="l00434">
     </a>
     <span class="lineno">
      434
     </span>
     }
    </div>
    <div class="line">
     <a name="l00435">
     </a>
     <span class="lineno">
      435
     </span>
    </div>
    <div class="line">
     <a name="l00436">
     </a>
     <span class="lineno">
      436
     </span>
     SKIP_LOOP:
    </div>
    <div class="line">
     <a name="l00437">
     </a>
     <span class="lineno">
      437
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a98168b1bb13bc28991297eef583f11fe">
      __syncthreads
     </a>
     ();
    </div>
    <div class="line">
     <a name="l00438">
     </a>
     <span class="lineno">
      438
     </span>
     <span class="keywordflow">
      if
     </span>
     (flag != 0) {
    </div>
    <div class="line">
     <a name="l00439">
     </a>
     <span class="lineno">
      439
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#aaeba4f3e347780328e08a424e719255e">
      massd
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#afb851e919e0cd78a7c66faf65d407452">
      k
     </a>
     ] =
     <a class="code" href="namespaceML_1_1TSNE.html#a5d845ae81f2e9512c6fde326db6193c3">
      cm
     </a>
     ;
    </div>
    <div class="line">
     <a name="l00440">
     </a>
     <span class="lineno">
      440
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#afb851e919e0cd78a7c66faf65d407452">
      k
     </a>
     +=
     <a class="code" href="namespaceML_1_1TSNE.html#acfb1787f01f8a74fab3ad6d557ec9ffe">
      inc
     </a>
     ;
    </div>
    <div class="line">
     <a name="l00441">
     </a>
     <span class="lineno">
      441
     </span>
     flag = 0;
    </div>
    <div class="line">
     <a name="l00442">
     </a>
     <span class="lineno">
      442
     </span>
     }
    </div>
    <div class="line">
     <a name="l00443">
     </a>
     <span class="lineno">
      443
     </span>
     }
    </div>
    <div class="line">
     <a name="l00444">
     </a>
     <span class="lineno">
      444
     </span>
     }
    </div>
    <div class="line">
     <a name="l00445">
     </a>
     <span class="lineno">
      445
     </span>
    </div>
    <div class="line">
     <a name="l00449">
     </a>
     <span class="lineno">
      <a class="line" href="namespaceML_1_1TSNE.html#ad3e76017d5e8176c25cf5246a4fe9717">
       449
      </a>
     </span>
     __global__
     <a class="code" href="namespaceML_1_1TSNE.html#a3fd0469bdd73eaf1f777c1ff1aee929b">
      __launch_bounds__
     </a>
     (
     <a class="code" href="bh__kernels_8h.html#a8c1f847aac207a6afbed48210310c789">
      THREADS4
     </a>
     ,
     <a class="code" href="bh__kernels_8h.html#a07bf054e2784d6caf726da0080fc176b">
      FACTOR4
     </a>
     )
     <span class="keywordtype">
      void
     </span>
     SortKernel(
    </div>
    <div class="line">
     <a name="l00450">
     </a>
     <span class="lineno">
      <a class="line" href="namespaceML_1_1TSNE.html#a6f907825b88704a837d42ff66f3e77b7">
       450
      </a>
     </span>
     <span class="keywordtype">
      int
     </span>
     *
     <a class="code" href="bh__kernels_8h.html#a080abdcb9c02438f1cd2bb707af25af8">
      restrict
     </a>
     <a class="code" href="namespaceML_1_1TSNE.html#afaef49165bd5905004bb874599a36a30">
      sortd
     </a>
     ,
     <span class="keyword">
      const
     </span>
     <span class="keywordtype">
      int
     </span>
     *
     <a class="code" href="bh__kernels_8h.html#a080abdcb9c02438f1cd2bb707af25af8">
      restrict
     </a>
     <a class="code" href="namespaceML_1_1TSNE.html#a6f907825b88704a837d42ff66f3e77b7">
      countd
     </a>
     ,
    </div>
    <div class="line">
     <a name="l00451">
     </a>
     <span class="lineno">
      <a class="line" href="namespaceML_1_1TSNE.html#a2732a645713566a20477f67210871121">
       451
      </a>
     </span>
     <span class="keyword">
      volatile
     </span>
     <span class="keywordtype">
      int
     </span>
     *
     <a class="code" href="bh__kernels_8h.html#a080abdcb9c02438f1cd2bb707af25af8">
      restrict
     </a>
     <a class="code" href="namespaceML_1_1TSNE.html#a2732a645713566a20477f67210871121">
      startd
     </a>
     ,
     <span class="keywordtype">
      int
     </span>
     *
     <a class="code" href="bh__kernels_8h.html#a080abdcb9c02438f1cd2bb707af25af8">
      restrict
     </a>
     <a class="code" href="namespaceML_1_1TSNE.html#ad7b00d371d403bb26f2bb196659e9c56">
      childd
     </a>
     ,
     <span class="keyword">
      const
     </span>
     <span class="keywordtype">
      int
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a1d775ae44089726fc5f8d66f78528ada">
      NNODES
     </a>
     ,
    </div>
    <div class="line">
     <a name="l00452">
     </a>
     <span class="lineno">
      452
     </span>
     <span class="keyword">
      const
     </span>
     <span class="keywordtype">
      int
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a7086cebb5fe77bd10499d494328ba1c1">
      N
     </a>
     ,
     <span class="keyword">
      const
     </span>
     <span class="keywordtype">
      int
     </span>
     *
     <a class="code" href="bh__kernels_8h.html#a080abdcb9c02438f1cd2bb707af25af8">
      restrict
     </a>
     <a class="code" href="namespaceML_1_1TSNE.html#aa94ac12848f403e7c569e5de3037b206">
      bottomd
     </a>
     ) {
    </div>
    <div class="line">
     <a name="l00453">
     </a>
     <span class="lineno">
      453
     </span>
     <span class="keyword">
      const
     </span>
     <span class="keywordtype">
      int
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#ac2ed5d1c15f05f27281f106028c4c525">
      bottom
     </a>
     =
     <a class="code" href="namespaceML_1_1TSNE.html#aa94ac12848f403e7c569e5de3037b206">
      bottomd
     </a>
     [0];
    </div>
    <div class="line">
     <a name="l00454">
     </a>
     <span class="lineno">
      <a class="line" href="namespaceML_1_1TSNE.html#a5c84bdf4a3c1a8d60c5e984e7f4eb5a9">
       454
      </a>
     </span>
     <span class="keyword">
      const
     </span>
     <span class="keywordtype">
      int
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a5c84bdf4a3c1a8d60c5e984e7f4eb5a9">
      dec
     </a>
     = blockDim.x * gridDim.x;
    </div>
    <div class="line">
     <a name="l00455">
     </a>
     <span class="lineno">
      455
     </span>
     <span class="keywordtype">
      int
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#afb851e919e0cd78a7c66faf65d407452">
      k
     </a>
     =
     <a class="code" href="namespaceML_1_1TSNE.html#a1d775ae44089726fc5f8d66f78528ada">
      NNODES
     </a>
     + 1 -
     <a class="code" href="namespaceML_1_1TSNE.html#a5c84bdf4a3c1a8d60c5e984e7f4eb5a9">
      dec
     </a>
     + threadIdx.x + blockIdx.x * blockDim.x;
    </div>
    <div class="line">
     <a name="l00456">
     </a>
     <span class="lineno">
      <a class="line" href="namespaceML_1_1TSNE.html#aac7b09a1aa16f82b8663f6fb4b07e592">
       456
      </a>
     </span>
     <span class="keywordtype">
      int
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#aac7b09a1aa16f82b8663f6fb4b07e592">
      start
     </a>
     ;
    </div>
    <div class="line">
     <a name="l00457">
     </a>
     <span class="lineno">
      457
     </span>
     <span class="keywordtype">
      int
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a562384af697c8fbd87301bdadf156b10">
      limiter
     </a>
     = 0;
    </div>
    <div class="line">
     <a name="l00458">
     </a>
     <span class="lineno">
      458
     </span>
    </div>
    <div class="line">
     <a name="l00459">
     </a>
     <span class="lineno">
      459
     </span>
     <span class="comment">
      // iterate over all cells assigned to thread
     </span>
    </div>
    <div class="line">
     <a name="l00460">
     </a>
     <span class="lineno">
      <a class="line" href="namespaceML_1_1TSNE.html#ab98480c4eba8c7d99d8479ecab41eb64">
       460
      </a>
     </span>
     <span class="keywordflow">
      while
     </span>
     (
     <a class="code" href="namespaceML_1_1TSNE.html#afb851e919e0cd78a7c66faf65d407452">
      k
     </a>
     &gt;=
     <a class="code" href="namespaceML_1_1TSNE.html#ac2ed5d1c15f05f27281f106028c4c525">
      bottom
     </a>
     ) {
    </div>
    <div class="line">
     <a name="l00461">
     </a>
     <span class="lineno">
      461
     </span>
     <span class="comment">
      // To control possible infinite loops
     </span>
    </div>
    <div class="line">
     <a name="l00462">
     </a>
     <span class="lineno">
      462
     </span>
     <span class="keywordflow">
      if
     </span>
     (++
     <a class="code" href="namespaceML_1_1TSNE.html#a562384af697c8fbd87301bdadf156b10">
      limiter
     </a>
     &gt;
     <a class="code" href="namespaceML_1_1TSNE.html#a1d775ae44089726fc5f8d66f78528ada">
      NNODES
     </a>
     )
     <span class="keywordflow">
      break
     </span>
     ;
    </div>
    <div class="line">
     <a name="l00463">
     </a>
     <span class="lineno">
      463
     </span>
    </div>
    <div class="line">
     <a name="l00464">
     </a>
     <span class="lineno">
      464
     </span>
     <span class="comment">
      // Not a child so skip
     </span>
    </div>
    <div class="line">
     <a name="l00465">
     </a>
     <span class="lineno">
      465
     </span>
     <span class="keywordflow">
      if
     </span>
     ((
     <a class="code" href="namespaceML_1_1TSNE.html#aac7b09a1aa16f82b8663f6fb4b07e592">
      start
     </a>
     =
     <a class="code" href="namespaceML_1_1TSNE.html#a2732a645713566a20477f67210871121">
      startd
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#afb851e919e0cd78a7c66faf65d407452">
      k
     </a>
     ]) &lt; 0)
     <span class="keywordflow">
      continue
     </span>
     ;
    </div>
    <div class="line">
     <a name="l00466">
     </a>
     <span class="lineno">
      466
     </span>
    </div>
    <div class="line">
     <a name="l00467">
     </a>
     <span class="lineno">
      467
     </span>
     <span class="keywordtype">
      int
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#aa7af7a282a727812d02249e36b56d7cb">
      j
     </a>
     = 0;
    </div>
    <div class="line">
     <a name="l00468">
     </a>
     <span class="lineno">
      468
     </span>
     <span class="keywordflow">
      for
     </span>
     (
     <span class="keywordtype">
      int
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     = 0;
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     &lt; 4;
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     ++) {
    </div>
    <div class="line">
     <a name="l00469">
     </a>
     <span class="lineno">
      469
     </span>
     <span class="keyword">
      const
     </span>
     <span class="keywordtype">
      int
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a8d0e55527f603695851cd43670718ac2">
      ch
     </a>
     =
     <a class="code" href="namespaceML_1_1TSNE.html#ad7b00d371d403bb26f2bb196659e9c56">
      childd
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#afb851e919e0cd78a7c66faf65d407452">
      k
     </a>
     * 4 +
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     ];
    </div>
    <div class="line">
     <a name="l00470">
     </a>
     <span class="lineno">
      470
     </span>
     <span class="keywordflow">
      if
     </span>
     (
     <a class="code" href="namespaceML_1_1TSNE.html#a8d0e55527f603695851cd43670718ac2">
      ch
     </a>
     &gt;= 0) {
    </div>
    <div class="line">
     <a name="l00471">
     </a>
     <span class="lineno">
      471
     </span>
     <span class="keywordflow">
      if
     </span>
     (
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     !=
     <a class="code" href="namespaceML_1_1TSNE.html#aa7af7a282a727812d02249e36b56d7cb">
      j
     </a>
     ) {
    </div>
    <div class="line">
     <a name="l00472">
     </a>
     <span class="lineno">
      472
     </span>
     <span class="comment">
      // move children to front (needed later for speed)
     </span>
    </div>
    <div class="line">
     <a name="l00473">
     </a>
     <span class="lineno">
      473
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#ad7b00d371d403bb26f2bb196659e9c56">
      childd
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#afb851e919e0cd78a7c66faf65d407452">
      k
     </a>
     * 4 +
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     ] = -1;
    </div>
    <div class="line">
     <a name="l00474">
     </a>
     <span class="lineno">
      474
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#ad7b00d371d403bb26f2bb196659e9c56">
      childd
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#afb851e919e0cd78a7c66faf65d407452">
      k
     </a>
     * 4 +
     <a class="code" href="namespaceML_1_1TSNE.html#aa7af7a282a727812d02249e36b56d7cb">
      j
     </a>
     ] =
     <a class="code" href="namespaceML_1_1TSNE.html#a8d0e55527f603695851cd43670718ac2">
      ch
     </a>
     ;
    </div>
    <div class="line">
     <a name="l00475">
     </a>
     <span class="lineno">
      475
     </span>
     }
    </div>
    <div class="line">
     <a name="l00476">
     </a>
     <span class="lineno">
      476
     </span>
     <span class="keywordflow">
      if
     </span>
     (
     <a class="code" href="namespaceML_1_1TSNE.html#a8d0e55527f603695851cd43670718ac2">
      ch
     </a>
     &gt;=
     <a class="code" href="namespaceML_1_1TSNE.html#a7086cebb5fe77bd10499d494328ba1c1">
      N
     </a>
     ) {
    </div>
    <div class="line">
     <a name="l00477">
     </a>
     <span class="lineno">
      477
     </span>
     <span class="comment">
      // child is a cell
     </span>
    </div>
    <div class="line">
     <a name="l00478">
     </a>
     <span class="lineno">
      478
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a2732a645713566a20477f67210871121">
      startd
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#a8d0e55527f603695851cd43670718ac2">
      ch
     </a>
     ] =
     <a class="code" href="namespaceML_1_1TSNE.html#aac7b09a1aa16f82b8663f6fb4b07e592">
      start
     </a>
     ;
    </div>
    <div class="line">
     <a name="l00479">
     </a>
     <span class="lineno">
      479
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#aac7b09a1aa16f82b8663f6fb4b07e592">
      start
     </a>
     +=
     <a class="code" href="namespaceML_1_1TSNE.html#a6f907825b88704a837d42ff66f3e77b7">
      countd
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#a8d0e55527f603695851cd43670718ac2">
      ch
     </a>
     ];
     <span class="comment">
      // add #bodies in subtree
     </span>
    </div>
    <div class="line">
     <a name="l00480">
     </a>
     <span class="lineno">
      480
     </span>
     }
     <span class="keywordflow">
      else
     </span>
     <span class="keywordflow">
      if
     </span>
     (start &lt;= NNODES and start &gt;= 0) {
    </div>
    <div class="line">
     <a name="l00481">
     </a>
     <span class="lineno">
      481
     </span>
     <span class="comment">
      // child is a body
     </span>
    </div>
    <div class="line">
     <a name="l00482">
     </a>
     <span class="lineno">
      482
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#afaef49165bd5905004bb874599a36a30">
      sortd
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#aac7b09a1aa16f82b8663f6fb4b07e592">
      start
     </a>
     ++] =
     <a class="code" href="namespaceML_1_1TSNE.html#a8d0e55527f603695851cd43670718ac2">
      ch
     </a>
     ;
    </div>
    <div class="line">
     <a name="l00483">
     </a>
     <span class="lineno">
      483
     </span>
     }
    </div>
    <div class="line">
     <a name="l00484">
     </a>
     <span class="lineno">
      484
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#aa7af7a282a727812d02249e36b56d7cb">
      j
     </a>
     ++;
    </div>
    <div class="line">
     <a name="l00485">
     </a>
     <span class="lineno">
      485
     </span>
     }
    </div>
    <div class="line">
     <a name="l00486">
     </a>
     <span class="lineno">
      486
     </span>
     }
    </div>
    <div class="line">
     <a name="l00487">
     </a>
     <span class="lineno">
      487
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#afb851e919e0cd78a7c66faf65d407452">
      k
     </a>
     -=
     <a class="code" href="namespaceML_1_1TSNE.html#a5c84bdf4a3c1a8d60c5e984e7f4eb5a9">
      dec
     </a>
     ;
     <span class="comment">
      // move on to next cell
     </span>
    </div>
    <div class="line">
     <a name="l00488">
     </a>
     <span class="lineno">
      488
     </span>
     }
    </div>
    <div class="line">
     <a name="l00489">
     </a>
     <span class="lineno">
      489
     </span>
     }
    </div>
    <div class="line">
     <a name="l00490">
     </a>
     <span class="lineno">
      490
     </span>
    </div>
    <div class="line">
     <a name="l00494">
     </a>
     <span class="lineno">
      <a class="line" href="namespaceML_1_1TSNE.html#a85f382fa3089714b58e2d445a7a3cdc3">
       494
      </a>
     </span>
     __global__
     <a class="code" href="namespaceML_1_1TSNE.html#a3fd0469bdd73eaf1f777c1ff1aee929b">
      __launch_bounds__
     </a>
     (
    </div>
    <div class="line">
     <a name="l00495">
     </a>
     <span class="lineno">
      495
     </span>
     <a class="code" href="bh__kernels_8h.html#a12498f409c0023a090abf74f90b511f8">
      THREADS5
     </a>
     ,
    </div>
    <div class="line">
     <a name="l00496">
     </a>
     <span class="lineno">
      496
     </span>
     <a class="code" href="bh__kernels_8h.html#a48c2c174863ddcf744426fb56be31ef6">
      FACTOR5
     </a>
     )
     <span class="keywordtype">
      void
     </span>
     RepulsionKernel(
     <span class="comment">
      /* int *restrict errd, */
     </span>
    </div>
    <div class="line">
     <a name="l00497">
     </a>
     <span class="lineno">
      497
     </span>
     <span class="keyword">
      const
     </span>
     <span class="keywordtype">
      float
     </span>
     theta,
    </div>
    <div class="line">
     <a name="l00498">
     </a>
     <span class="lineno">
      498
     </span>
     <span class="keyword">
      const
     </span>
     <span class="keywordtype">
      float
     </span>
    </div>
    <div class="line">
     <a name="l00499">
     </a>
     <span class="lineno">
      <a class="line" href="namespaceML_1_1TSNE.html#adcce7a8c238de2a7c2d7005369ca08b3">
       499
      </a>
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#adcce7a8c238de2a7c2d7005369ca08b3">
      epssqd
     </a>
     ,
     <span class="comment">
      // correction for zero distance
     </span>
    </div>
    <div class="line">
     <a name="l00500">
     </a>
     <span class="lineno">
      <a class="line" href="namespaceML_1_1TSNE.html#afaef49165bd5905004bb874599a36a30">
       500
      </a>
     </span>
     <span class="keyword">
      const
     </span>
     <span class="keywordtype">
      int
     </span>
     *
     <a class="code" href="bh__kernels_8h.html#a080abdcb9c02438f1cd2bb707af25af8">
      restrict
     </a>
     <a class="code" href="namespaceML_1_1TSNE.html#afaef49165bd5905004bb874599a36a30">
      sortd
     </a>
     ,
    </div>
    <div class="line">
     <a name="l00501">
     </a>
     <span class="lineno">
      501
     </span>
     <span class="keyword">
      const
     </span>
     <span class="keywordtype">
      int
     </span>
     *
     <a class="code" href="bh__kernels_8h.html#a080abdcb9c02438f1cd2bb707af25af8">
      restrict
     </a>
     <a class="code" href="namespaceML_1_1TSNE.html#ad7b00d371d403bb26f2bb196659e9c56">
      childd
     </a>
     ,
    </div>
    <div class="line">
     <a name="l00502">
     </a>
     <span class="lineno">
      502
     </span>
     <span class="keyword">
      const
     </span>
     <span class="keywordtype">
      float
     </span>
     *
     <a class="code" href="bh__kernels_8h.html#a080abdcb9c02438f1cd2bb707af25af8">
      restrict
     </a>
     <a class="code" href="namespaceML_1_1TSNE.html#aaeba4f3e347780328e08a424e719255e">
      massd
     </a>
     ,
    </div>
    <div class="line">
     <a name="l00503">
     </a>
     <span class="lineno">
      503
     </span>
     <span class="keyword">
      const
     </span>
     <span class="keywordtype">
      float
     </span>
     *
     <a class="code" href="bh__kernels_8h.html#a080abdcb9c02438f1cd2bb707af25af8">
      restrict
     </a>
     <a class="code" href="namespaceML_1_1TSNE.html#ad5c3a149f16c2850ff03ca0d4182b594">
      posxd
     </a>
     ,
    </div>
    <div class="line">
     <a name="l00504">
     </a>
     <span class="lineno">
      504
     </span>
     <span class="keyword">
      const
     </span>
     <span class="keywordtype">
      float
     </span>
     *
     <a class="code" href="bh__kernels_8h.html#a080abdcb9c02438f1cd2bb707af25af8">
      restrict
     </a>
     <a class="code" href="namespaceML_1_1TSNE.html#abe37b2672d24fb0a19db8757502e120f">
      posyd
     </a>
     ,
    </div>
    <div class="line">
     <a name="l00505">
     </a>
     <span class="lineno">
      <a class="line" href="namespaceML_1_1TSNE.html#a35b748d14131f08262d43bd8b09f02e1">
       505
      </a>
     </span>
     <span class="keywordtype">
      float
     </span>
     *
     <a class="code" href="bh__kernels_8h.html#a080abdcb9c02438f1cd2bb707af25af8">
      restrict
     </a>
     <a class="code" href="namespaceML_1_1TSNE.html#a5fb0936df7675d60b572cc1b9f6d34ec">
      velxd
     </a>
     ,
     <span class="keywordtype">
      float
     </span>
     *
     <a class="code" href="bh__kernels_8h.html#a080abdcb9c02438f1cd2bb707af25af8">
      restrict
     </a>
     <a class="code" href="namespaceML_1_1TSNE.html#a35b748d14131f08262d43bd8b09f02e1">
      velyd
     </a>
     ,
    </div>
    <div class="line">
     <a name="l00506">
     </a>
     <span class="lineno">
      <a class="line" href="namespaceML_1_1TSNE.html#ad530b26f03ad51d5eb7fce1926dd2360">
       506
      </a>
     </span>
     <span class="keywordtype">
      float
     </span>
     *
     <a class="code" href="bh__kernels_8h.html#a080abdcb9c02438f1cd2bb707af25af8">
      restrict
     </a>
     <a class="code" href="namespaceML_1_1TSNE.html#ad530b26f03ad51d5eb7fce1926dd2360">
      Z_norm
     </a>
     ,
    </div>
    <div class="line">
     <a name="l00507">
     </a>
     <span class="lineno">
      <a class="line" href="namespaceML_1_1TSNE.html#a9ad8347253e04c7966f2aae19ba1eb77">
       507
      </a>
     </span>
     <span class="keyword">
      const
     </span>
     <span class="keywordtype">
      float
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a9ad8347253e04c7966f2aae19ba1eb77">
      theta_squared
     </a>
     ,
     <span class="keyword">
      const
     </span>
     <span class="keywordtype">
      int
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a1d775ae44089726fc5f8d66f78528ada">
      NNODES
     </a>
     ,
    </div>
    <div class="line">
     <a name="l00508">
     </a>
     <span class="lineno">
      508
     </span>
     <span class="keyword">
      const
     </span>
     <span class="keywordtype">
      int
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#ad506ff98589c53814844d9f8663a127d">
      FOUR_NNODES
     </a>
     ,
     <span class="keyword">
      const
     </span>
     <span class="keywordtype">
      int
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a7086cebb5fe77bd10499d494328ba1c1">
      N
     </a>
     ,
    </div>
    <div class="line">
     <a name="l00509">
     </a>
     <span class="lineno">
      <a class="line" href="namespaceML_1_1TSNE.html#aad1e315a2fa14c6112ce621379d92b4b">
       509
      </a>
     </span>
     <span class="keyword">
      const
     </span>
     <span class="keywordtype">
      float
     </span>
     *
     <a class="code" href="bh__kernels_8h.html#a080abdcb9c02438f1cd2bb707af25af8">
      restrict
     </a>
     <a class="code" href="namespaceML_1_1TSNE.html#aad1e315a2fa14c6112ce621379d92b4b">
      radiusd_squared
     </a>
     ,
    </div>
    <div class="line">
     <a name="l00510">
     </a>
     <span class="lineno">
      510
     </span>
     <span class="keyword">
      const
     </span>
     <span class="keywordtype">
      int
     </span>
     *
     <a class="code" href="bh__kernels_8h.html#a080abdcb9c02438f1cd2bb707af25af8">
      restrict
     </a>
     <a class="code" href="namespaceML_1_1TSNE.html#aa2dfafe57a92a0075fe925a8a7dc45f5">
      maxdepthd
     </a>
     ) {
    </div>
    <div class="line">
     <a name="l00511">
     </a>
     <span class="lineno">
      511
     </span>
     <span class="comment">
      // Return if max depth is too deep
     </span>
    </div>
    <div class="line">
     <a name="l00512">
     </a>
     <span class="lineno">
      512
     </span>
     <span class="comment">
      // Not possible since I limited it to 32
     </span>
    </div>
    <div class="line">
     <a name="l00513">
     </a>
     <span class="lineno">
      513
     </span>
     <span class="comment">
      // if (maxdepthd[0] &gt; 32)
     </span>
    </div>
    <div class="line">
     <a name="l00514">
     </a>
     <span class="lineno">
      514
     </span>
     <span class="comment">
      // {
     </span>
    </div>
    <div class="line">
     <a name="l00515">
     </a>
     <span class="lineno">
      515
     </span>
     <span class="comment">
      //   atomicExch(errd, max_depth);
     </span>
    </div>
    <div class="line">
     <a name="l00516">
     </a>
     <span class="lineno">
      516
     </span>
     <span class="comment">
      //   return;
     </span>
    </div>
    <div class="line">
     <a name="l00517">
     </a>
     <span class="lineno">
      517
     </span>
     <span class="comment">
      // }
     </span>
    </div>
    <div class="line">
     <a name="l00518">
     </a>
     <span class="lineno">
      518
     </span>
     <span class="keyword">
      const
     </span>
     <span class="keywordtype">
      float
     </span>
     EPS_PLUS_1 =
     <a class="code" href="namespaceML_1_1TSNE.html#adcce7a8c238de2a7c2d7005369ca08b3">
      epssqd
     </a>
     + 1.0f;
    </div>
    <div class="line">
     <a name="l00519">
     </a>
     <span class="lineno">
      519
     </span>
    </div>
    <div class="line">
     <a name="l00520">
     </a>
     <span class="lineno">
      <a class="line" href="namespaceML_1_1TSNE.html#abd3dad89a4d38a71f52c1673e31f8723">
       520
      </a>
     </span>
     __shared__
     <span class="keywordtype">
      int
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#abd3dad89a4d38a71f52c1673e31f8723">
      pos
     </a>
     [
     <a class="code" href="bh__kernels_8h.html#a12498f409c0023a090abf74f90b511f8">
      THREADS5
     </a>
     ],
     <a class="code" href="namespaceML_1_1TSNE.html#af16f443a812df8b6cabb5dd30058d377">
      node
     </a>
     [
     <a class="code" href="bh__kernels_8h.html#a12498f409c0023a090abf74f90b511f8">
      THREADS5
     </a>
     ];
    </div>
    <div class="line">
     <a name="l00521">
     </a>
     <span class="lineno">
      <a class="line" href="namespaceML_1_1TSNE.html#ad4056dfe6dce29dbdede1ba6b81d356a">
       521
      </a>
     </span>
     __shared__
     <span class="keywordtype">
      float
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#ad4056dfe6dce29dbdede1ba6b81d356a">
      dq
     </a>
     [
     <a class="code" href="bh__kernels_8h.html#a12498f409c0023a090abf74f90b511f8">
      THREADS5
     </a>
     ];
    </div>
    <div class="line">
     <a name="l00522">
     </a>
     <span class="lineno">
      522
     </span>
    </div>
    <div class="line">
     <a name="l00523">
     </a>
     <span class="lineno">
      <a class="line" href="namespaceML_1_1TSNE.html#aacca21b9d560a6dd012212943f92f8f5">
       523
      </a>
     </span>
     <span class="keywordflow">
      if
     </span>
     (threadIdx.x == 0) {
    </div>
    <div class="line">
     <a name="l00524">
     </a>
     <span class="lineno">
      524
     </span>
     <span class="keyword">
      const
     </span>
     <span class="keywordtype">
      int
     </span>
     max_depth =
     <a class="code" href="namespaceML_1_1TSNE.html#aa2dfafe57a92a0075fe925a8a7dc45f5">
      maxdepthd
     </a>
     [0];
    </div>
    <div class="line">
     <a name="l00525">
     </a>
     <span class="lineno">
      525
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#ad4056dfe6dce29dbdede1ba6b81d356a">
      dq
     </a>
     [0] = __fdividef(
     <a class="code" href="namespaceML_1_1TSNE.html#aad1e315a2fa14c6112ce621379d92b4b">
      radiusd_squared
     </a>
     [0],
     <a class="code" href="namespaceML_1_1TSNE.html#a9ad8347253e04c7966f2aae19ba1eb77">
      theta_squared
     </a>
     );
    </div>
    <div class="line">
     <a name="l00526">
     </a>
     <span class="lineno">
      526
     </span>
    </div>
    <div class="line">
     <a name="l00527">
     </a>
     <span class="lineno">
      527
     </span>
     <span class="keywordflow">
      for
     </span>
     (
     <span class="keywordtype">
      int
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     = 1;
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     &lt; max_depth;
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     ++) {
    </div>
    <div class="line">
     <a name="l00528">
     </a>
     <span class="lineno">
      528
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#ad4056dfe6dce29dbdede1ba6b81d356a">
      dq
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     ] =
     <a class="code" href="namespaceML_1_1TSNE.html#ad4056dfe6dce29dbdede1ba6b81d356a">
      dq
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     - 1] * 0.25f;
    </div>
    <div class="line">
     <a name="l00529">
     </a>
     <span class="lineno">
      529
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#ad4056dfe6dce29dbdede1ba6b81d356a">
      dq
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     - 1] +=
     <a class="code" href="namespaceML_1_1TSNE.html#adcce7a8c238de2a7c2d7005369ca08b3">
      epssqd
     </a>
     ;
    </div>
    <div class="line">
     <a name="l00530">
     </a>
     <span class="lineno">
      530
     </span>
     }
    </div>
    <div class="line">
     <a name="l00531">
     </a>
     <span class="lineno">
      531
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#ad4056dfe6dce29dbdede1ba6b81d356a">
      dq
     </a>
     [max_depth - 1] +=
     <a class="code" href="namespaceML_1_1TSNE.html#adcce7a8c238de2a7c2d7005369ca08b3">
      epssqd
     </a>
     ;
    </div>
    <div class="line">
     <a name="l00532">
     </a>
     <span class="lineno">
      532
     </span>
    </div>
    <div class="line">
     <a name="l00533">
     </a>
     <span class="lineno">
      533
     </span>
     <span class="comment">
      // Add one so EPS_PLUS_1 can be compared
     </span>
    </div>
    <div class="line">
     <a name="l00534">
     </a>
     <span class="lineno">
      534
     </span>
     <span class="keywordflow">
      for
     </span>
     (
     <span class="keywordtype">
      int
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     = 0;
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     &lt; max_depth;
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     ++)
     <a class="code" href="namespaceML_1_1TSNE.html#ad4056dfe6dce29dbdede1ba6b81d356a">
      dq
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     ] += 1.0
     <a class="code" href="namespaceUMAPAlgo_1_1Optimize.html#ad1d8470650aa6ea82693fdf61479e708">
      f
     </a>
     ;
    </div>
    <div class="line">
     <a name="l00535">
     </a>
     <span class="lineno">
      535
     </span>
     }
    </div>
    <div class="line">
     <a name="l00536">
     </a>
     <span class="lineno">
      536
     </span>
    </div>
    <div class="line">
     <a name="l00537">
     </a>
     <span class="lineno">
      <a class="line" href="namespaceML_1_1TSNE.html#a98168b1bb13bc28991297eef583f11fe">
       537
      </a>
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a98168b1bb13bc28991297eef583f11fe">
      __syncthreads
     </a>
     ();
    </div>
    <div class="line">
     <a name="l00538">
     </a>
     <span class="lineno">
      538
     </span>
     <span class="comment">
      // figure out first thread in each warp (lane 0)
     </span>
    </div>
    <div class="line">
     <a name="l00539">
     </a>
     <span class="lineno">
      539
     </span>
     <span class="comment">
      // const int base = threadIdx.x / 32;
     </span>
    </div>
    <div class="line">
     <a name="l00540">
     </a>
     <span class="lineno">
      540
     </span>
     <span class="comment">
      // const int sbase = base * 32;
     </span>
    </div>
    <div class="line">
     <a name="l00541">
     </a>
     <span class="lineno">
      <a class="line" href="namespaceML_1_1TSNE.html#a78e9ba9338e47997108c6abbc303e04c">
       541
      </a>
     </span>
     <span class="keyword">
      const
     </span>
     <span class="keywordtype">
      int
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a78e9ba9338e47997108c6abbc303e04c">
      sbase
     </a>
     = (threadIdx.x / 32) * 32;
    </div>
    <div class="line">
     <a name="l00542">
     </a>
     <span class="lineno">
      <a class="line" href="namespaceML_1_1TSNE.html#a422f70195ab5e33488f766eee63eedea">
       542
      </a>
     </span>
     <span class="keyword">
      const
     </span>
     <span class="keywordtype">
      bool
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a422f70195ab5e33488f766eee63eedea">
      SBASE_EQ_THREAD
     </a>
     = (
     <a class="code" href="namespaceML_1_1TSNE.html#a78e9ba9338e47997108c6abbc303e04c">
      sbase
     </a>
     == threadIdx.x);
    </div>
    <div class="line">
     <a name="l00543">
     </a>
     <span class="lineno">
      543
     </span>
    </div>
    <div class="line">
     <a name="l00544">
     </a>
     <span class="lineno">
      <a class="line" href="namespaceML_1_1TSNE.html#a09fbcb069dfe61f730321699cfb9ebe7">
       544
      </a>
     </span>
     <span class="keyword">
      const
     </span>
     <span class="keywordtype">
      int
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a09fbcb069dfe61f730321699cfb9ebe7">
      diff
     </a>
     = threadIdx.x -
     <a class="code" href="namespaceML_1_1TSNE.html#a78e9ba9338e47997108c6abbc303e04c">
      sbase
     </a>
     ;
    </div>
    <div class="line">
     <a name="l00545">
     </a>
     <span class="lineno">
      545
     </span>
     <span class="comment">
      // make multiple copies to avoid index calculations later
     </span>
    </div>
    <div class="line">
     <a name="l00546">
     </a>
     <span class="lineno">
      546
     </span>
     <span class="comment">
      // Always true
     </span>
    </div>
    <div class="line">
     <a name="l00547">
     </a>
     <span class="lineno">
      547
     </span>
     <span class="comment">
      // if (diff &lt; 32)
     </span>
    </div>
    <div class="line">
     <a name="l00548">
     </a>
     <span class="lineno">
      548
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#ad4056dfe6dce29dbdede1ba6b81d356a">
      dq
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#a09fbcb069dfe61f730321699cfb9ebe7">
      diff
     </a>
     +
     <a class="code" href="namespaceML_1_1TSNE.html#a78e9ba9338e47997108c6abbc303e04c">
      sbase
     </a>
     ] =
     <a class="code" href="namespaceML_1_1TSNE.html#ad4056dfe6dce29dbdede1ba6b81d356a">
      dq
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#a09fbcb069dfe61f730321699cfb9ebe7">
      diff
     </a>
     ];
    </div>
    <div class="line">
     <a name="l00549">
     </a>
     <span class="lineno">
      549
     </span>
    </div>
    <div class="line">
     <a name="l00550">
     </a>
     <span class="lineno">
      550
     </span>
     <span class="comment">
      //__syncthreads();
     </span>
    </div>
    <div class="line">
     <a name="l00551">
     </a>
     <span class="lineno">
      <a class="line" href="namespaceML_1_1TSNE.html#a67d47a4abdc72a15bfb70ae338232d39">
       551
      </a>
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a67d47a4abdc72a15bfb70ae338232d39">
      __threadfence_block
     </a>
     ();
    </div>
    <div class="line">
     <a name="l00552">
     </a>
     <span class="lineno">
      552
     </span>
    </div>
    <div class="line">
     <a name="l00553">
     </a>
     <span class="lineno">
      553
     </span>
     <span class="comment">
      // iterate over all bodies assigned to thread
     </span>
    </div>
    <div class="line">
     <a name="l00554">
     </a>
     <span class="lineno">
      <a class="line" href="namespaceML_1_1TSNE.html#a34958bf847c3b0955734c6fc4de7679c">
       554
      </a>
     </span>
     <span class="keyword">
      const
     </span>
     <span class="keywordtype">
      int
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a34958bf847c3b0955734c6fc4de7679c">
      MAX_SIZE
     </a>
     =
     <a class="code" href="namespaceML_1_1TSNE.html#ad506ff98589c53814844d9f8663a127d">
      FOUR_NNODES
     </a>
     + 4;
    </div>
    <div class="line">
     <a name="l00555">
     </a>
     <span class="lineno">
      555
     </span>
    </div>
    <div class="line">
     <a name="l00556">
     </a>
     <span class="lineno">
      556
     </span>
     <span class="keywordflow">
      for
     </span>
     (
     <span class="keywordtype">
      int
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#afb851e919e0cd78a7c66faf65d407452">
      k
     </a>
     = threadIdx.x + blockIdx.x * blockDim.x;
     <a class="code" href="namespaceML_1_1TSNE.html#afb851e919e0cd78a7c66faf65d407452">
      k
     </a>
     &lt;
     <a class="code" href="namespaceML_1_1TSNE.html#a7086cebb5fe77bd10499d494328ba1c1">
      N
     </a>
     ;
    </div>
    <div class="line">
     <a name="l00557">
     </a>
     <span class="lineno">
      557
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#afb851e919e0cd78a7c66faf65d407452">
      k
     </a>
     += blockDim.x * gridDim.x) {
    </div>
    <div class="line">
     <a name="l00558">
     </a>
     <span class="lineno">
      558
     </span>
     <span class="keyword">
      const
     </span>
     <span class="keywordtype">
      int
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     =
     <a class="code" href="namespaceML_1_1TSNE.html#afaef49165bd5905004bb874599a36a30">
      sortd
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#afb851e919e0cd78a7c66faf65d407452">
      k
     </a>
     ];
     <span class="comment">
      // get permuted/sorted index
     </span>
    </div>
    <div class="line">
     <a name="l00559">
     </a>
     <span class="lineno">
      559
     </span>
     <span class="comment">
      // cache position info
     </span>
    </div>
    <div class="line">
     <a name="l00560">
     </a>
     <span class="lineno">
      560
     </span>
     <span class="keywordflow">
      if
     </span>
     (i &lt; 0 or i &gt;=
     <a class="code" href="namespaceML_1_1TSNE.html#a34958bf847c3b0955734c6fc4de7679c">
      MAX_SIZE
     </a>
     )
     <span class="keywordflow">
      continue
     </span>
     ;
    </div>
    <div class="line">
     <a name="l00561">
     </a>
     <span class="lineno">
      561
     </span>
    </div>
    <div class="line">
     <a name="l00562">
     </a>
     <span class="lineno">
      562
     </span>
     <span class="keyword">
      const
     </span>
     <span class="keywordtype">
      float
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a545006d7604664ff5e093702ff8fc196">
      px
     </a>
     =
     <a class="code" href="namespaceML_1_1TSNE.html#ad5c3a149f16c2850ff03ca0d4182b594">
      posxd
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     ];
    </div>
    <div class="line">
     <a name="l00563">
     </a>
     <span class="lineno">
      563
     </span>
     <span class="keyword">
      const
     </span>
     <span class="keywordtype">
      float
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a41a8f2080a734018c9bb091e0c551a10">
      py
     </a>
     =
     <a class="code" href="namespaceML_1_1TSNE.html#abe37b2672d24fb0a19db8757502e120f">
      posyd
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     ];
    </div>
    <div class="line">
     <a name="l00564">
     </a>
     <span class="lineno">
      564
     </span>
    </div>
    <div class="line">
     <a name="l00565">
     </a>
     <span class="lineno">
      565
     </span>
     <span class="keywordtype">
      float
     </span>
     vx = 0.0f;
    </div>
    <div class="line">
     <a name="l00566">
     </a>
     <span class="lineno">
      566
     </span>
     <span class="keywordtype">
      float
     </span>
     vy = 0.0f;
    </div>
    <div class="line">
     <a name="l00567">
     </a>
     <span class="lineno">
      567
     </span>
     <span class="keywordtype">
      float
     </span>
     normsum = 0.0f;
    </div>
    <div class="line">
     <a name="l00568">
     </a>
     <span class="lineno">
      568
     </span>
    </div>
    <div class="line">
     <a name="l00569">
     </a>
     <span class="lineno">
      569
     </span>
     <span class="comment">
      // initialize iteration stack, i.e., push root node onto stack
     </span>
    </div>
    <div class="line">
     <a name="l00570">
     </a>
     <span class="lineno">
      570
     </span>
     <span class="keywordtype">
      int
     </span>
     depth =
     <a class="code" href="namespaceML_1_1TSNE.html#a78e9ba9338e47997108c6abbc303e04c">
      sbase
     </a>
     ;
    </div>
    <div class="line">
     <a name="l00571">
     </a>
     <span class="lineno">
      571
     </span>
    </div>
    <div class="line">
     <a name="l00572">
     </a>
     <span class="lineno">
      572
     </span>
     <span class="keywordflow">
      if
     </span>
     (
     <a class="code" href="namespaceML_1_1TSNE.html#a422f70195ab5e33488f766eee63eedea">
      SBASE_EQ_THREAD
     </a>
     ==
     <span class="keyword">
      true
     </span>
     ) {
    </div>
    <div class="line">
     <a name="l00573">
     </a>
     <span class="lineno">
      573
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#abd3dad89a4d38a71f52c1673e31f8723">
      pos
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#a78e9ba9338e47997108c6abbc303e04c">
      sbase
     </a>
     ] = 0;
    </div>
    <div class="line">
     <a name="l00574">
     </a>
     <span class="lineno">
      574
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#af16f443a812df8b6cabb5dd30058d377">
      node
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#a78e9ba9338e47997108c6abbc303e04c">
      sbase
     </a>
     ] =
     <a class="code" href="namespaceML_1_1TSNE.html#ad506ff98589c53814844d9f8663a127d">
      FOUR_NNODES
     </a>
     ;
    </div>
    <div class="line">
     <a name="l00575">
     </a>
     <span class="lineno">
      575
     </span>
     }
    </div>
    <div class="line">
     <a name="l00576">
     </a>
     <span class="lineno">
      576
     </span>
    </div>
    <div class="line">
     <a name="l00577">
     </a>
     <span class="lineno">
      577
     </span>
     <span class="keywordflow">
      do
     </span>
     {
    </div>
    <div class="line">
     <a name="l00578">
     </a>
     <span class="lineno">
      578
     </span>
     <span class="comment">
      // stack is not empty
     </span>
    </div>
    <div class="line">
     <a name="l00579">
     </a>
     <span class="lineno">
      579
     </span>
     <span class="keywordtype">
      int
     </span>
     pd =
     <a class="code" href="namespaceML_1_1TSNE.html#abd3dad89a4d38a71f52c1673e31f8723">
      pos
     </a>
     [depth];
    </div>
    <div class="line">
     <a name="l00580">
     </a>
     <span class="lineno">
      580
     </span>
     <span class="keywordtype">
      int
     </span>
     nd =
     <a class="code" href="namespaceML_1_1TSNE.html#af16f443a812df8b6cabb5dd30058d377">
      node
     </a>
     [depth];
    </div>
    <div class="line">
     <a name="l00581">
     </a>
     <span class="lineno">
      581
     </span>
    </div>
    <div class="line">
     <a name="l00582">
     </a>
     <span class="lineno">
      582
     </span>
     <span class="keywordflow">
      while
     </span>
     (pd &lt; 4) {
    </div>
    <div class="line">
     <a name="l00583">
     </a>
     <span class="lineno">
      583
     </span>
     <span class="keyword">
      const
     </span>
     <span class="keywordtype">
      int
     </span>
     index = nd + pd++;
    </div>
    <div class="line">
     <a name="l00584">
     </a>
     <span class="lineno">
      584
     </span>
     <span class="keywordflow">
      if
     </span>
     (index &lt; 0 or index &gt;=
     <a class="code" href="namespaceML_1_1TSNE.html#a34958bf847c3b0955734c6fc4de7679c">
      MAX_SIZE
     </a>
     )
     <span class="keywordflow">
      break
     </span>
     ;
    </div>
    <div class="line">
     <a name="l00585">
     </a>
     <span class="lineno">
      585
     </span>
    </div>
    <div class="line">
     <a name="l00586">
     </a>
     <span class="lineno">
      586
     </span>
     <span class="keyword">
      const
     </span>
     <span class="keywordtype">
      int
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a1cd86a623f64db84ca537da23b68223c">
      n
     </a>
     =
     <a class="code" href="namespaceML_1_1TSNE.html#ad7b00d371d403bb26f2bb196659e9c56">
      childd
     </a>
     [index];
     <span class="comment">
      // load child pointer
     </span>
    </div>
    <div class="line">
     <a name="l00587">
     </a>
     <span class="lineno">
      587
     </span>
    </div>
    <div class="line">
     <a name="l00588">
     </a>
     <span class="lineno">
      588
     </span>
     <span class="comment">
      // Non child
     </span>
    </div>
    <div class="line">
     <a name="l00589">
     </a>
     <span class="lineno">
      589
     </span>
     <span class="keywordflow">
      if
     </span>
     (n &lt; 0 or n &gt;
     <a class="code" href="namespaceML_1_1TSNE.html#a1d775ae44089726fc5f8d66f78528ada">
      NNODES
     </a>
     )
     <span class="keywordflow">
      break
     </span>
     ;
    </div>
    <div class="line">
     <a name="l00590">
     </a>
     <span class="lineno">
      590
     </span>
    </div>
    <div class="line">
     <a name="l00591">
     </a>
     <span class="lineno">
      591
     </span>
     <span class="keyword">
      const
     </span>
     <span class="keywordtype">
      float
     </span>
     dx =
     <a class="code" href="namespaceML_1_1TSNE.html#a545006d7604664ff5e093702ff8fc196">
      px
     </a>
     -
     <a class="code" href="namespaceML_1_1TSNE.html#ad5c3a149f16c2850ff03ca0d4182b594">
      posxd
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#a1cd86a623f64db84ca537da23b68223c">
      n
     </a>
     ];
    </div>
    <div class="line">
     <a name="l00592">
     </a>
     <span class="lineno">
      592
     </span>
     <span class="keyword">
      const
     </span>
     <span class="keywordtype">
      float
     </span>
     dy =
     <a class="code" href="namespaceML_1_1TSNE.html#a41a8f2080a734018c9bb091e0c551a10">
      py
     </a>
     -
     <a class="code" href="namespaceML_1_1TSNE.html#abe37b2672d24fb0a19db8757502e120f">
      posyd
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#a1cd86a623f64db84ca537da23b68223c">
      n
     </a>
     ];
    </div>
    <div class="line">
     <a name="l00593">
     </a>
     <span class="lineno">
      593
     </span>
     <span class="keyword">
      const
     </span>
     <span class="keywordtype">
      float
     </span>
     dxy1 = dx * dx + dy * dy + EPS_PLUS_1;
    </div>
    <div class="line">
     <a name="l00594">
     </a>
     <span class="lineno">
      594
     </span>
    </div>
    <div class="line">
     <a name="l00595">
     </a>
     <span class="lineno">
      595
     </span>
     <span class="keywordflow">
      if
     </span>
     ((
     <a class="code" href="namespaceML_1_1TSNE.html#a1cd86a623f64db84ca537da23b68223c">
      n
     </a>
     &lt;
     <a class="code" href="namespaceML_1_1TSNE.html#a7086cebb5fe77bd10499d494328ba1c1">
      N
     </a>
     ) or __all_sync(__activemask(), dxy1 &gt;=
     <a class="code" href="namespaceML_1_1TSNE.html#ad4056dfe6dce29dbdede1ba6b81d356a">
      dq
     </a>
     [depth])) {
    </div>
    <div class="line">
     <a name="l00596">
     </a>
     <span class="lineno">
      596
     </span>
     <span class="keyword">
      const
     </span>
     <span class="keywordtype">
      float
     </span>
     tdist_2 = __fdividef(
     <a class="code" href="namespaceML_1_1TSNE.html#aaeba4f3e347780328e08a424e719255e">
      massd
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#a1cd86a623f64db84ca537da23b68223c">
      n
     </a>
     ], dxy1 * dxy1);
    </div>
    <div class="line">
     <a name="l00597">
     </a>
     <span class="lineno">
      597
     </span>
     normsum += tdist_2 * dxy1;
    </div>
    <div class="line">
     <a name="l00598">
     </a>
     <span class="lineno">
      598
     </span>
     vx += dx * tdist_2;
    </div>
    <div class="line">
     <a name="l00599">
     </a>
     <span class="lineno">
      599
     </span>
     vy += dy * tdist_2;
    </div>
    <div class="line">
     <a name="l00600">
     </a>
     <span class="lineno">
      600
     </span>
     }
     <span class="keywordflow">
      else
     </span>
     {
    </div>
    <div class="line">
     <a name="l00601">
     </a>
     <span class="lineno">
      601
     </span>
     <span class="comment">
      // push cell onto stack
     </span>
    </div>
    <div class="line">
     <a name="l00602">
     </a>
     <span class="lineno">
      602
     </span>
     <span class="keywordflow">
      if
     </span>
     (
     <a class="code" href="namespaceML_1_1TSNE.html#a422f70195ab5e33488f766eee63eedea">
      SBASE_EQ_THREAD
     </a>
     ==
     <span class="keyword">
      true
     </span>
     ) {
    </div>
    <div class="line">
     <a name="l00603">
     </a>
     <span class="lineno">
      603
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#abd3dad89a4d38a71f52c1673e31f8723">
      pos
     </a>
     [depth] = pd;
    </div>
    <div class="line">
     <a name="l00604">
     </a>
     <span class="lineno">
      604
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#af16f443a812df8b6cabb5dd30058d377">
      node
     </a>
     [depth] = nd;
    </div>
    <div class="line">
     <a name="l00605">
     </a>
     <span class="lineno">
      605
     </span>
     }
    </div>
    <div class="line">
     <a name="l00606">
     </a>
     <span class="lineno">
      606
     </span>
     depth++;
    </div>
    <div class="line">
     <a name="l00607">
     </a>
     <span class="lineno">
      607
     </span>
     pd = 0;
    </div>
    <div class="line">
     <a name="l00608">
     </a>
     <span class="lineno">
      608
     </span>
     nd =
     <a class="code" href="namespaceML_1_1TSNE.html#a1cd86a623f64db84ca537da23b68223c">
      n
     </a>
     * 4;
    </div>
    <div class="line">
     <a name="l00609">
     </a>
     <span class="lineno">
      609
     </span>
     }
    </div>
    <div class="line">
     <a name="l00610">
     </a>
     <span class="lineno">
      610
     </span>
     }
    </div>
    <div class="line">
     <a name="l00611">
     </a>
     <span class="lineno">
      611
     </span>
    </div>
    <div class="line">
     <a name="l00612">
     </a>
     <span class="lineno">
      612
     </span>
     }
     <span class="keywordflow">
      while
     </span>
     (--depth &gt;=
     <a class="code" href="namespaceML_1_1TSNE.html#a78e9ba9338e47997108c6abbc303e04c">
      sbase
     </a>
     );
     <span class="comment">
      // done with this level
     </span>
    </div>
    <div class="line">
     <a name="l00613">
     </a>
     <span class="lineno">
      613
     </span>
    </div>
    <div class="line">
     <a name="l00614">
     </a>
     <span class="lineno">
      614
     </span>
     <span class="comment">
      // update velocity
     </span>
    </div>
    <div class="line">
     <a name="l00615">
     </a>
     <span class="lineno">
      615
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a5fb0936df7675d60b572cc1b9f6d34ec">
      velxd
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     ] += vx;
    </div>
    <div class="line">
     <a name="l00616">
     </a>
     <span class="lineno">
      616
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a35b748d14131f08262d43bd8b09f02e1">
      velyd
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     ] += vy;
    </div>
    <div class="line">
     <a name="l00617">
     </a>
     <span class="lineno">
      617
     </span>
     atomicAdd(
     <a class="code" href="namespaceML_1_1TSNE.html#ad530b26f03ad51d5eb7fce1926dd2360">
      Z_norm
     </a>
     , normsum);
    </div>
    <div class="line">
     <a name="l00618">
     </a>
     <span class="lineno">
      618
     </span>
     }
    </div>
    <div class="line">
     <a name="l00619">
     </a>
     <span class="lineno">
      619
     </span>
     }
    </div>
    <div class="line">
     <a name="l00620">
     </a>
     <span class="lineno">
      620
     </span>
    </div>
    <div class="line">
     <a name="l00624">
     </a>
     <span class="lineno">
      <a class="line" href="namespaceML_1_1TSNE.html#a256aedf0a028da5f7c5e13712a8223d1">
       624
      </a>
     </span>
     __global__
     <span class="keywordtype">
      void
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a256aedf0a028da5f7c5e13712a8223d1">
      get_norm
     </a>
     (
     <span class="keyword">
      const
     </span>
     <span class="keywordtype">
      float
     </span>
     *
     <a class="code" href="bh__kernels_8h.html#a080abdcb9c02438f1cd2bb707af25af8">
      restrict
     </a>
     <a class="code" href="namespaceML_1_1TSNE.html#afc75b29a7b97e657cdee10c37abc69b8">
      Y1
     </a>
     ,
     <span class="keyword">
      const
     </span>
     <span class="keywordtype">
      float
     </span>
     *
     <a class="code" href="bh__kernels_8h.html#a080abdcb9c02438f1cd2bb707af25af8">
      restrict
     </a>
     <a class="code" href="namespaceML_1_1TSNE.html#af0d6cf0fc091efc0c306c7024ba8a00c">
      Y2
     </a>
     ,
    </div>
    <div class="line">
     <a name="l00625">
     </a>
     <span class="lineno">
      625
     </span>
     <span class="keywordtype">
      float
     </span>
     *
     <a class="code" href="bh__kernels_8h.html#a080abdcb9c02438f1cd2bb707af25af8">
      restrict
     </a>
     norm,
     <span class="keywordtype">
      float
     </span>
     *
     <a class="code" href="bh__kernels_8h.html#a080abdcb9c02438f1cd2bb707af25af8">
      restrict
     </a>
     norm_add1,
    </div>
    <div class="line">
     <a name="l00626">
     </a>
     <span class="lineno">
      626
     </span>
     <span class="keyword">
      const
     </span>
     <span class="keywordtype">
      int
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a7086cebb5fe77bd10499d494328ba1c1">
      N
     </a>
     ) {
    </div>
    <div class="line">
     <a name="l00627">
     </a>
     <span class="lineno">
      627
     </span>
     <span class="keyword">
      const
     </span>
     <span class="keywordtype">
      int
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     = (blockIdx.x * blockDim.x) + threadIdx.x;
    </div>
    <div class="line">
     <a name="l00628">
     </a>
     <span class="lineno">
      628
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a5e6127c8e89f25aba2fc545044afcb4a">
      if
     </a>
     (
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     &gt;=
     <a class="code" href="namespaceML_1_1TSNE.html#a7086cebb5fe77bd10499d494328ba1c1">
      N
     </a>
     )
     <span class="keywordflow">
      return
     </span>
     ;
    </div>
    <div class="line">
     <a name="l00629">
     </a>
     <span class="lineno">
      629
     </span>
     norm[
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     ] =
     <a class="code" href="namespaceML_1_1TSNE.html#afc75b29a7b97e657cdee10c37abc69b8">
      Y1
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     ] *
     <a class="code" href="namespaceML_1_1TSNE.html#afc75b29a7b97e657cdee10c37abc69b8">
      Y1
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     ] +
     <a class="code" href="namespaceML_1_1TSNE.html#af0d6cf0fc091efc0c306c7024ba8a00c">
      Y2
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     ] *
     <a class="code" href="namespaceML_1_1TSNE.html#af0d6cf0fc091efc0c306c7024ba8a00c">
      Y2
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     ];
    </div>
    <div class="line">
     <a name="l00630">
     </a>
     <span class="lineno">
      630
     </span>
     norm_add1[
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     ] = norm[
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     ] + 1.0f;
    </div>
    <div class="line">
     <a name="l00631">
     </a>
     <span class="lineno">
      631
     </span>
     }
    </div>
    <div class="line">
     <a name="l00632">
     </a>
     <span class="lineno">
      632
     </span>
    </div>
    <div class="line">
     <a name="l00636">
     </a>
     <span class="lineno">
      <a class="line" href="namespaceML_1_1TSNE.html#a4056778964b393afbe6720d23a367e42">
       636
      </a>
     </span>
     __global__
     <span class="keywordtype">
      void
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a4056778964b393afbe6720d23a367e42">
      attractive_kernel_bh
     </a>
     (
    </div>
    <div class="line">
     <a name="l00637">
     </a>
     <span class="lineno">
      637
     </span>
     <span class="keyword">
      const
     </span>
     <span class="keywordtype">
      float
     </span>
     *
     <a class="code" href="bh__kernels_8h.html#a080abdcb9c02438f1cd2bb707af25af8">
      restrict
     </a>
     VAL,
     <span class="keyword">
      const
     </span>
     <span class="keywordtype">
      int
     </span>
     *
     <a class="code" href="bh__kernels_8h.html#a080abdcb9c02438f1cd2bb707af25af8">
      restrict
     </a>
     COL,
     <span class="keyword">
      const
     </span>
     <span class="keywordtype">
      int
     </span>
     *
     <a class="code" href="bh__kernels_8h.html#a080abdcb9c02438f1cd2bb707af25af8">
      restrict
     </a>
     ROW,
    </div>
    <div class="line">
     <a name="l00638">
     </a>
     <span class="lineno">
      638
     </span>
     <span class="keyword">
      const
     </span>
     <span class="keywordtype">
      float
     </span>
     *
     <a class="code" href="bh__kernels_8h.html#a080abdcb9c02438f1cd2bb707af25af8">
      restrict
     </a>
     <a class="code" href="namespaceML_1_1TSNE.html#afc75b29a7b97e657cdee10c37abc69b8">
      Y1
     </a>
     ,
     <span class="keyword">
      const
     </span>
     <span class="keywordtype">
      float
     </span>
     *
     <a class="code" href="bh__kernels_8h.html#a080abdcb9c02438f1cd2bb707af25af8">
      restrict
     </a>
     <a class="code" href="namespaceML_1_1TSNE.html#af0d6cf0fc091efc0c306c7024ba8a00c">
      Y2
     </a>
     ,
    </div>
    <div class="line">
     <a name="l00639">
     </a>
     <span class="lineno">
      639
     </span>
     <span class="keyword">
      const
     </span>
     <span class="keywordtype">
      float
     </span>
     *
     <a class="code" href="bh__kernels_8h.html#a080abdcb9c02438f1cd2bb707af25af8">
      restrict
     </a>
     norm,
     <span class="keyword">
      const
     </span>
     <span class="keywordtype">
      float
     </span>
     *
     <a class="code" href="bh__kernels_8h.html#a080abdcb9c02438f1cd2bb707af25af8">
      restrict
     </a>
     norm_add1,
    </div>
    <div class="line">
     <a name="l00640">
     </a>
     <span class="lineno">
      640
     </span>
     <span class="keywordtype">
      float
     </span>
     *
     <a class="code" href="bh__kernels_8h.html#a080abdcb9c02438f1cd2bb707af25af8">
      restrict
     </a>
     <a class="code" href="namespaceML_1_1TSNE.html#a6347a6e1f57c82d250448f18dde22537">
      attract1
     </a>
     ,
     <span class="keywordtype">
      float
     </span>
     *
     <a class="code" href="bh__kernels_8h.html#a080abdcb9c02438f1cd2bb707af25af8">
      restrict
     </a>
     <a class="code" href="namespaceML_1_1TSNE.html#ad1d12124fbd3b44dee622f403fda7276">
      attract2
     </a>
     ,
     <span class="keyword">
      const
     </span>
     <span class="keywordtype">
      int
     </span>
     NNZ) {
    </div>
    <div class="line">
     <a name="l00641">
     </a>
     <span class="lineno">
      641
     </span>
     <span class="keyword">
      const
     </span>
     <span class="keywordtype">
      int
     </span>
     index = (blockIdx.x * blockDim.x) + threadIdx.x;
    </div>
    <div class="line">
     <a name="l00642">
     </a>
     <span class="lineno">
      642
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a5e6127c8e89f25aba2fc545044afcb4a">
      if
     </a>
     (index &gt;= NNZ)
     <span class="keywordflow">
      return
     </span>
     ;
    </div>
    <div class="line">
     <a name="l00643">
     </a>
     <span class="lineno">
      643
     </span>
     <span class="keyword">
      const
     </span>
     <span class="keywordtype">
      int
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     = ROW[index];
    </div>
    <div class="line">
     <a name="l00644">
     </a>
     <span class="lineno">
      644
     </span>
     <span class="keyword">
      const
     </span>
     <span class="keywordtype">
      int
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#aa7af7a282a727812d02249e36b56d7cb">
      j
     </a>
     = COL[index];
    </div>
    <div class="line">
     <a name="l00645">
     </a>
     <span class="lineno">
      645
     </span>
    </div>
    <div class="line">
     <a name="l00646">
     </a>
     <span class="lineno">
      646
     </span>
     <span class="comment">
      // TODO: Calculate Kullback-Leibler divergence
     </span>
    </div>
    <div class="line">
     <a name="l00647">
     </a>
     <span class="lineno">
      647
     </span>
     <span class="comment">
      // TODO: Convert attractive forces to CSR format
     </span>
    </div>
    <div class="line">
     <a name="l00648">
     </a>
     <span class="lineno">
      648
     </span>
     <span class="keyword">
      const
     </span>
     <span class="keywordtype">
      float
     </span>
     PQ = __fdividef(
    </div>
    <div class="line">
     <a name="l00649">
     </a>
     <span class="lineno">
      649
     </span>
     VAL[index],
    </div>
    <div class="line">
     <a name="l00650">
     </a>
     <span class="lineno">
      650
     </span>
     norm_add1[
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     ] + norm[
     <a class="code" href="namespaceML_1_1TSNE.html#aa7af7a282a727812d02249e36b56d7cb">
      j
     </a>
     ] - 2.0
     <a class="code" href="namespaceUMAPAlgo_1_1Optimize.html#ad1d8470650aa6ea82693fdf61479e708">
      f
     </a>
     * (
     <a class="code" href="namespaceML_1_1TSNE.html#afc75b29a7b97e657cdee10c37abc69b8">
      Y1
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     ] *
     <a class="code" href="namespaceML_1_1TSNE.html#afc75b29a7b97e657cdee10c37abc69b8">
      Y1
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#aa7af7a282a727812d02249e36b56d7cb">
      j
     </a>
     ] +
     <a class="code" href="namespaceML_1_1TSNE.html#af0d6cf0fc091efc0c306c7024ba8a00c">
      Y2
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     ] *
     <a class="code" href="namespaceML_1_1TSNE.html#af0d6cf0fc091efc0c306c7024ba8a00c">
      Y2
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#aa7af7a282a727812d02249e36b56d7cb">
      j
     </a>
     ]));
     <span class="comment">
      // P*Q
     </span>
    </div>
    <div class="line">
     <a name="l00651">
     </a>
     <span class="lineno">
      651
     </span>
    </div>
    <div class="line">
     <a name="l00652">
     </a>
     <span class="lineno">
      652
     </span>
     <span class="comment">
      // Apply forces
     </span>
    </div>
    <div class="line">
     <a name="l00653">
     </a>
     <span class="lineno">
      653
     </span>
     atomicAdd(&amp;
     <a class="code" href="namespaceML_1_1TSNE.html#a6347a6e1f57c82d250448f18dde22537">
      attract1
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     ], PQ * (
     <a class="code" href="namespaceML_1_1TSNE.html#afc75b29a7b97e657cdee10c37abc69b8">
      Y1
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     ] -
     <a class="code" href="namespaceML_1_1TSNE.html#afc75b29a7b97e657cdee10c37abc69b8">
      Y1
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#aa7af7a282a727812d02249e36b56d7cb">
      j
     </a>
     ]));
    </div>
    <div class="line">
     <a name="l00654">
     </a>
     <span class="lineno">
      654
     </span>
     atomicAdd(&amp;
     <a class="code" href="namespaceML_1_1TSNE.html#ad1d12124fbd3b44dee622f403fda7276">
      attract2
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     ], PQ * (
     <a class="code" href="namespaceML_1_1TSNE.html#af0d6cf0fc091efc0c306c7024ba8a00c">
      Y2
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     ] -
     <a class="code" href="namespaceML_1_1TSNE.html#af0d6cf0fc091efc0c306c7024ba8a00c">
      Y2
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#aa7af7a282a727812d02249e36b56d7cb">
      j
     </a>
     ]));
    </div>
    <div class="line">
     <a name="l00655">
     </a>
     <span class="lineno">
      655
     </span>
     }
    </div>
    <div class="line">
     <a name="l00656">
     </a>
     <span class="lineno">
      656
     </span>
    </div>
    <div class="line">
     <a name="l00660">
     </a>
     <span class="lineno">
      <a class="line" href="namespaceML_1_1TSNE.html#a2e8bdc8bedf6a9d972290824802c9a05">
       660
      </a>
     </span>
     __global__
     <a class="code" href="namespaceML_1_1TSNE.html#a3fd0469bdd73eaf1f777c1ff1aee929b">
      __launch_bounds__
     </a>
     (
     <a class="code" href="bh__kernels_8h.html#a3c4ca86a6531f092f92f04ae336be835">
      THREADS6
     </a>
     ,
     <a class="code" href="bh__kernels_8h.html#a09496545d22a86a5d0293a80bb1920f7">
      FACTOR6
     </a>
     )
     <span class="keywordtype">
      void
     </span>
     IntegrationKernel(
    </div>
    <div class="line">
     <a name="l00661">
     </a>
     <span class="lineno">
      <a class="line" href="namespaceML_1_1TSNE.html#afbdcdf332ab9ffef1adaf68fa5feb3da">
       661
      </a>
     </span>
     <span class="keyword">
      const
     </span>
     <span class="keywordtype">
      float
     </span>
     eta,
     <span class="keyword">
      const
     </span>
     <span class="keywordtype">
      float
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#afbdcdf332ab9ffef1adaf68fa5feb3da">
      momentum
     </a>
     ,
     <span class="keyword">
      const
     </span>
     <span class="keywordtype">
      float
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#aebbccd9fcfe93dddcc2d01fdee16d927">
      exaggeration
     </a>
     ,
    </div>
    <div class="line">
     <a name="l00662">
     </a>
     <span class="lineno">
      <a class="line" href="namespaceML_1_1TSNE.html#af0d6cf0fc091efc0c306c7024ba8a00c">
       662
      </a>
     </span>
     <span class="keywordtype">
      float
     </span>
     *
     <a class="code" href="bh__kernels_8h.html#a080abdcb9c02438f1cd2bb707af25af8">
      restrict
     </a>
     <a class="code" href="namespaceML_1_1TSNE.html#afc75b29a7b97e657cdee10c37abc69b8">
      Y1
     </a>
     ,
     <span class="keywordtype">
      float
     </span>
     *
     <a class="code" href="bh__kernels_8h.html#a080abdcb9c02438f1cd2bb707af25af8">
      restrict
     </a>
     <a class="code" href="namespaceML_1_1TSNE.html#af0d6cf0fc091efc0c306c7024ba8a00c">
      Y2
     </a>
     ,
     <span class="keyword">
      const
     </span>
     <span class="keywordtype">
      float
     </span>
     *
     <a class="code" href="bh__kernels_8h.html#a080abdcb9c02438f1cd2bb707af25af8">
      restrict
     </a>
     <a class="code" href="namespaceML_1_1TSNE.html#a6347a6e1f57c82d250448f18dde22537">
      attract1
     </a>
     ,
    </div>
    <div class="line">
     <a name="l00663">
     </a>
     <span class="lineno">
      <a class="line" href="namespaceML_1_1TSNE.html#aa248106f4e1949a1c8e1c0f1d4793a26">
       663
      </a>
     </span>
     <span class="keyword">
      const
     </span>
     <span class="keywordtype">
      float
     </span>
     *
     <a class="code" href="bh__kernels_8h.html#a080abdcb9c02438f1cd2bb707af25af8">
      restrict
     </a>
     <a class="code" href="namespaceML_1_1TSNE.html#ad1d12124fbd3b44dee622f403fda7276">
      attract2
     </a>
     ,
     <span class="keyword">
      const
     </span>
     <span class="keywordtype">
      float
     </span>
     *
     <a class="code" href="bh__kernels_8h.html#a080abdcb9c02438f1cd2bb707af25af8">
      restrict
     </a>
     <a class="code" href="namespaceML_1_1TSNE.html#aa248106f4e1949a1c8e1c0f1d4793a26">
      repel1
     </a>
     ,
    </div>
    <div class="line">
     <a name="l00664">
     </a>
     <span class="lineno">
      <a class="line" href="namespaceML_1_1TSNE.html#a411b64333babbe9430eaf09eb2cad063">
       664
      </a>
     </span>
     <span class="keyword">
      const
     </span>
     <span class="keywordtype">
      float
     </span>
     *
     <a class="code" href="bh__kernels_8h.html#a080abdcb9c02438f1cd2bb707af25af8">
      restrict
     </a>
     <a class="code" href="namespaceML_1_1TSNE.html#a411b64333babbe9430eaf09eb2cad063">
      repel2
     </a>
     ,
     <span class="keywordtype">
      float
     </span>
     *
     <a class="code" href="bh__kernels_8h.html#a080abdcb9c02438f1cd2bb707af25af8">
      restrict
     </a>
     <a class="code" href="namespaceML_1_1TSNE.html#ac11723a24afb8d48fdcabfc76eef08e4">
      gains1
     </a>
     ,
     <span class="keywordtype">
      float
     </span>
     *
     <a class="code" href="bh__kernels_8h.html#a080abdcb9c02438f1cd2bb707af25af8">
      restrict
     </a>
     <a class="code" href="namespaceML_1_1TSNE.html#a85570a40891c7c9271f1f86123f5e52d">
      gains2
     </a>
     ,
    </div>
    <div class="line">
     <a name="l00665">
     </a>
     <span class="lineno">
      <a class="line" href="namespaceML_1_1TSNE.html#ac755b1db80982be920c4c7bb36f087e8">
       665
      </a>
     </span>
     <span class="keywordtype">
      float
     </span>
     *
     <a class="code" href="bh__kernels_8h.html#a080abdcb9c02438f1cd2bb707af25af8">
      restrict
     </a>
     <a class="code" href="namespaceML_1_1TSNE.html#a532b17ce36ff7c6c05a976cc02b2b01f">
      old_forces1
     </a>
     ,
     <span class="keywordtype">
      float
     </span>
     *
     <a class="code" href="bh__kernels_8h.html#a080abdcb9c02438f1cd2bb707af25af8">
      restrict
     </a>
     <a class="code" href="namespaceML_1_1TSNE.html#ac755b1db80982be920c4c7bb36f087e8">
      old_forces2
     </a>
     ,
    </div>
    <div class="line">
     <a name="l00666">
     </a>
     <span class="lineno">
      <a class="line" href="namespaceML_1_1TSNE.html#a5d89f904dbf62a36b80e4726e11d1a55">
       666
      </a>
     </span>
     <span class="keyword">
      const
     </span>
     <span class="keywordtype">
      float
     </span>
     *
     <a class="code" href="bh__kernels_8h.html#a080abdcb9c02438f1cd2bb707af25af8">
      restrict
     </a>
     <a class="code" href="namespaceML_1_1TSNE.html#a5d89f904dbf62a36b80e4726e11d1a55">
      Z
     </a>
     ,
     <span class="keyword">
      const
     </span>
     <span class="keywordtype">
      int
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a7086cebb5fe77bd10499d494328ba1c1">
      N
     </a>
     ) {
    </div>
    <div class="line">
     <a name="l00667">
     </a>
     <span class="lineno">
      667
     </span>
     <span class="keywordtype">
      float
     </span>
     ux, uy, gx, gy;
    </div>
    <div class="line">
     <a name="l00668">
     </a>
     <span class="lineno">
      668
     </span>
    </div>
    <div class="line">
     <a name="l00669">
     </a>
     <span class="lineno">
      669
     </span>
     <span class="comment">
      // iterate over all bodies assigned to thread
     </span>
    </div>
    <div class="line">
     <a name="l00670">
     </a>
     <span class="lineno">
      670
     </span>
     <span class="keyword">
      const
     </span>
     <span class="keywordtype">
      int
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#acfb1787f01f8a74fab3ad6d557ec9ffe">
      inc
     </a>
     = blockDim.x * gridDim.x;
    </div>
    <div class="line">
     <a name="l00671">
     </a>
     <span class="lineno">
      671
     </span>
     <span class="keyword">
      const
     </span>
     <span class="keywordtype">
      float
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#ad530b26f03ad51d5eb7fce1926dd2360">
      Z_norm
     </a>
     =
     <a class="code" href="namespaceML_1_1TSNE.html#a5d89f904dbf62a36b80e4726e11d1a55">
      Z
     </a>
     [0];
    </div>
    <div class="line">
     <a name="l00672">
     </a>
     <span class="lineno">
      672
     </span>
    </div>
    <div class="line">
     <a name="l00673">
     </a>
     <span class="lineno">
      673
     </span>
     <span class="keywordflow">
      for
     </span>
     (
     <span class="keywordtype">
      int
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     = threadIdx.x + blockIdx.x * blockDim.x;
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     &lt;
     <a class="code" href="namespaceML_1_1TSNE.html#a7086cebb5fe77bd10499d494328ba1c1">
      N
     </a>
     ;
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     +=
     <a class="code" href="namespaceML_1_1TSNE.html#acfb1787f01f8a74fab3ad6d557ec9ffe">
      inc
     </a>
     ) {
    </div>
    <div class="line">
     <a name="l00674">
     </a>
     <span class="lineno">
      674
     </span>
     <span class="keyword">
      const
     </span>
     <span class="keywordtype">
      float
     </span>
     dx =
     <a class="code" href="namespaceML_1_1TSNE.html#a6347a6e1f57c82d250448f18dde22537">
      attract1
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     ] -
     <a class="code" href="namespaceML_1_1TSNE.html#ad530b26f03ad51d5eb7fce1926dd2360">
      Z_norm
     </a>
     *
     <a class="code" href="namespaceML_1_1TSNE.html#aa248106f4e1949a1c8e1c0f1d4793a26">
      repel1
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     ];
    </div>
    <div class="line">
     <a name="l00675">
     </a>
     <span class="lineno">
      675
     </span>
     <span class="keyword">
      const
     </span>
     <span class="keywordtype">
      float
     </span>
     dy =
     <a class="code" href="namespaceML_1_1TSNE.html#ad1d12124fbd3b44dee622f403fda7276">
      attract2
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     ] -
     <a class="code" href="namespaceML_1_1TSNE.html#ad530b26f03ad51d5eb7fce1926dd2360">
      Z_norm
     </a>
     *
     <a class="code" href="namespaceML_1_1TSNE.html#a411b64333babbe9430eaf09eb2cad063">
      repel2
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     ];
    </div>
    <div class="line">
     <a name="l00676">
     </a>
     <span class="lineno">
      676
     </span>
    </div>
    <div class="line">
     <a name="l00677">
     </a>
     <span class="lineno">
      677
     </span>
     <span class="keywordflow">
      if
     </span>
     (signbit(dx) != signbit(ux =
     <a class="code" href="namespaceML_1_1TSNE.html#a532b17ce36ff7c6c05a976cc02b2b01f">
      old_forces1
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     ]))
    </div>
    <div class="line">
     <a name="l00678">
     </a>
     <span class="lineno">
      678
     </span>
     gx =
     <a class="code" href="namespaceML_1_1TSNE.html#ac11723a24afb8d48fdcabfc76eef08e4">
      gains1
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     ] + 0.2f;
    </div>
    <div class="line">
     <a name="l00679">
     </a>
     <span class="lineno">
      679
     </span>
     <span class="keywordflow">
      else
     </span>
    </div>
    <div class="line">
     <a name="l00680">
     </a>
     <span class="lineno">
      680
     </span>
     gx =
     <a class="code" href="namespaceML_1_1TSNE.html#ac11723a24afb8d48fdcabfc76eef08e4">
      gains1
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     ] * 0.8f;
    </div>
    <div class="line">
     <a name="l00681">
     </a>
     <span class="lineno">
      681
     </span>
     <span class="keywordflow">
      if
     </span>
     (gx &lt; 0.01
     <a class="code" href="namespaceUMAPAlgo_1_1Optimize.html#ad1d8470650aa6ea82693fdf61479e708">
      f
     </a>
     ) gx = 0.01f;
    </div>
    <div class="line">
     <a name="l00682">
     </a>
     <span class="lineno">
      682
     </span>
    </div>
    <div class="line">
     <a name="l00683">
     </a>
     <span class="lineno">
      683
     </span>
     <span class="keywordflow">
      if
     </span>
     (signbit(dy) != signbit(uy =
     <a class="code" href="namespaceML_1_1TSNE.html#ac755b1db80982be920c4c7bb36f087e8">
      old_forces2
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     ]))
    </div>
    <div class="line">
     <a name="l00684">
     </a>
     <span class="lineno">
      684
     </span>
     gy =
     <a class="code" href="namespaceML_1_1TSNE.html#a85570a40891c7c9271f1f86123f5e52d">
      gains2
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     ] + 0.2f;
    </div>
    <div class="line">
     <a name="l00685">
     </a>
     <span class="lineno">
      685
     </span>
     <span class="keywordflow">
      else
     </span>
    </div>
    <div class="line">
     <a name="l00686">
     </a>
     <span class="lineno">
      686
     </span>
     gy =
     <a class="code" href="namespaceML_1_1TSNE.html#a85570a40891c7c9271f1f86123f5e52d">
      gains2
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     ] * 0.8f;
    </div>
    <div class="line">
     <a name="l00687">
     </a>
     <span class="lineno">
      687
     </span>
     <span class="keywordflow">
      if
     </span>
     (gy &lt; 0.01
     <a class="code" href="namespaceUMAPAlgo_1_1Optimize.html#ad1d8470650aa6ea82693fdf61479e708">
      f
     </a>
     ) gy = 0.01f;
    </div>
    <div class="line">
     <a name="l00688">
     </a>
     <span class="lineno">
      688
     </span>
    </div>
    <div class="line">
     <a name="l00689">
     </a>
     <span class="lineno">
      689
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#ac11723a24afb8d48fdcabfc76eef08e4">
      gains1
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     ] = gx;
    </div>
    <div class="line">
     <a name="l00690">
     </a>
     <span class="lineno">
      690
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a85570a40891c7c9271f1f86123f5e52d">
      gains2
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     ] = gy;
    </div>
    <div class="line">
     <a name="l00691">
     </a>
     <span class="lineno">
      691
     </span>
    </div>
    <div class="line">
     <a name="l00692">
     </a>
     <span class="lineno">
      692
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a532b17ce36ff7c6c05a976cc02b2b01f">
      old_forces1
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     ] = ux =
     <a class="code" href="namespaceML_1_1TSNE.html#afbdcdf332ab9ffef1adaf68fa5feb3da">
      momentum
     </a>
     * ux - eta * gx * dx;
    </div>
    <div class="line">
     <a name="l00693">
     </a>
     <span class="lineno">
      693
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#ac755b1db80982be920c4c7bb36f087e8">
      old_forces2
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     ] = uy =
     <a class="code" href="namespaceML_1_1TSNE.html#afbdcdf332ab9ffef1adaf68fa5feb3da">
      momentum
     </a>
     * uy - eta * gy * dy;
    </div>
    <div class="line">
     <a name="l00694">
     </a>
     <span class="lineno">
      694
     </span>
    </div>
    <div class="line">
     <a name="l00695">
     </a>
     <span class="lineno">
      695
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#afc75b29a7b97e657cdee10c37abc69b8">
      Y1
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     ] += ux;
    </div>
    <div class="line">
     <a name="l00696">
     </a>
     <span class="lineno">
      696
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#af0d6cf0fc091efc0c306c7024ba8a00c">
      Y2
     </a>
     [
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     ] += uy;
    </div>
    <div class="line">
     <a name="l00697">
     </a>
     <span class="lineno">
      697
     </span>
     }
    </div>
    <div class="line">
     <a name="l00698">
     </a>
     <span class="lineno">
      698
     </span>
     }
    </div>
    <div class="line">
     <a name="l00699">
     </a>
     <span class="lineno">
      699
     </span>
    </div>
    <div class="line">
     <a name="l00700">
     </a>
     <span class="lineno">
      700
     </span>
     }
     <span class="comment">
      // namespace TSNE
     </span>
    </div>
    <div class="line">
     <a name="l00701">
     </a>
     <span class="lineno">
      701
     </span>
     }
     <span class="comment">
      // namespace ML
     </span>
    </div>
   </div>
   <!-- fragment -->
  </div>
  <!-- contents -->
  <div class="ttc" id="anamespaceML_1_1TSNE_html_abd3dad89a4d38a71f52c1673e31f8723">
   <div class="ttname">
    <a href="namespaceML_1_1TSNE.html#abd3dad89a4d38a71f52c1673e31f8723">
     ML::TSNE::pos
    </a>
   </div>
   <div class="ttdeci">
    __shared__ int pos[THREADS5]
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    bh_kernels.h:520
   </div>
  </div>
  <div class="ttc" id="anamespaceML_1_1TSNE_html_af0d6cf0fc091efc0c306c7024ba8a00c">
   <div class="ttname">
    <a href="namespaceML_1_1TSNE.html#af0d6cf0fc091efc0c306c7024ba8a00c">
     ML::TSNE::Y2
    </a>
   </div>
   <div class="ttdeci">
    __global__ const float const float float *restrict float *restrict Y2
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    bh_kernels.h:662
   </div>
  </div>
  <div class="ttc" id="anamespaceML_1_1TSNE_html_aa617976838732bc2568391834aca41b5">
   <div class="ttname">
    <a href="namespaceML_1_1TSNE.html#aa617976838732bc2568391834aca41b5">
     ML::TSNE::minxd
    </a>
   </div>
   <div class="ttdeci">
    __global__ int *restrict float *restrict float *restrict float *restrict float *restrict float *restrict float *restrict minxd
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    bh_kernels.h:82
   </div>
  </div>
  <div class="ttc" id="anamespaceML_1_1TSNE_html_a85570a40891c7c9271f1f86123f5e52d">
   <div class="ttname">
    <a href="namespaceML_1_1TSNE.html#a85570a40891c7c9271f1f86123f5e52d">
     ML::TSNE::gains2
    </a>
   </div>
   <div class="ttdeci">
    __global__ const float const float float *restrict float *restrict const float *restrict const float *restrict const float *restrict const float *restrict float *restrict float *restrict gains2
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    bh_kernels.h:664
   </div>
  </div>
  <div class="ttc" id="anamespaceML_1_1TSNE_html_a3fd0469bdd73eaf1f777c1ff1aee929b">
   <div class="ttname">
    <a href="namespaceML_1_1TSNE.html#a3fd0469bdd73eaf1f777c1ff1aee929b">
     ML::TSNE::__launch_bounds__
    </a>
   </div>
   <div class="ttdeci">
    __global__ __launch_bounds__(THREADS1, FACTOR1) void BoundingBoxKernel(int *restrict startd
   </div>
  </div>
  <div class="ttc" id="anamespaceML_1_1TSNE_html_adb4b8ca36469774be6ffb11068071cbc">
   <div class="ttname">
    <a href="namespaceML_1_1TSNE.html#adb4b8ca36469774be6ffb11068071cbc">
     ML::TSNE::y
    </a>
   </div>
   <div class="ttdeci">
    float y
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    bh_kernels.h:186
   </div>
  </div>
  <div class="ttc" id="anamespaceML_1_1TSNE_html_abf75b02e7b11bdbcffd20d6895d97090">
   <div class="ttname">
    <a href="namespaceML_1_1TSNE.html#abf75b02e7b11bdbcffd20d6895d97090">
     ML::TSNE::FOUR_N
    </a>
   </div>
   <div class="ttdeci">
    __global__ const int const int FOUR_N
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    bh_kernels.h:163
   </div>
  </div>
  <div class="ttc" id="anamespaceML_1_1TSNE_html_adb88a27bf03841d34d49c4e0b29ab152">
   <div class="ttname">
    <a href="namespaceML_1_1TSNE.html#adb88a27bf03841d34d49c4e0b29ab152">
     ML::TSNE::Reset_Normalization
    </a>
   </div>
   <div class="ttdeci">
    __global__ void Reset_Normalization(float *restrict Z_norm, float *restrict radiusd_squared, int *restrict bottomd, const int NNODES, const float *restrict radiusd)
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    bh_kernels.h:59
   </div>
  </div>
  <div class="ttc" id="anamespaceML_1_1TSNE_html_a5c7478abb28859ec13dec63fa777a04e">
   <div class="ttname">
    <a href="namespaceML_1_1TSNE.html#a5c7478abb28859ec13dec63fa777a04e">
     ML::TSNE::x
    </a>
   </div>
   <div class="ttdeci">
    float x
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    bh_kernels.h:186
   </div>
  </div>
  <div class="ttc" id="anamespaceML_1_1TSNE_html_a2dfe618ef9e2266e96748bc7006d47fa">
   <div class="ttname">
    <a href="namespaceML_1_1TSNE.html#a2dfe618ef9e2266e96748bc7006d47fa">
     ML::TSNE::restart
    </a>
   </div>
   <div class="ttdeci">
    const int restart
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    bh_kernels.h:330
   </div>
  </div>
  <div class="ttc" id="abh__kernels_8h_html_a8c1f847aac207a6afbed48210310c789">
   <div class="ttname">
    <a href="bh__kernels_8h.html#a8c1f847aac207a6afbed48210310c789">
     THREADS4
    </a>
   </div>
   <div class="ttdeci">
    #define THREADS4
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    bh_kernels.h:23
   </div>
  </div>
  <div class="ttc" id="anamespaceML_1_1TSNE_html_a56fd57480279a12a41953990a3175ea0">
   <div class="ttname">
    <a href="namespaceML_1_1TSNE.html#a56fd57480279a12a41953990a3175ea0">
     ML::TSNE::minyd
    </a>
   </div>
   <div class="ttdeci">
    __global__ int *restrict float *restrict float *restrict float *restrict float *restrict float *restrict float *restrict float *restrict minyd
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    bh_kernels.h:82
   </div>
  </div>
  <div class="ttc" id="anamespaceML_1_1TSNE_html_a78e9ba9338e47997108c6abbc303e04c">
   <div class="ttname">
    <a href="namespaceML_1_1TSNE.html#a78e9ba9338e47997108c6abbc303e04c">
     ML::TSNE::sbase
    </a>
   </div>
   <div class="ttdeci">
    const int sbase
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    bh_kernels.h:541
   </div>
  </div>
  <div class="ttc" id="anamespaceML_1_1TSNE_html_afaef49165bd5905004bb874599a36a30">
   <div class="ttname">
    <a href="namespaceML_1_1TSNE.html#afaef49165bd5905004bb874599a36a30">
     ML::TSNE::sortd
    </a>
   </div>
   <div class="ttdeci">
    __global__ const float const int *restrict sortd
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    bh_kernels.h:500
   </div>
  </div>
  <div class="ttc" id="anamespaceML_1_1TSNE_html_aaa80214511d623eac23f6e19a154fc02">
   <div class="ttname">
    <a href="namespaceML_1_1TSNE.html#aaa80214511d623eac23f6e19a154fc02">
     ML::TSNE::patch
    </a>
   </div>
   <div class="ttdeci">
    int patch
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    bh_kernels.h:188
   </div>
  </div>
  <div class="ttc" id="anamespaceML_1_1TSNE_html_aabce7570ae4f899219545908eaf4a0fb">
   <div class="ttname">
    <a href="namespaceML_1_1TSNE.html#aabce7570ae4f899219545908eaf4a0fb">
     ML::TSNE::maxyd
    </a>
   </div>
   <div class="ttdeci">
    __global__ int *restrict float *restrict float *restrict float *restrict float *restrict float *restrict maxyd
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    bh_kernels.h:82
   </div>
  </div>
  <div class="ttc" id="anamespaceML_1_1TSNE_html_a411b64333babbe9430eaf09eb2cad063">
   <div class="ttname">
    <a href="namespaceML_1_1TSNE.html#a411b64333babbe9430eaf09eb2cad063">
     ML::TSNE::repel2
    </a>
   </div>
   <div class="ttdeci">
    __global__ const float const float float *restrict float *restrict const float *restrict const float *restrict const float *restrict const float *restrict repel2
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    bh_kernels.h:664
   </div>
  </div>
  <div class="ttc" id="anamespaceML_1_1TSNE_html_affcebed822e95c0573529aa4d3cd1609">
   <div class="ttname">
    <a href="namespaceML_1_1TSNE.html#affcebed822e95c0573529aa4d3cd1609">
     ML::TSNE::r
    </a>
   </div>
   <div class="ttdeci">
    float r
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    bh_kernels.h:186
   </div>
  </div>
  <div class="ttc" id="anamespaceML_1_1TSNE_html_abe37b2672d24fb0a19db8757502e120f">
   <div class="ttname">
    <a href="namespaceML_1_1TSNE.html#abe37b2672d24fb0a19db8757502e120f">
     ML::TSNE::posyd
    </a>
   </div>
   <div class="ttdeci">
    __global__ int *restrict float *restrict float *restrict float *restrict posyd
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    bh_kernels.h:81
   </div>
  </div>
  <div class="ttc" id="anamespaceML_1_1TSNE_html_a09fbcb069dfe61f730321699cfb9ebe7">
   <div class="ttname">
    <a href="namespaceML_1_1TSNE.html#a09fbcb069dfe61f730321699cfb9ebe7">
     ML::TSNE::diff
    </a>
   </div>
   <div class="ttdeci">
    const int diff
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    bh_kernels.h:544
   </div>
  </div>
  <div class="ttc" id="anamespaceML_1_1TSNE_html_acfb1787f01f8a74fab3ad6d557ec9ffe">
   <div class="ttname">
    <a href="namespaceML_1_1TSNE.html#acfb1787f01f8a74fab3ad6d557ec9ffe">
     ML::TSNE::inc
    </a>
   </div>
   <div class="ttdeci">
    const int inc
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    bh_kernels.h:95
   </div>
  </div>
  <div class="ttc" id="anamespaceML_1_1TSNE_html_a41a8f2080a734018c9bb091e0c551a10">
   <div class="ttname">
    <a href="namespaceML_1_1TSNE.html#a41a8f2080a734018c9bb091e0c551a10">
     ML::TSNE::py
    </a>
   </div>
   <div class="ttdeci">
    float py
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    bh_kernels.h:187
   </div>
  </div>
  <div class="ttc" id="abh__kernels_8h_html_a6cac1d001fa4d6c00a794bc587dac1d2">
   <div class="ttname">
    <a href="bh__kernels_8h.html#a6cac1d001fa4d6c00a794bc587dac1d2">
     THREADS1
    </a>
   </div>
   <div class="ttdeci">
    #define THREADS1
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    bh_kernels.h:20
   </div>
  </div>
  <div class="ttc" id="anamespaceML_1_1TSNE_html_a532b17ce36ff7c6c05a976cc02b2b01f">
   <div class="ttname">
    <a href="namespaceML_1_1TSNE.html#a532b17ce36ff7c6c05a976cc02b2b01f">
     ML::TSNE::old_forces1
    </a>
   </div>
   <div class="ttdeci">
    __global__ const float const float float *restrict float *restrict const float *restrict const float *restrict const float *restrict const float *restrict float *restrict float *restrict float *restrict old_forces1
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    bh_kernels.h:665
   </div>
  </div>
  <div class="ttc" id="anamespaceML_1_1TSNE_html_ad4056dfe6dce29dbdede1ba6b81d356a">
   <div class="ttname">
    <a href="namespaceML_1_1TSNE.html#ad4056dfe6dce29dbdede1ba6b81d356a">
     ML::TSNE::dq
    </a>
   </div>
   <div class="ttdeci">
    __shared__ float dq[THREADS5]
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    bh_kernels.h:521
   </div>
  </div>
  <div class="ttc" id="anamespaceML_1_1TSNE_html_a1cd86a623f64db84ca537da23b68223c">
   <div class="ttname">
    <a href="namespaceML_1_1TSNE.html#a1cd86a623f64db84ca537da23b68223c">
     ML::TSNE::n
    </a>
   </div>
   <div class="ttdeci">
    int n
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    bh_kernels.h:188
   </div>
  </div>
  <div class="ttc" id="anamespaceML_1_1TSNE_html_a5d845ae81f2e9512c6fde326db6193c3">
   <div class="ttname">
    <a href="namespaceML_1_1TSNE.html#a5d845ae81f2e9512c6fde326db6193c3">
     ML::TSNE::cm
    </a>
   </div>
   <div class="ttdeci">
    float cm
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    bh_kernels.h:321
   </div>
  </div>
  <div class="ttc" id="abh__kernels_8h_html_a07bf054e2784d6caf726da0080fc176b">
   <div class="ttname">
    <a href="bh__kernels_8h.html#a07bf054e2784d6caf726da0080fc176b">
     FACTOR4
    </a>
   </div>
   <div class="ttdeci">
    #define FACTOR4
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    bh_kernels.h:31
   </div>
  </div>
  <div class="ttc" id="anamespaceML_1_1TSNE_html_a67d47a4abdc72a15bfb70ae338232d39">
   <div class="ttname">
    <a href="namespaceML_1_1TSNE.html#a67d47a4abdc72a15bfb70ae338232d39">
     ML::TSNE::__threadfence_block
    </a>
   </div>
   <div class="ttdeci">
    __threadfence_block()
   </div>
  </div>
  <div class="ttc" id="anamespaceML_1_1TSNE_html_a875e5b422b8d5c082b909357872daa59">
   <div class="ttname">
    <a href="namespaceML_1_1TSNE.html#a875e5b422b8d5c082b909357872daa59">
     ML::TSNE::localmaxdepth
    </a>
   </div>
   <div class="ttdeci">
    int localmaxdepth
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    bh_kernels.h:195
   </div>
  </div>
  <div class="ttc" id="abh__kernels_8h_html_a09496545d22a86a5d0293a80bb1920f7">
   <div class="ttname">
    <a href="bh__kernels_8h.html#a09496545d22a86a5d0293a80bb1920f7">
     FACTOR6
    </a>
   </div>
   <div class="ttdeci">
    #define FACTOR6
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    bh_kernels.h:33
   </div>
  </div>
  <div class="ttc" id="anamespaceML_1_1TSNE_html_a562384af697c8fbd87301bdadf156b10">
   <div class="ttname">
    <a href="namespaceML_1_1TSNE.html#a562384af697c8fbd87301bdadf156b10">
     ML::TSNE::limiter
    </a>
   </div>
   <div class="ttdeci">
    __global__ int *restrict float *restrict float *restrict float *restrict float *restrict float *restrict float *restrict float *restrict const int const int const int unsigned *restrict limiter
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    bh_kernels.h:84
   </div>
  </div>
  <div class="ttc" id="anamespaceML_1_1TSNE_html_a89f30c48ab5b3f4e240579701f20c187">
   <div class="ttname">
    <a href="namespaceML_1_1TSNE.html#a89f30c48ab5b3f4e240579701f20c187">
     ML::TSNE::minx
    </a>
   </div>
   <div class="ttdeci">
    minx
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    bh_kernels.h:90
   </div>
  </div>
  <div class="ttc" id="anamespaceML_1_1TSNE_html_ad3a3689aa3be4fbe7d26112ea7371752">
   <div class="ttname">
    <a href="namespaceML_1_1TSNE.html#ad3a3689aa3be4fbe7d26112ea7371752">
     ML::TSNE::maxxd
    </a>
   </div>
   <div class="ttdeci">
    __global__ int *restrict float *restrict float *restrict float *restrict float *restrict maxxd
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    bh_kernels.h:81
   </div>
  </div>
  <div class="ttc" id="anamespaceML_1_1TSNE_html_a795c41c3f064d2e2b9a449d805cd4161">
   <div class="ttname">
    <a href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
     ML::TSNE::i
    </a>
   </div>
   <div class="ttdeci">
    const int i
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    bh_kernels.h:94
   </div>
  </div>
  <div class="ttc" id="anamespaceML_1_1TSNE_html_a7086cebb5fe77bd10499d494328ba1c1">
   <div class="ttname">
    <a href="namespaceML_1_1TSNE.html#a7086cebb5fe77bd10499d494328ba1c1">
     ML::TSNE::N
    </a>
   </div>
   <div class="ttdeci">
    __global__ int *restrict float *restrict float *restrict float *restrict float *restrict float *restrict float *restrict float *restrict const int const int const int N
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    bh_kernels.h:83
   </div>
  </div>
  <div class="ttc" id="amath_8h_html">
   <div class="ttname">
    <a href="math_8h.html">
     math.h
    </a>
   </div>
  </div>
  <div class="ttc" id="abh__kernels_8h_html_ab64e4c5074162a06e839885cba787ecc">
   <div class="ttname">
    <a href="bh__kernels_8h.html#ab64e4c5074162a06e839885cba787ecc">
     FACTOR2
    </a>
   </div>
   <div class="ttdeci">
    #define FACTOR2
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    bh_kernels.h:29
   </div>
  </div>
  <div class="ttc" id="anamespaceML_1_1TSNE_html_ad506ff98589c53814844d9f8663a127d">
   <div class="ttname">
    <a href="namespaceML_1_1TSNE.html#ad506ff98589c53814844d9f8663a127d">
     ML::TSNE::FOUR_NNODES
    </a>
   </div>
   <div class="ttdeci">
    __global__ int *restrict float *restrict float *restrict float *restrict float *restrict float *restrict float *restrict float *restrict const int FOUR_NNODES
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    bh_kernels.h:83
   </div>
  </div>
  <div class="ttc" id="abh__kernels_8h_html_a996f9a6fd15089ce39bccf4143a01a50">
   <div class="ttname">
    <a href="bh__kernels_8h.html#a996f9a6fd15089ce39bccf4143a01a50">
     FACTOR3
    </a>
   </div>
   <div class="ttdeci">
    #define FACTOR3
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    bh_kernels.h:30
   </div>
  </div>
  <div class="ttc" id="anamespaceML_1_1TSNE_html_a019429a6bfc09e7fbab8fe40e179bf9c">
   <div class="ttname">
    <a href="namespaceML_1_1TSNE.html#a019429a6bfc09e7fbab8fe40e179bf9c">
     ML::TSNE::InitializationKernel
    </a>
   </div>
   <div class="ttdeci">
    __global__ void InitializationKernel(unsigned *restrict limiter, int *restrict maxdepthd, float *restrict radiusd)
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    bh_kernels.h:46
   </div>
  </div>
  <div class="ttc" id="anamespaceML_1_1TSNE_html_ac2ed5d1c15f05f27281f106028c4c525">
   <div class="ttname">
    <a href="namespaceML_1_1TSNE.html#ac2ed5d1c15f05f27281f106028c4c525">
     ML::TSNE::bottom
    </a>
   </div>
   <div class="ttdeci">
    const int bottom
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    bh_kernels.h:325
   </div>
  </div>
  <div class="ttc" id="anamespaceML_1_1TSNE_html_ad1d12124fbd3b44dee622f403fda7276">
   <div class="ttname">
    <a href="namespaceML_1_1TSNE.html#ad1d12124fbd3b44dee622f403fda7276">
     ML::TSNE::attract2
    </a>
   </div>
   <div class="ttdeci">
    __global__ const float const float float *restrict float *restrict const float *restrict const float *restrict attract2
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    bh_kernels.h:663
   </div>
  </div>
  <div class="ttc" id="anamespaceML_1_1TSNE_html_ac755b1db80982be920c4c7bb36f087e8">
   <div class="ttname">
    <a href="namespaceML_1_1TSNE.html#ac755b1db80982be920c4c7bb36f087e8">
     ML::TSNE::old_forces2
    </a>
   </div>
   <div class="ttdeci">
    __global__ const float const float float *restrict float *restrict const float *restrict const float *restrict const float *restrict const float *restrict float *restrict float *restrict float *restrict float *restrict old_forces2
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    bh_kernels.h:665
   </div>
  </div>
  <div class="ttc" id="abh__kernels_8h_html_a12498f409c0023a090abf74f90b511f8">
   <div class="ttname">
    <a href="bh__kernels_8h.html#a12498f409c0023a090abf74f90b511f8">
     THREADS5
    </a>
   </div>
   <div class="ttdeci">
    #define THREADS5
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    bh_kernels.h:24
   </div>
  </div>
  <div class="ttc" id="acudart__utils_8h_html">
   <div class="ttname">
    <a href="cudart__utils_8h.html">
     cudart_utils.h
    </a>
   </div>
  </div>
  <div class="ttc" id="anamespaceML_1_1TSNE_html_a5e6127c8e89f25aba2fc545044afcb4a">
   <div class="ttname">
    <a href="namespaceML_1_1TSNE.html#a5e6127c8e89f25aba2fc545044afcb4a">
     ML::TSNE::if
    </a>
   </div>
   <div class="ttdeci">
    if(i==0)
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    bh_kernels.h:125
   </div>
  </div>
  <div class="ttc" id="anamespaceML_1_1TSNE_html_a167f3c550a51b8a44d7d6fed46db0546">
   <div class="ttname">
    <a href="namespaceML_1_1TSNE.html#a167f3c550a51b8a44d7d6fed46db0546">
     ML::TSNE::radiusd
    </a>
   </div>
   <div class="ttdeci">
    __global__ int *restrict float *restrict float *restrict float *restrict float *restrict float *restrict float *restrict float *restrict const int const int const int unsigned *restrict float *restrict radiusd
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    bh_kernels.h:84
   </div>
  </div>
  <div class="ttc" id="abh__kernels_8h_html_a508375c867f31fb42c1135881ddfd8f3">
   <div class="ttname">
    <a href="bh__kernels_8h.html#a508375c867f31fb42c1135881ddfd8f3">
     THREADS3
    </a>
   </div>
   <div class="ttdeci">
    #define THREADS3
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    bh_kernels.h:22
   </div>
  </div>
  <div class="ttc" id="abh__kernels_8h_html_a86edd6193b14e2e0597fddab89881e3a">
   <div class="ttname">
    <a href="bh__kernels_8h.html#a86edd6193b14e2e0597fddab89881e3a">
     THREADS2
    </a>
   </div>
   <div class="ttdeci">
    #define THREADS2
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    bh_kernels.h:21
   </div>
  </div>
  <div class="ttc" id="anamespaceML_1_1TSNE_html_afbe45ee536ce9f686021d1d0a0a7e280">
   <div class="ttname">
    <a href="namespaceML_1_1TSNE.html#afbe45ee536ce9f686021d1d0a0a7e280">
     ML::TSNE::mass
    </a>
   </div>
   <div class="ttdeci">
    __shared__ float mass[THREADS3 *4]
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    bh_kernels.h:323
   </div>
  </div>
  <div class="ttc" id="anamespaceUMAPAlgo_1_1Optimize_html_ad1d8470650aa6ea82693fdf61479e708">
   <div class="ttname">
    <a href="namespaceUMAPAlgo_1_1Optimize.html#ad1d8470650aa6ea82693fdf61479e708">
     UMAPAlgo::Optimize::f
    </a>
   </div>
   <div class="ttdeci">
    void f(T *input, int n_rows, T *coef, T *preds)
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    optimize.h:60
   </div>
  </div>
  <div class="ttc" id="anamespaceML_1_1TSNE_html_a256aedf0a028da5f7c5e13712a8223d1">
   <div class="ttname">
    <a href="namespaceML_1_1TSNE.html#a256aedf0a028da5f7c5e13712a8223d1">
     ML::TSNE::get_norm
    </a>
   </div>
   <div class="ttdeci">
    __global__ void get_norm(const float *restrict Y1, const float *restrict Y2, float *restrict norm, float *restrict norm_add1, const int N)
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    bh_kernels.h:624
   </div>
  </div>
  <div class="ttc" id="anamespaceML_1_1TSNE_html_afc75b29a7b97e657cdee10c37abc69b8">
   <div class="ttname">
    <a href="namespaceML_1_1TSNE.html#afc75b29a7b97e657cdee10c37abc69b8">
     ML::TSNE::Y1
    </a>
   </div>
   <div class="ttdeci">
    __global__ const float const float float *restrict Y1
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    bh_kernels.h:662
   </div>
  </div>
  <div class="ttc" id="anamespaceML_1_1TSNE_html_a9ad8347253e04c7966f2aae19ba1eb77">
   <div class="ttname">
    <a href="namespaceML_1_1TSNE.html#a9ad8347253e04c7966f2aae19ba1eb77">
     ML::TSNE::theta_squared
    </a>
   </div>
   <div class="ttdeci">
    __global__ const float const int *restrict const int *restrict const float *restrict const float *restrict const float *restrict float *restrict float *restrict float *restrict const float theta_squared
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    bh_kernels.h:507
   </div>
  </div>
  <div class="ttc" id="anamespaceML_1_1TSNE_html_a5b23a524a62bfbdfc7a822f7986fff81">
   <div class="ttname">
    <a href="namespaceML_1_1TSNE.html#a5b23a524a62bfbdfc7a822f7986fff81">
     ML::TSNE::smaxy
    </a>
   </div>
   <div class="ttdeci">
    __shared__ float smaxy[THREADS1]
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    bh_kernels.h:87
   </div>
  </div>
  <div class="ttc" id="anamespaceML_1_1TSNE_html_ad530b26f03ad51d5eb7fce1926dd2360">
   <div class="ttname">
    <a href="namespaceML_1_1TSNE.html#ad530b26f03ad51d5eb7fce1926dd2360">
     ML::TSNE::Z_norm
    </a>
   </div>
   <div class="ttdeci">
    __global__ const float const int *restrict const int *restrict const float *restrict const float *restrict const float *restrict float *restrict float *restrict float *restrict Z_norm
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    bh_kernels.h:506
   </div>
  </div>
  <div class="ttc" id="abh__kernels_8h_html_a48c2c174863ddcf744426fb56be31ef6">
   <div class="ttname">
    <a href="bh__kernels_8h.html#a48c2c174863ddcf744426fb56be31ef6">
     FACTOR5
    </a>
   </div>
   <div class="ttdeci">
    #define FACTOR5
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    bh_kernels.h:32
   </div>
  </div>
  <div class="ttc" id="abh__kernels_8h_html_a3c4ca86a6531f092f92f04ae336be835">
   <div class="ttname">
    <a href="bh__kernels_8h.html#a3c4ca86a6531f092f92f04ae336be835">
     THREADS6
    </a>
   </div>
   <div class="ttdeci">
    #define THREADS6
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    bh_kernels.h:25
   </div>
  </div>
  <div class="ttc" id="anamespaceML_1_1TSNE_html_aa94ac12848f403e7c569e5de3037b206">
   <div class="ttname">
    <a href="namespaceML_1_1TSNE.html#aa94ac12848f403e7c569e5de3037b206">
     ML::TSNE::bottomd
    </a>
   </div>
   <div class="ttdeci">
    __global__ const float *restrict const float *restrict const int const int int *restrict int *restrict bottomd
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    bh_kernels.h:183
   </div>
  </div>
  <div class="ttc" id="anamespaceML_1_1TSNE_html_a4056778964b393afbe6720d23a367e42">
   <div class="ttname">
    <a href="namespaceML_1_1TSNE.html#a4056778964b393afbe6720d23a367e42">
     ML::TSNE::attractive_kernel_bh
    </a>
   </div>
   <div class="ttdeci">
    __global__ void attractive_kernel_bh(const float *restrict VAL, const int *restrict COL, const int *restrict ROW, const float *restrict Y1, const float *restrict Y2, const float *restrict norm, const float *restrict norm_add1, float *restrict attract1, float *restrict attract2, const int NNZ)
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    bh_kernels.h:636
   </div>
  </div>
  <div class="ttc" id="anamespaceML_1_1TSNE_html_afb851e919e0cd78a7c66faf65d407452">
   <div class="ttname">
    <a href="namespaceML_1_1TSNE.html#afb851e919e0cd78a7c66faf65d407452">
     ML::TSNE::k
    </a>
   </div>
   <div class="ttdeci">
    int k
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    bh_kernels.h:165
   </div>
  </div>
  <div class="ttc" id="anamespaceML_1_1TSNE_html_aa248106f4e1949a1c8e1c0f1d4793a26">
   <div class="ttname">
    <a href="namespaceML_1_1TSNE.html#aa248106f4e1949a1c8e1c0f1d4793a26">
     ML::TSNE::repel1
    </a>
   </div>
   <div class="ttdeci">
    __global__ const float const float float *restrict float *restrict const float *restrict const float *restrict const float *restrict repel1
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    bh_kernels.h:663
   </div>
  </div>
  <div class="ttc" id="abh__kernels_8h_html_a4b50b75600a4385c7affd1c82998eef2">
   <div class="ttname">
    <a href="bh__kernels_8h.html#a4b50b75600a4385c7affd1c82998eef2">
     FACTOR1
    </a>
   </div>
   <div class="ttdeci">
    #define FACTOR1
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    bh_kernels.h:28
   </div>
  </div>
  <div class="ttc" id="anamespaceML_1_1TSNE_html_a34958bf847c3b0955734c6fc4de7679c">
   <div class="ttname">
    <a href="namespaceML_1_1TSNE.html#a34958bf847c3b0955734c6fc4de7679c">
     ML::TSNE::MAX_SIZE
    </a>
   </div>
   <div class="ttdeci">
    const int MAX_SIZE
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    bh_kernels.h:554
   </div>
  </div>
  <div class="ttc" id="anamespaceML_1_1TSNE_html_ac11723a24afb8d48fdcabfc76eef08e4">
   <div class="ttname">
    <a href="namespaceML_1_1TSNE.html#ac11723a24afb8d48fdcabfc76eef08e4">
     ML::TSNE::gains1
    </a>
   </div>
   <div class="ttdeci">
    __global__ const float const float float *restrict float *restrict const float *restrict const float *restrict const float *restrict const float *restrict float *restrict gains1
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    bh_kernels.h:664
   </div>
  </div>
  <div class="ttc" id="anamespaceML_1_1TSNE_html_aaeba4f3e347780328e08a424e719255e">
   <div class="ttname">
    <a href="namespaceML_1_1TSNE.html#aaeba4f3e347780328e08a424e719255e">
     ML::TSNE::massd
    </a>
   </div>
   <div class="ttdeci">
    __global__ int *restrict float *restrict massd
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    bh_kernels.h:80
   </div>
  </div>
  <div class="ttc" id="anamespaceML_1_1TSNE_html_aa2dfafe57a92a0075fe925a8a7dc45f5">
   <div class="ttname">
    <a href="namespaceML_1_1TSNE.html#aa2dfafe57a92a0075fe925a8a7dc45f5">
     ML::TSNE::maxdepthd
    </a>
   </div>
   <div class="ttdeci">
    __global__ const float *restrict const float *restrict const int const int int *restrict maxdepthd
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    bh_kernels.h:182
   </div>
  </div>
  <div class="ttc" id="anamespaceML_1_1TSNE_html_aac7b09a1aa16f82b8663f6fb4b07e592">
   <div class="ttname">
    <a href="namespaceML_1_1TSNE.html#aac7b09a1aa16f82b8663f6fb4b07e592">
     ML::TSNE::start
    </a>
   </div>
   <div class="ttdeci">
    int start
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    bh_kernels.h:456
   </div>
  </div>
  <div class="ttc" id="anamespaceML_1_1TSNE_html_a7ad23cd0bd45879aa59a05d2fc8acf98">
   <div class="ttname">
    <a href="namespaceML_1_1TSNE.html#a7ad23cd0bd45879aa59a05d2fc8acf98">
     ML::TSNE::miny
    </a>
   </div>
   <div class="ttdeci">
    miny
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    bh_kernels.h:91
   </div>
  </div>
  <div class="ttc" id="anamespaceML_1_1TSNE_html_aea214671864d82984f60a37e821b63a6">
   <div class="ttname">
    <a href="namespaceML_1_1TSNE.html#aea214671864d82984f60a37e821b63a6">
     ML::TSNE::sminy
    </a>
   </div>
   <div class="ttdeci">
    __shared__ float sminy[THREADS1]
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    bh_kernels.h:86
   </div>
  </div>
  <div class="ttc" id="anamespaceML_1_1TSNE_html_a10fffba66c9ffb66ba7102e04eecb2fd">
   <div class="ttname">
    <a href="namespaceML_1_1TSNE.html#a10fffba66c9ffb66ba7102e04eecb2fd">
     ML::TSNE::rooty
    </a>
   </div>
   <div class="ttdeci">
    const float rooty
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    bh_kernels.h:193
   </div>
  </div>
  <div class="ttc" id="anamespaceML_1_1TSNE_html_adcce7a8c238de2a7c2d7005369ca08b3">
   <div class="ttname">
    <a href="namespaceML_1_1TSNE.html#adcce7a8c238de2a7c2d7005369ca08b3">
     ML::TSNE::epssqd
    </a>
   </div>
   <div class="ttdeci">
    __global__ const float epssqd
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    bh_kernels.h:499
   </div>
  </div>
  <div class="ttc" id="anamespaceML_1_1TSNE_html_aebbccd9fcfe93dddcc2d01fdee16d927">
   <div class="ttname">
    <a href="namespaceML_1_1TSNE.html#aebbccd9fcfe93dddcc2d01fdee16d927">
     ML::TSNE::exaggeration
    </a>
   </div>
   <div class="ttdeci">
    __global__ const float const float exaggeration
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    bh_kernels.h:661
   </div>
  </div>
  <div class="ttc" id="anamespaceML_1_1TSNE_html_a35b748d14131f08262d43bd8b09f02e1">
   <div class="ttname">
    <a href="namespaceML_1_1TSNE.html#a35b748d14131f08262d43bd8b09f02e1">
     ML::TSNE::velyd
    </a>
   </div>
   <div class="ttdeci">
    __global__ const float const int *restrict const int *restrict const float *restrict const float *restrict const float *restrict float *restrict float *restrict velyd
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    bh_kernels.h:505
   </div>
  </div>
  <div class="ttc" id="anamespaceML_1_1TSNE_html_ad5c3a149f16c2850ff03ca0d4182b594">
   <div class="ttname">
    <a href="namespaceML_1_1TSNE.html#ad5c3a149f16c2850ff03ca0d4182b594">
     ML::TSNE::posxd
    </a>
   </div>
   <div class="ttdeci">
    __global__ int *restrict float *restrict float *restrict posxd
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    bh_kernels.h:81
   </div>
  </div>
  <div class="ttc" id="anamespaceML_1_1TSNE_html_a545006d7604664ff5e093702ff8fc196">
   <div class="ttname">
    <a href="namespaceML_1_1TSNE.html#a545006d7604664ff5e093702ff8fc196">
     ML::TSNE::px
    </a>
   </div>
   <div class="ttdeci">
    float px
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    bh_kernels.h:187
   </div>
  </div>
  <div class="ttc" id="anamespaceML_1_1TSNE_html_a3fefd48af2c466fc1b1c62023383ea7b">
   <div class="ttname">
    <a href="namespaceML_1_1TSNE.html#a3fefd48af2c466fc1b1c62023383ea7b">
     ML::TSNE::atomicMax
    </a>
   </div>
   <div class="ttdeci">
    atomicMax(maxdepthd, localmaxdepth)
   </div>
  </div>
  <div class="ttc" id="anamespaceML_1_1TSNE_html_a65b34cd3b27de3fc6cc33c96e19970e1">
   <div class="ttname">
    <a href="namespaceML_1_1TSNE.html#a65b34cd3b27de3fc6cc33c96e19970e1">
     ML::TSNE::child
    </a>
   </div>
   <div class="ttdeci">
    __shared__ int child[THREADS3 *4]
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    bh_kernels.h:322
   </div>
  </div>
  <div class="ttc" id="anamespaceML_1_1TSNE_html_a7b19a2886fa3ed52496d77f9c2bbd440">
   <div class="ttname">
    <a href="namespaceML_1_1TSNE.html#a7b19a2886fa3ed52496d77f9c2bbd440">
     ML::TSNE::locked
    </a>
   </div>
   <div class="ttdeci">
    int locked
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    bh_kernels.h:188
   </div>
  </div>
  <div class="ttc" id="anamespaceML_1_1TSNE_html_a1d775ae44089726fc5f8d66f78528ada">
   <div class="ttname">
    <a href="namespaceML_1_1TSNE.html#a1d775ae44089726fc5f8d66f78528ada">
     ML::TSNE::NNODES
    </a>
   </div>
   <div class="ttdeci">
    __global__ int *restrict float *restrict float *restrict float *restrict float *restrict float *restrict float *restrict float *restrict const int const int NNODES
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    bh_kernels.h:83
   </div>
  </div>
  <div class="ttc" id="anamespaceML_1_1TSNE_html_ad15b73f1ef85613a669b3acb6ed86d07">
   <div class="ttname">
    <a href="namespaceML_1_1TSNE.html#ad15b73f1ef85613a669b3acb6ed86d07">
     ML::TSNE::Find_Normalization
    </a>
   </div>
   <div class="ttdeci">
    __global__ void Find_Normalization(float *restrict Z_norm, const float N)
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    bh_kernels.h:72
   </div>
  </div>
  <div class="ttc" id="anamespaceML_1_1TSNE_html_aa7af7a282a727812d02249e36b56d7cb">
   <div class="ttname">
    <a href="namespaceML_1_1TSNE.html#aa7af7a282a727812d02249e36b56d7cb">
     ML::TSNE::j
    </a>
   </div>
   <div class="ttdeci">
    int j
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    bh_kernels.h:380
   </div>
  </div>
  <div class="ttc" id="anamespaceML_1_1TSNE_html_a422f70195ab5e33488f766eee63eedea">
   <div class="ttname">
    <a href="namespaceML_1_1TSNE.html#a422f70195ab5e33488f766eee63eedea">
     ML::TSNE::SBASE_EQ_THREAD
    </a>
   </div>
   <div class="ttdeci">
    const bool SBASE_EQ_THREAD
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    bh_kernels.h:542
   </div>
  </div>
  <div class="ttc" id="anamespaceML_1_1TSNE_html_a121d25f1b38a1dabf92d06f8bdbc681b">
   <div class="ttname">
    <a href="namespaceML_1_1TSNE.html#a121d25f1b38a1dabf92d06f8bdbc681b">
     ML::TSNE::skip
    </a>
   </div>
   <div class="ttdeci">
    int skip
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    bh_kernels.h:196
   </div>
  </div>
  <div class="ttc" id="anamespaceML_1_1TSNE_html_a6347a6e1f57c82d250448f18dde22537">
   <div class="ttname">
    <a href="namespaceML_1_1TSNE.html#a6347a6e1f57c82d250448f18dde22537">
     ML::TSNE::attract1
    </a>
   </div>
   <div class="ttdeci">
    __global__ const float const float float *restrict float *restrict const float *restrict attract1
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    bh_kernels.h:662
   </div>
  </div>
  <div class="ttc" id="anamespaceML_1_1TSNE_html_a63100ce0727aa1b75a80b0d9651c133a">
   <div class="ttname">
    <a href="namespaceML_1_1TSNE.html#a63100ce0727aa1b75a80b0d9651c133a">
     ML::TSNE::radius
    </a>
   </div>
   <div class="ttdeci">
    const float radius
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    bh_kernels.h:191
   </div>
  </div>
  <div class="ttc" id="anamespaceML_1_1TSNE_html_a98168b1bb13bc28991297eef583f11fe">
   <div class="ttname">
    <a href="namespaceML_1_1TSNE.html#a98168b1bb13bc28991297eef583f11fe">
     ML::TSNE::__syncthreads
    </a>
   </div>
   <div class="ttdeci">
    __syncthreads()
   </div>
  </div>
  <div class="ttc" id="anamespaceML_1_1TSNE_html_afbdcdf332ab9ffef1adaf68fa5feb3da">
   <div class="ttname">
    <a href="namespaceML_1_1TSNE.html#afbdcdf332ab9ffef1adaf68fa5feb3da">
     ML::TSNE::momentum
    </a>
   </div>
   <div class="ttdeci">
    __global__ const float momentum
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    bh_kernels.h:661
   </div>
  </div>
  <div class="ttc" id="anamespaceML_1_1TSNE_html_a6f907825b88704a837d42ff66f3e77b7">
   <div class="ttname">
    <a href="namespaceML_1_1TSNE.html#a6f907825b88704a837d42ff66f3e77b7">
     ML::TSNE::countd
    </a>
   </div>
   <div class="ttdeci">
    __global__ const int *restrict countd
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    bh_kernels.h:450
   </div>
  </div>
  <div class="ttc" id="anamespaceMLCommon_1_1Distance_html_a2424d27a67d0483530b531f6ac12d07f">
   <div class="ttname">
    <a href="namespaceMLCommon_1_1Distance.html#a2424d27a67d0483530b531f6ac12d07f">
     MLCommon::Distance::m
    </a>
   </div>
   <div class="ttdeci">
    __global__ const DataT const DataT const DataT const DataT IdxT m
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    fused_l2_nn.h:263
   </div>
  </div>
  <div class="ttc" id="anamespaceML_1_1TSNE_html_a5fb0936df7675d60b572cc1b9f6d34ec">
   <div class="ttname">
    <a href="namespaceML_1_1TSNE.html#a5fb0936df7675d60b572cc1b9f6d34ec">
     ML::TSNE::velxd
    </a>
   </div>
   <div class="ttdeci">
    __global__ const float const int *restrict const int *restrict const float *restrict const float *restrict const float *restrict float *restrict velxd
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    bh_kernels.h:505
   </div>
  </div>
  <div class="ttc" id="anamespaceML_1_1TSNE_html_af16f443a812df8b6cabb5dd30058d377">
   <div class="ttname">
    <a href="namespaceML_1_1TSNE.html#af16f443a812df8b6cabb5dd30058d377">
     ML::TSNE::node
    </a>
   </div>
   <div class="ttdeci">
    __shared__ int node[THREADS5]
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    bh_kernels.h:520
   </div>
  </div>
  <div class="ttc" id="anamespaceML_1_1TSNE_html_a375949168735d67d84b0db0ef9ae7006">
   <div class="ttname">
    <a href="namespaceML_1_1TSNE.html#a375949168735d67d84b0db0ef9ae7006">
     ML::TSNE::sminx
    </a>
   </div>
   <div class="ttdeci">
    __shared__ float sminx[THREADS1]
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    bh_kernels.h:86
   </div>
  </div>
  <div class="ttc" id="anamespaceML_1_1TSNE_html_aef77c1ba4db5586bb012d8a9f6ed22be">
   <div class="ttname">
    <a href="namespaceML_1_1TSNE.html#aef77c1ba4db5586bb012d8a9f6ed22be">
     ML::TSNE::smaxx
    </a>
   </div>
   <div class="ttdeci">
    __shared__ float smaxx[THREADS1]
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    bh_kernels.h:86
   </div>
  </div>
  <div class="ttc" id="anamespaceML_1_1TSNE_html_a5ce45a143c09583658ad00ac3c219c5e">
   <div class="ttname">
    <a href="namespaceML_1_1TSNE.html#a5ce45a143c09583658ad00ac3c219c5e">
     ML::TSNE::rootx
    </a>
   </div>
   <div class="ttdeci">
    const float rootx
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    bh_kernels.h:192
   </div>
  </div>
  <div class="ttc" id="anamespaceML_html">
   <div class="ttname">
    <a href="namespaceML.html">
     ML
    </a>
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    cuML_comms.hpp:22
   </div>
  </div>
  <div class="ttc" id="anamespaceML_1_1TSNE_html_ad7b00d371d403bb26f2bb196659e9c56">
   <div class="ttname">
    <a href="namespaceML_1_1TSNE.html#ad7b00d371d403bb26f2bb196659e9c56">
     ML::TSNE::childd
    </a>
   </div>
   <div class="ttdeci">
    __global__ int *restrict childd
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    bh_kernels.h:80
   </div>
  </div>
  <div class="ttc" id="abh__kernels_8h_html_a080abdcb9c02438f1cd2bb707af25af8">
   <div class="ttname">
    <a href="bh__kernels_8h.html#a080abdcb9c02438f1cd2bb707af25af8">
     restrict
    </a>
   </div>
   <div class="ttdeci">
    #define restrict
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    bh_kernels.h:18
   </div>
  </div>
  <div class="ttc" id="anamespaceML_1_1TSNE_html_a5c84bdf4a3c1a8d60c5e984e7f4eb5a9">
   <div class="ttname">
    <a href="namespaceML_1_1TSNE.html#a5c84bdf4a3c1a8d60c5e984e7f4eb5a9">
     ML::TSNE::dec
    </a>
   </div>
   <div class="ttdeci">
    const int dec
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    bh_kernels.h:454
   </div>
  </div>
  <div class="ttc" id="anamespaceML_1_1TSNE_html_a2732a645713566a20477f67210871121">
   <div class="ttname">
    <a href="namespaceML_1_1TSNE.html#a2732a645713566a20477f67210871121">
     ML::TSNE::startd
    </a>
   </div>
   <div class="ttdeci">
    __global__ const int *restrict volatile int *restrict startd
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    bh_kernels.h:451
   </div>
  </div>
  <div class="ttc" id="anamespaceML_1_1TSNE_html_aad1e315a2fa14c6112ce621379d92b4b">
   <div class="ttname">
    <a href="namespaceML_1_1TSNE.html#aad1e315a2fa14c6112ce621379d92b4b">
     ML::TSNE::radiusd_squared
    </a>
   </div>
   <div class="ttdeci">
    __global__ const float const int *restrict const int *restrict const float *restrict const float *restrict const float *restrict float *restrict float *restrict float *restrict const float const int const int const int const float *restrict radiusd_squared
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    bh_kernels.h:509
   </div>
  </div>
  <div class="ttc" id="anamespaceML_1_1TSNE_html_a5d89f904dbf62a36b80e4726e11d1a55">
   <div class="ttname">
    <a href="namespaceML_1_1TSNE.html#a5d89f904dbf62a36b80e4726e11d1a55">
     ML::TSNE::Z
    </a>
   </div>
   <div class="ttdeci">
    __global__ const float const float float *restrict float *restrict const float *restrict const float *restrict const float *restrict const float *restrict float *restrict float *restrict float *restrict float *restrict const float *restrict Z
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    bh_kernels.h:666
   </div>
  </div>
  <div class="ttc" id="anamespaceML_1_1TSNE_html_a8d0e55527f603695851cd43670718ac2">
   <div class="ttname">
    <a href="namespaceML_1_1TSNE.html#a8d0e55527f603695851cd43670718ac2">
     ML::TSNE::ch
    </a>
   </div>
   <div class="ttdeci">
    int ch
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    bh_kernels.h:188
   </div>
  </div>
  <!-- start footer part -->
  <hr class="footer"/>
  <address class="footer">
   <small>
    Generated by
    <a href="http://www.doxygen.org/index.html">
     <img alt="doxygen" class="footer" src="doxygen.png"/>
    </a>
    1.8.18
   </small>
  </address>
  <script defer id="rapids-selector-js" src="/assets/js/custom.js">
  </script>
 </body>
</html>
