<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
 <head>
  <meta content="text/xhtml;charset=utf-8" http-equiv="Content-Type"/>
  <meta content="IE=9" http-equiv="X-UA-Compatible"/>
  <meta content="Doxygen 1.8.18" name="generator"/>
  <meta content="width=device-width, initial-scale=1" name="viewport"/>
  <title>
   cuML C++ API: /rapids/cuml/cpp/src_prims/timeSeries/stationarity.h Source File
  </title>
  <link href="tabs.css" rel="stylesheet" type="text/css"/>
  <script src="jquery.js" type="text/javascript">
  </script>
  <script src="dynsections.js" type="text/javascript">
  </script>
  <link href="search/search.css" rel="stylesheet" type="text/css"/>
  <script src="search/searchdata.js" type="text/javascript">
  </script>
  <script src="search/search.js" type="text/javascript">
  </script>
  <script type="text/x-mathjax-config">
   MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
  </script>
  <script async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js" type="text/javascript">
  </script>
  <link href="doxygen.css" rel="stylesheet" type="text/css"/>
  <link href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" id="rapids-fa-tag" rel="stylesheet"/>
  <link href="/assets/css/custom.css" id="rapids-selector-css" rel="stylesheet"/>
 </head>
 <body>
  <div id="top">
   <!-- do not remove this div, it is closed by doxygen! -->
   <div id="titlearea">
    <div id="rapids-doxygen-container">
     <div class="rapids-home-container">
      <a class="rapids-home-container__home-btn" href="/api">
       Home
      </a>
     </div>
     <div class="rapids-selector__container rapids-selector--hidden">
      <div class="rapids-selector__selected">
       libcuml
      </div>
      <div class="rapids-selector__menu">
       <a class="rapids-selector__menu-item" href="/api/clx/stable/api.html">
        clx
       </a>
       <a class="rapids-selector__menu-item" href="/api/cudf/stable/api.html">
        cudf
       </a>
       <a class="rapids-selector__menu-item" href="/api/cugraph/stable/api.html">
        cugraph
       </a>
       <a class="rapids-selector__menu-item" href="/api/cuml/stable/api.html">
        cuml
       </a>
       <a class="rapids-selector__menu-item" href="/api/cusignal/stable/api.html">
        cusignal
       </a>
       <a class="rapids-selector__menu-item" href="/api/cuspatial/stable/api.html">
        cuspatial
       </a>
       <a class="rapids-selector__menu-item" href="/api/cuxfilter/stable">
        cuxfilter
       </a>
       <a class="rapids-selector__menu-item" href="/api/libcudf/stable/namespacecudf.html">
        libcudf
       </a>
       <a class="rapids-selector__menu-item rapids-selector__menu-item--selected" href="/api/libcuml/nightly">
        libcuml
       </a>
       <a class="rapids-selector__menu-item" href="/api/libnvstrings/stable/annotated.html">
        libnvstrings
       </a>
       <a class="rapids-selector__menu-item" href="/api/nvstrings/stable/api.html">
        nvstrings
       </a>
       <a class="rapids-selector__menu-item" href="/api/rmm/stable/annotated.html">
        rmm
       </a>
      </div>
     </div>
     <div class="rapids-selector__container rapids-selector--hidden">
      <div class="rapids-selector__selected">
       nightly (0.14)
      </div>
      <div class="rapids-selector__menu">
       <a class="rapids-selector__menu-item rapids-selector__menu-item--selected" href="/api/libcuml/nightly">
        nightly (0.14)
       </a>
      </div>
     </div>
    </div>
   </div>
   <!-- end header part -->
   <!-- Generated by Doxygen 1.8.18 -->
   <script type="text/javascript">
    /* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
   </script>
   <script src="menudata.js" type="text/javascript">
   </script>
   <script src="menu.js" type="text/javascript">
   </script>
   <script type="text/javascript">
    /* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
   </script>
   <div id="main-nav">
   </div>
   <!-- window showing the filter options -->
   <div id="MSearchSelectWindow" onkeydown="return searchBox.OnSearchSelectKey(event)" onmouseout="return searchBox.OnSearchSelectHide()" onmouseover="return searchBox.OnSearchSelectShow()">
   </div>
   <!-- iframe showing the search results (closed by default) -->
   <div id="MSearchResultsWindow">
    <iframe frameborder="0" id="MSearchResults" name="MSearchResults" src="javascript:void(0)">
    </iframe>
   </div>
   <div class="navpath" id="nav-path">
    <ul>
     <li class="navelem">
      <a class="el" href="dir_315b94e79867468f41545f9cefee499a.html">
       src_prims
      </a>
     </li>
     <li class="navelem">
      <a class="el" href="dir_a43624ea61481a9a52bfdc1a5fbd9ea0.html">
       timeSeries
      </a>
     </li>
    </ul>
   </div>
  </div>
  <!-- top -->
  <div class="header">
   <div class="headertitle">
    <div class="title">
     stationarity.h
    </div>
   </div>
  </div>
  <!--header-->
  <div class="contents">
   <a href="src__prims_2timeSeries_2stationarity_8h.html">
    Go to the documentation of this file.
   </a>
   <div class="fragment">
    <div class="line">
     <a name="l00001">
     </a>
     <span class="lineno">
      1
     </span>
     <span class="comment">
      /*
     </span>
    </div>
    <div class="line">
     <a name="l00002">
     </a>
     <span class="lineno">
      2
     </span>
     <span class="comment">
      * Copyright (c) 2019, NVIDIA CORPORATION.
     </span>
    </div>
    <div class="line">
     <a name="l00003">
     </a>
     <span class="lineno">
      3
     </span>
     <span class="comment">
      *
     </span>
    </div>
    <div class="line">
     <a name="l00004">
     </a>
     <span class="lineno">
      4
     </span>
     <span class="comment">
      * Licensed under the Apache License, Version 2.0 (the "License");
     </span>
    </div>
    <div class="line">
     <a name="l00005">
     </a>
     <span class="lineno">
      5
     </span>
     <span class="comment">
      * you may not use this file except in compliance with the License.
     </span>
    </div>
    <div class="line">
     <a name="l00006">
     </a>
     <span class="lineno">
      6
     </span>
     <span class="comment">
      * You may obtain a copy of the License at
     </span>
    </div>
    <div class="line">
     <a name="l00007">
     </a>
     <span class="lineno">
      7
     </span>
     <span class="comment">
      *
     </span>
    </div>
    <div class="line">
     <a name="l00008">
     </a>
     <span class="lineno">
      8
     </span>
     <span class="comment">
      *     http://www.apache.org/licenses/LICENSE-2.0
     </span>
    </div>
    <div class="line">
     <a name="l00009">
     </a>
     <span class="lineno">
      9
     </span>
     <span class="comment">
      *
     </span>
    </div>
    <div class="line">
     <a name="l00010">
     </a>
     <span class="lineno">
      10
     </span>
     <span class="comment">
      * Unless required by applicable law or agreed to in writing, software
     </span>
    </div>
    <div class="line">
     <a name="l00011">
     </a>
     <span class="lineno">
      11
     </span>
     <span class="comment">
      * distributed under the License is distributed on an "AS IS" BASIS,
     </span>
    </div>
    <div class="line">
     <a name="l00012">
     </a>
     <span class="lineno">
      12
     </span>
     <span class="comment">
      * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     </span>
    </div>
    <div class="line">
     <a name="l00013">
     </a>
     <span class="lineno">
      13
     </span>
     <span class="comment">
      * See the License for the specific language governing permissions and
     </span>
    </div>
    <div class="line">
     <a name="l00014">
     </a>
     <span class="lineno">
      14
     </span>
     <span class="comment">
      * limitations under the License.
     </span>
    </div>
    <div class="line">
     <a name="l00015">
     </a>
     <span class="lineno">
      15
     </span>
     <span class="comment">
      */
     </span>
    </div>
    <div class="line">
     <a name="l00025">
     </a>
     <span class="lineno">
      25
     </span>
     <span class="preprocessor">
      #include &lt;
      <a class="code" href="math_8h.html">
       math.h
      </a>
      &gt;
     </span>
    </div>
    <div class="line">
     <a name="l00026">
     </a>
     <span class="lineno">
      26
     </span>
     <span class="preprocessor">
      #include &lt;thrust/device_ptr.h&gt;
     </span>
    </div>
    <div class="line">
     <a name="l00027">
     </a>
     <span class="lineno">
      27
     </span>
     <span class="preprocessor">
      #include &lt;thrust/execution_policy.h&gt;
     </span>
    </div>
    <div class="line">
     <a name="l00028">
     </a>
     <span class="lineno">
      28
     </span>
     <span class="preprocessor">
      #include &lt;thrust/iterator/counting_iterator.h&gt;
     </span>
    </div>
    <div class="line">
     <a name="l00029">
     </a>
     <span class="lineno">
      29
     </span>
     <span class="preprocessor">
      #include &lt;thrust/iterator/transform_iterator.h&gt;
     </span>
    </div>
    <div class="line">
     <a name="l00030">
     </a>
     <span class="lineno">
      30
     </span>
     <span class="preprocessor">
      #include &lt;thrust/scan.h&gt;
     </span>
    </div>
    <div class="line">
     <a name="l00031">
     </a>
     <span class="lineno">
      31
     </span>
     <span class="preprocessor">
      #include &lt;vector&gt;
     </span>
    </div>
    <div class="line">
     <a name="l00032">
     </a>
     <span class="lineno">
      32
     </span>
    </div>
    <div class="line">
     <a name="l00033">
     </a>
     <span class="lineno">
      33
     </span>
     <span class="preprocessor">
      #include &lt;
      <a class="code" href="cudart__utils_8h.html">
       common/cudart_utils.h
      </a>
      &gt;
     </span>
    </div>
    <div class="line">
     <a name="l00034">
     </a>
     <span class="lineno">
      34
     </span>
     <span class="preprocessor">
      #include "
      <a class="code" href="cuml__allocator_8hpp.html">
       cuml/common/cuml_allocator.hpp
      </a>
      "
     </span>
    </div>
    <div class="line">
     <a name="l00035">
     </a>
     <span class="lineno">
      35
     </span>
     <span class="preprocessor">
      #include "
      <a class="code" href="cublas__wrappers_8h.html">
       linalg/cublas_wrappers.h
      </a>
      "
     </span>
    </div>
    <div class="line">
     <a name="l00036">
     </a>
     <span class="lineno">
      36
     </span>
     <span class="preprocessor">
      #include "
      <a class="code" href="matrix__vector__op_8h.html">
       linalg/matrix_vector_op.h
      </a>
      "
     </span>
    </div>
    <div class="line">
     <a name="l00037">
     </a>
     <span class="lineno">
      37
     </span>
     <span class="preprocessor">
      #include "
      <a class="code" href="reduce_8h.html">
       linalg/reduce.h
      </a>
      "
     </span>
    </div>
    <div class="line">
     <a name="l00038">
     </a>
     <span class="lineno">
      38
     </span>
     <span class="preprocessor">
      #include "
      <a class="code" href="mean_8h.html">
       stats/mean.h
      </a>
      "
     </span>
    </div>
    <div class="line">
     <a name="l00039">
     </a>
     <span class="lineno">
      39
     </span>
    </div>
    <div class="line">
     <a name="l00040">
     </a>
     <span class="lineno">
      40
     </span>
     <span class="keyword">
      namespace
     </span>
     <a class="code" href="namespaceMLCommon.html">
      MLCommon
     </a>
     {
    </div>
    <div class="line">
     <a name="l00041">
     </a>
     <span class="lineno">
      41
     </span>
    </div>
    <div class="line">
     <a name="l00042">
     </a>
     <span class="lineno">
      42
     </span>
     <span class="keyword">
      namespace
     </span>
     TimeSeries {
    </div>
    <div class="line">
     <a name="l00043">
     </a>
     <span class="lineno">
      43
     </span>
    </div>
    <div class="line">
     <a name="l00052">
     </a>
     <span class="lineno">
      52
     </span>
     <span class="keyword">
      template
     </span>
     &lt;
     <span class="keywordtype">
      int
     </span>
     TPB,
     <span class="keyword">
      typename
     </span>
     IdxT&gt;
    </div>
    <div class="line">
     <a name="l00053">
     </a>
     <span class="lineno">
      53
     </span>
     <span class="keyword">
      static
     </span>
     <span class="keyword">
      inline
     </span>
     dim3 choose_block_dims(IdxT n_batches) {
    </div>
    <div class="line">
     <a name="l00054">
     </a>
     <span class="lineno">
      54
     </span>
     uint tpb_y = n_batches &gt; 8 ? 4 : 1;
    </div>
    <div class="line">
     <a name="l00055">
     </a>
     <span class="lineno">
      55
     </span>
     dim3 block(TPB / tpb_y, tpb_y);
    </div>
    <div class="line">
     <a name="l00056">
     </a>
     <span class="lineno">
      56
     </span>
     <span class="keywordflow">
      return
     </span>
     block;
    </div>
    <div class="line">
     <a name="l00057">
     </a>
     <span class="lineno">
      57
     </span>
     }
    </div>
    <div class="line">
     <a name="l00058">
     </a>
     <span class="lineno">
      58
     </span>
    </div>
    <div class="line">
     <a name="l00079">
     </a>
     <span class="lineno">
      79
     </span>
     <span class="keyword">
      template
     </span>
     &lt;
     <span class="keyword">
      typename
     </span>
     DataT,
     <span class="keyword">
      typename
     </span>
     IdxT&gt;
    </div>
    <div class="line">
     <a name="l00080">
     </a>
     <span class="lineno">
      80
     </span>
     <span class="keyword">
      static
     </span>
     __global__
     <span class="keywordtype">
      void
     </span>
     gather_diff_kernel(DataT*
     <a class="code" href="namespaceML_1_1TSNE.html#a09fbcb069dfe61f730321699cfb9ebe7">
      diff
     </a>
     ,
     <span class="keyword">
      const
     </span>
     DataT* data,
    </div>
    <div class="line">
     <a name="l00081">
     </a>
     <span class="lineno">
      81
     </span>
     IdxT* gather_map, IdxT n_diff_batches,
    </div>
    <div class="line">
     <a name="l00082">
     </a>
     <span class="lineno">
      82
     </span>
     IdxT n_diff_samples) {
    </div>
    <div class="line">
     <a name="l00083">
     </a>
     <span class="lineno">
      83
     </span>
     IdxT sample_idx = blockIdx.x * blockDim.x + threadIdx.x;
    </div>
    <div class="line">
     <a name="l00084">
     </a>
     <span class="lineno">
      84
     </span>
     IdxT batch_idx = blockIdx.y * blockDim.y + threadIdx.y;
    </div>
    <div class="line">
     <a name="l00085">
     </a>
     <span class="lineno">
      85
     </span>
    </div>
    <div class="line">
     <a name="l00086">
     </a>
     <span class="lineno">
      86
     </span>
     <span class="keywordflow">
      if
     </span>
     (batch_idx &lt; n_diff_batches &amp;&amp; sample_idx &lt; n_diff_samples) {
    </div>
    <div class="line">
     <a name="l00087">
     </a>
     <span class="lineno">
      87
     </span>
     IdxT source_batch_idx = gather_map[batch_idx];
    </div>
    <div class="line">
     <a name="l00088">
     </a>
     <span class="lineno">
      88
     </span>
     IdxT source_location = source_batch_idx * (n_diff_samples + 1) + sample_idx;
    </div>
    <div class="line">
     <a name="l00089">
     </a>
     <span class="lineno">
      89
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a09fbcb069dfe61f730321699cfb9ebe7">
      diff
     </a>
     [batch_idx * n_diff_samples + sample_idx] =
    </div>
    <div class="line">
     <a name="l00090">
     </a>
     <span class="lineno">
      90
     </span>
     data[source_location + 1] - data[source_location];
    </div>
    <div class="line">
     <a name="l00091">
     </a>
     <span class="lineno">
      91
     </span>
     }
    </div>
    <div class="line">
     <a name="l00092">
     </a>
     <span class="lineno">
      92
     </span>
     }
    </div>
    <div class="line">
     <a name="l00093">
     </a>
     <span class="lineno">
      93
     </span>
    </div>
    <div class="line">
     <a name="l00118">
     </a>
     <span class="lineno">
      118
     </span>
     <span class="keyword">
      template
     </span>
     &lt;
     <span class="keyword">
      typename
     </span>
     DataT,
     <span class="keyword">
      typename
     </span>
     IdxT&gt;
    </div>
    <div class="line">
     <a name="l00119">
     </a>
     <span class="lineno">
      119
     </span>
     <span class="keyword">
      static
     </span>
     __global__
     <span class="keywordtype">
      void
     </span>
     s2B_accumulation_kernel(DataT* accumulator,
    </div>
    <div class="line">
     <a name="l00120">
     </a>
     <span class="lineno">
      120
     </span>
     <span class="keyword">
      const
     </span>
     DataT* data, IdxT lags,
    </div>
    <div class="line">
     <a name="l00121">
     </a>
     <span class="lineno">
      121
     </span>
     IdxT n_batches, IdxT n_samples,
    </div>
    <div class="line">
     <a name="l00122">
     </a>
     <span class="lineno">
      122
     </span>
     DataT coeff_a, DataT coeff_b) {
    </div>
    <div class="line">
     <a name="l00123">
     </a>
     <span class="lineno">
      123
     </span>
     IdxT sample_idx = blockIdx.x * blockDim.x + threadIdx.x;
    </div>
    <div class="line">
     <a name="l00124">
     </a>
     <span class="lineno">
      124
     </span>
     IdxT batch_idx = blockIdx.y * blockDim.y + threadIdx.y;
    </div>
    <div class="line">
     <a name="l00125">
     </a>
     <span class="lineno">
      125
     </span>
    </div>
    <div class="line">
     <a name="l00126">
     </a>
     <span class="lineno">
      126
     </span>
     <span class="keywordflow">
      if
     </span>
     (sample_idx &lt; n_samples &amp;&amp; batch_idx &lt; n_batches) {
    </div>
    <div class="line">
     <a name="l00127">
     </a>
     <span class="lineno">
      127
     </span>
     IdxT idx = batch_idx * n_samples + sample_idx;
    </div>
    <div class="line">
     <a name="l00128">
     </a>
     <span class="lineno">
      128
     </span>
     accumulator[idx] =
     <span class="keyword">
      static_cast&lt;
     </span>
     DataT
     <span class="keyword">
      &gt;
     </span>
     (0.0);
    </div>
    <div class="line">
     <a name="l00129">
     </a>
     <span class="lineno">
      129
     </span>
     <span class="keywordflow">
      for
     </span>
     (IdxT
     <a class="code" href="namespaceML_1_1TSNE.html#afb851e919e0cd78a7c66faf65d407452">
      k
     </a>
     = 1;
     <a class="code" href="namespaceML_1_1TSNE.html#afb851e919e0cd78a7c66faf65d407452">
      k
     </a>
     &lt;= lags &amp;&amp; sample_idx &lt; n_samples -
     <a class="code" href="namespaceML_1_1TSNE.html#afb851e919e0cd78a7c66faf65d407452">
      k
     </a>
     ;
     <a class="code" href="namespaceML_1_1TSNE.html#afb851e919e0cd78a7c66faf65d407452">
      k
     </a>
     ++) {
    </div>
    <div class="line">
     <a name="l00130">
     </a>
     <span class="lineno">
      130
     </span>
     DataT dp = data[idx] * data[idx +
     <a class="code" href="namespaceML_1_1TSNE.html#afb851e919e0cd78a7c66faf65d407452">
      k
     </a>
     ];
    </div>
    <div class="line">
     <a name="l00131">
     </a>
     <span class="lineno">
      131
     </span>
     DataT coeff = coeff_a *
     <span class="keyword">
      static_cast&lt;
     </span>
     DataT
     <span class="keyword">
      &gt;
     </span>
     (
     <a class="code" href="namespaceML_1_1TSNE.html#afb851e919e0cd78a7c66faf65d407452">
      k
     </a>
     ) + coeff_b;
    </div>
    <div class="line">
     <a name="l00132">
     </a>
     <span class="lineno">
      132
     </span>
     accumulator[idx] += coeff * dp;
    </div>
    <div class="line">
     <a name="l00133">
     </a>
     <span class="lineno">
      133
     </span>
     }
    </div>
    <div class="line">
     <a name="l00134">
     </a>
     <span class="lineno">
      134
     </span>
     }
    </div>
    <div class="line">
     <a name="l00135">
     </a>
     <span class="lineno">
      135
     </span>
     }
    </div>
    <div class="line">
     <a name="l00136">
     </a>
     <span class="lineno">
      136
     </span>
    </div>
    <div class="line">
     <a name="l00154">
     </a>
     <span class="lineno">
      154
     </span>
     <span class="keyword">
      template
     </span>
     &lt;
     <span class="keyword">
      typename
     </span>
     DataT,
     <span class="keyword">
      typename
     </span>
     IdxT&gt;
    </div>
    <div class="line">
     <a name="l00155">
     </a>
     <span class="lineno">
      155
     </span>
     <span class="keyword">
      static
     </span>
     __global__
     <span class="keywordtype">
      void
     </span>
     stationarity_check_kernel(
    </div>
    <div class="line">
     <a name="l00156">
     </a>
     <span class="lineno">
      156
     </span>
     <span class="keywordtype">
      bool
     </span>
     * results,
     <span class="keyword">
      const
     </span>
     DataT* s2A,
     <span class="keyword">
      const
     </span>
     DataT* s2B,
     <span class="keyword">
      const
     </span>
     DataT* eta,
    </div>
    <div class="line">
     <a name="l00157">
     </a>
     <span class="lineno">
      157
     </span>
     IdxT n_batches, DataT n_samples_f, DataT pval_threshold) {
    </div>
    <div class="line">
     <a name="l00158">
     </a>
     <span class="lineno">
      158
     </span>
     <span class="comment">
      // Table 1, Kwiatkowski 1992
     </span>
    </div>
    <div class="line">
     <a name="l00159">
     </a>
     <span class="lineno">
      159
     </span>
     <span class="keyword">
      const
     </span>
     DataT crit_vals[4] = {0.347, 0.463, 0.574, 0.739};
    </div>
    <div class="line">
     <a name="l00160">
     </a>
     <span class="lineno">
      160
     </span>
     <span class="keyword">
      const
     </span>
     DataT pvals[4] = {0.10, 0.05, 0.025, 0.01};
    </div>
    <div class="line">
     <a name="l00161">
     </a>
     <span class="lineno">
      161
     </span>
    </div>
    <div class="line">
     <a name="l00162">
     </a>
     <span class="lineno">
      162
     </span>
     IdxT
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     = blockIdx.x * blockDim.x + threadIdx.x;
    </div>
    <div class="line">
     <a name="l00163">
     </a>
     <span class="lineno">
      163
     </span>
    </div>
    <div class="line">
     <a name="l00164">
     </a>
     <span class="lineno">
      164
     </span>
     <span class="keywordflow">
      if
     </span>
     (
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     &lt; n_batches) {
    </div>
    <div class="line">
     <a name="l00165">
     </a>
     <span class="lineno">
      165
     </span>
     DataT s2Ai = s2A[
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     ];
    </div>
    <div class="line">
     <a name="l00166">
     </a>
     <span class="lineno">
      166
     </span>
     DataT etai = eta[
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     ];
    </div>
    <div class="line">
     <a name="l00167">
     </a>
     <span class="lineno">
      167
     </span>
     DataT s2Bi = s2B[
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     ];
    </div>
    <div class="line">
     <a name="l00168">
     </a>
     <span class="lineno">
      168
     </span>
    </div>
    <div class="line">
     <a name="l00169">
     </a>
     <span class="lineno">
      169
     </span>
     s2Ai /= n_samples_f;
    </div>
    <div class="line">
     <a name="l00170">
     </a>
     <span class="lineno">
      170
     </span>
     etai /= n_samples_f * n_samples_f;
    </div>
    <div class="line">
     <a name="l00171">
     </a>
     <span class="lineno">
      171
     </span>
    </div>
    <div class="line">
     <a name="l00172">
     </a>
     <span class="lineno">
      172
     </span>
     DataT kpss_stat = etai / (s2Ai + s2Bi);
    </div>
    <div class="line">
     <a name="l00173">
     </a>
     <span class="lineno">
      173
     </span>
    </div>
    <div class="line">
     <a name="l00174">
     </a>
     <span class="lineno">
      174
     </span>
     <span class="comment">
      // Interpolate the pvalue (y) based on the kpss stat (x)
     </span>
    </div>
    <div class="line">
     <a name="l00175">
     </a>
     <span class="lineno">
      175
     </span>
     DataT pvalue = pvals[0];
    </div>
    <div class="line">
     <a name="l00176">
     </a>
     <span class="lineno">
      176
     </span>
     <span class="preprocessor">
      #pragma unroll
     </span>
    </div>
    <div class="line">
     <a name="l00177">
     </a>
     <span class="lineno">
      177
     </span>
     <span class="keywordflow">
      for
     </span>
     (IdxT
     <a class="code" href="namespaceML_1_1TSNE.html#afb851e919e0cd78a7c66faf65d407452">
      k
     </a>
     = 0;
     <a class="code" href="namespaceML_1_1TSNE.html#afb851e919e0cd78a7c66faf65d407452">
      k
     </a>
     &lt; 3;
     <a class="code" href="namespaceML_1_1TSNE.html#afb851e919e0cd78a7c66faf65d407452">
      k
     </a>
     ++) {
    </div>
    <div class="line">
     <a name="l00178">
     </a>
     <span class="lineno">
      178
     </span>
     <span class="keywordflow">
      if
     </span>
     (kpss_stat &gt;= crit_vals[
     <a class="code" href="namespaceML_1_1TSNE.html#afb851e919e0cd78a7c66faf65d407452">
      k
     </a>
     ] &amp;&amp; kpss_stat &lt; crit_vals[
     <a class="code" href="namespaceML_1_1TSNE.html#afb851e919e0cd78a7c66faf65d407452">
      k
     </a>
     + 1]) {
    </div>
    <div class="line">
     <a name="l00179">
     </a>
     <span class="lineno">
      179
     </span>
     pvalue = pvals[
     <a class="code" href="namespaceML_1_1TSNE.html#afb851e919e0cd78a7c66faf65d407452">
      k
     </a>
     ] + (pvals[
     <a class="code" href="namespaceML_1_1TSNE.html#afb851e919e0cd78a7c66faf65d407452">
      k
     </a>
     + 1] - pvals[
     <a class="code" href="namespaceML_1_1TSNE.html#afb851e919e0cd78a7c66faf65d407452">
      k
     </a>
     ]) *
    </div>
    <div class="line">
     <a name="l00180">
     </a>
     <span class="lineno">
      180
     </span>
     (kpss_stat - crit_vals[
     <a class="code" href="namespaceML_1_1TSNE.html#afb851e919e0cd78a7c66faf65d407452">
      k
     </a>
     ]) /
    </div>
    <div class="line">
     <a name="l00181">
     </a>
     <span class="lineno">
      181
     </span>
     (crit_vals[
     <a class="code" href="namespaceML_1_1TSNE.html#afb851e919e0cd78a7c66faf65d407452">
      k
     </a>
     + 1] - crit_vals[
     <a class="code" href="namespaceML_1_1TSNE.html#afb851e919e0cd78a7c66faf65d407452">
      k
     </a>
     ]);
    </div>
    <div class="line">
     <a name="l00182">
     </a>
     <span class="lineno">
      182
     </span>
     }
    </div>
    <div class="line">
     <a name="l00183">
     </a>
     <span class="lineno">
      183
     </span>
     }
    </div>
    <div class="line">
     <a name="l00184">
     </a>
     <span class="lineno">
      184
     </span>
     <span class="keywordflow">
      if
     </span>
     (kpss_stat &gt;= crit_vals[3]) {
    </div>
    <div class="line">
     <a name="l00185">
     </a>
     <span class="lineno">
      185
     </span>
     pvalue = pvals[3];
    </div>
    <div class="line">
     <a name="l00186">
     </a>
     <span class="lineno">
      186
     </span>
     }
    </div>
    <div class="line">
     <a name="l00187">
     </a>
     <span class="lineno">
      187
     </span>
    </div>
    <div class="line">
     <a name="l00188">
     </a>
     <span class="lineno">
      188
     </span>
     <span class="comment">
      // A higher pvalue means a higher chance that the data is stationary
     </span>
    </div>
    <div class="line">
     <a name="l00189">
     </a>
     <span class="lineno">
      189
     </span>
     results[
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     ] = (pvalue &gt; pval_threshold);
    </div>
    <div class="line">
     <a name="l00190">
     </a>
     <span class="lineno">
      190
     </span>
     }
    </div>
    <div class="line">
     <a name="l00191">
     </a>
     <span class="lineno">
      191
     </span>
     }
    </div>
    <div class="line">
     <a name="l00192">
     </a>
     <span class="lineno">
      192
     </span>
    </div>
    <div class="line">
     <a name="l00193">
     </a>
     <span class="lineno">
      193
     </span>
     <span class="comment">
      /* A structure that defines a function to get the column of an element of
     </span>
    </div>
    <div class="line">
     <a name="l00194">
     </a>
     <span class="lineno">
      194
     </span>
     <span class="comment">
      * a matrix from its index. This makes possible a 2d scan with thrust.
     </span>
    </div>
    <div class="line">
     <a name="l00195">
     </a>
     <span class="lineno">
      195
     </span>
     <span class="comment">
      * Found in thrust/examples/scan_matrix_by_rows.cu
     </span>
    </div>
    <div class="line">
     <a name="l00196">
     </a>
     <span class="lineno">
      196
     </span>
     <span class="comment">
      */
     </span>
    </div>
    <div class="line">
     <a name="l00197">
     </a>
     <span class="lineno">
      197
     </span>
     <span class="keyword">
      template
     </span>
     &lt;
     <span class="keyword">
      typename
     </span>
     IdxT&gt;
    </div>
    <div class="line">
     <a name="l00198">
     </a>
     <span class="lineno">
      <a class="line" href="structMLCommon_1_1TimeSeries_1_1which__col.html">
       198
      </a>
     </span>
     <span class="keyword">
      struct
     </span>
     <a class="code" href="structMLCommon_1_1TimeSeries_1_1which__col.html">
      which_col
     </a>
     : thrust::unary_function&lt;IdxT, IdxT&gt; {
    </div>
    <div class="line">
     <a name="l00199">
     </a>
     <span class="lineno">
      <a class="line" href="structMLCommon_1_1TimeSeries_1_1which__col.html#a06d72d5abfb77245b636f176acdb9d9c">
       199
      </a>
     </span>
     IdxT
     <a class="code" href="structMLCommon_1_1TimeSeries_1_1which__col.html#a06d72d5abfb77245b636f176acdb9d9c">
      col_length
     </a>
     ;
    </div>
    <div class="line">
     <a name="l00200">
     </a>
     <span class="lineno">
      <a class="line" href="structMLCommon_1_1TimeSeries_1_1which__col.html#a3c3073bb111e38f693ab5399149093d6">
       200
      </a>
     </span>
     __host__ __device__
     <a class="code" href="structMLCommon_1_1TimeSeries_1_1which__col.html#a3c3073bb111e38f693ab5399149093d6">
      which_col
     </a>
     (IdxT col_length_) :
     <a class="code" href="structMLCommon_1_1TimeSeries_1_1which__col.html#a06d72d5abfb77245b636f176acdb9d9c">
      col_length
     </a>
     (col_length_) {}
    </div>
    <div class="line">
     <a name="l00201">
     </a>
     <span class="lineno">
      <a class="line" href="structMLCommon_1_1TimeSeries_1_1which__col.html#a00ffb83ec33f3a497b5380a5bd1da889">
       201
      </a>
     </span>
     __host__ __device__ IdxT
     <a class="code" href="structMLCommon_1_1TimeSeries_1_1which__col.html#a00ffb83ec33f3a497b5380a5bd1da889">
      operator()
     </a>
     (IdxT idx)
     <span class="keyword">
      const
     </span>
     {
    </div>
    <div class="line">
     <a name="l00202">
     </a>
     <span class="lineno">
      202
     </span>
     <span class="keywordflow">
      return
     </span>
     idx /
     <a class="code" href="structMLCommon_1_1TimeSeries_1_1which__col.html#a06d72d5abfb77245b636f176acdb9d9c">
      col_length
     </a>
     ;
    </div>
    <div class="line">
     <a name="l00203">
     </a>
     <span class="lineno">
      203
     </span>
     }
    </div>
    <div class="line">
     <a name="l00204">
     </a>
     <span class="lineno">
      204
     </span>
     };
    </div>
    <div class="line">
     <a name="l00205">
     </a>
     <span class="lineno">
      205
     </span>
    </div>
    <div class="line">
     <a name="l00228">
     </a>
     <span class="lineno">
      228
     </span>
     <span class="keyword">
      template
     </span>
     &lt;
     <span class="keyword">
      typename
     </span>
     DataT,
     <span class="keyword">
      typename
     </span>
     IdxT&gt;
    </div>
    <div class="line">
     <a name="l00229">
     </a>
     <span class="lineno">
      229
     </span>
     <span class="keyword">
      static
     </span>
     <span class="keywordtype">
      void
     </span>
     _is_stationary(
     <span class="keyword">
      const
     </span>
     DataT* y_d,
     <span class="keywordtype">
      bool
     </span>
     * results, IdxT n_batches,
    </div>
    <div class="line">
     <a name="l00230">
     </a>
     <span class="lineno">
      230
     </span>
     IdxT n_samples,
    </div>
    <div class="line">
     <a name="l00231">
     </a>
     <span class="lineno">
      231
     </span>
     std::shared_ptr&lt;MLCommon::deviceAllocator&gt; allocator,
    </div>
    <div class="line">
     <a name="l00232">
     </a>
     <span class="lineno">
      232
     </span>
     cudaStream_t stream, DataT pval_threshold) {
    </div>
    <div class="line">
     <a name="l00233">
     </a>
     <span class="lineno">
      233
     </span>
     constexpr
     <span class="keywordtype">
      int
     </span>
     TPB = 256;
    </div>
    <div class="line">
     <a name="l00234">
     </a>
     <span class="lineno">
      234
     </span>
     dim3 block = choose_block_dims&lt;TPB&gt;(n_batches);
    </div>
    <div class="line">
     <a name="l00235">
     </a>
     <span class="lineno">
      235
     </span>
     dim3 grid(ceildiv&lt;IdxT&gt;(n_samples, block.x),
    </div>
    <div class="line">
     <a name="l00236">
     </a>
     <span class="lineno">
      236
     </span>
     ceildiv&lt;IdxT&gt;(n_batches, block.y));
    </div>
    <div class="line">
     <a name="l00237">
     </a>
     <span class="lineno">
      237
     </span>
    </div>
    <div class="line">
     <a name="l00238">
     </a>
     <span class="lineno">
      238
     </span>
     DataT n_samples_f =
     <span class="keyword">
      static_cast&lt;
     </span>
     DataT
     <span class="keyword">
      &gt;
     </span>
     (n_samples);
    </div>
    <div class="line">
     <a name="l00239">
     </a>
     <span class="lineno">
      239
     </span>
    </div>
    <div class="line">
     <a name="l00240">
     </a>
     <span class="lineno">
      240
     </span>
     <span class="comment">
      // Compute mean
     </span>
    </div>
    <div class="line">
     <a name="l00241">
     </a>
     <span class="lineno">
      241
     </span>
     DataT* y_means_d =
    </div>
    <div class="line">
     <a name="l00242">
     </a>
     <span class="lineno">
      242
     </span>
     (DataT*)allocator-&gt;allocate(n_batches *
     <span class="keyword">
      sizeof
     </span>
     (DataT), stream);
    </div>
    <div class="line">
     <a name="l00243">
     </a>
     <span class="lineno">
      243
     </span>
     <a class="code" href="namespaceMLCommon_1_1Stats.html#a07352f1bf28e65fe883e9bb07cad8f09">
      MLCommon::Stats::mean
     </a>
     (y_means_d, y_d, n_batches, n_samples,
     <span class="keyword">
      false
     </span>
     ,
     <span class="keyword">
      false
     </span>
     ,
    </div>
    <div class="line">
     <a name="l00244">
     </a>
     <span class="lineno">
      244
     </span>
     stream);
    </div>
    <div class="line">
     <a name="l00245">
     </a>
     <span class="lineno">
      245
     </span>
    </div>
    <div class="line">
     <a name="l00246">
     </a>
     <span class="lineno">
      246
     </span>
     <span class="comment">
      // Center the data around its mean
     </span>
    </div>
    <div class="line">
     <a name="l00247">
     </a>
     <span class="lineno">
      247
     </span>
     DataT* y_cent_d =
    </div>
    <div class="line">
     <a name="l00248">
     </a>
     <span class="lineno">
      248
     </span>
     (DataT*)allocator-&gt;allocate(n_batches * n_samples *
     <span class="keyword">
      sizeof
     </span>
     (DataT), stream);
    </div>
    <div class="line">
     <a name="l00249">
     </a>
     <span class="lineno">
      249
     </span>
     <a class="code" href="namespaceMLCommon_1_1LinAlg.html#afca6568e4de0e065f4ad1ccf8dbd2dad">
      MLCommon::LinAlg::matrixVectorOp
     </a>
     (
    </div>
    <div class="line">
     <a name="l00250">
     </a>
     <span class="lineno">
      250
     </span>
     y_cent_d, y_d, y_means_d, n_batches, n_samples,
     <span class="keyword">
      false
     </span>
     ,
     <span class="keyword">
      true
     </span>
     ,
    </div>
    <div class="line">
     <a name="l00251">
     </a>
     <span class="lineno">
      251
     </span>
     [] __device__(DataT a, DataT b) {
     <span class="keywordflow">
      return
     </span>
     a - b; }, stream);
    </div>
    <div class="line">
     <a name="l00252">
     </a>
     <span class="lineno">
      252
     </span>
    </div>
    <div class="line">
     <a name="l00253">
     </a>
     <span class="lineno">
      253
     </span>
     <span class="comment">
      // This calculates the first sum in eq. 10 (first part of s^2)
     </span>
    </div>
    <div class="line">
     <a name="l00254">
     </a>
     <span class="lineno">
      254
     </span>
     DataT* s2A_d = (DataT*)allocator-&gt;allocate(n_batches *
     <span class="keyword">
      sizeof
     </span>
     (DataT), stream);
    </div>
    <div class="line">
     <a name="l00255">
     </a>
     <span class="lineno">
      255
     </span>
     <a class="code" href="namespaceMLCommon_1_1LinAlg.html#a571fa35d10b1e7f59e00f56fbfdd64ee">
      MLCommon::LinAlg::reduce
     </a>
     (s2A_d, y_cent_d, n_batches, n_samples,
    </div>
    <div class="line">
     <a name="l00256">
     </a>
     <span class="lineno">
      256
     </span>
     <span class="keyword">
      static_cast&lt;
     </span>
     DataT
     <span class="keyword">
      &gt;
     </span>
     (0.0),
     <span class="keyword">
      false
     </span>
     ,
     <span class="keyword">
      false
     </span>
     , stream,
     <span class="keyword">
      false
     </span>
     ,
    </div>
    <div class="line">
     <a name="l00257">
     </a>
     <span class="lineno">
      257
     </span>
     L2Op&lt;DataT&gt;(), Sum&lt;DataT&gt;());
    </div>
    <div class="line">
     <a name="l00258">
     </a>
     <span class="lineno">
      258
     </span>
    </div>
    <div class="line">
     <a name="l00259">
     </a>
     <span class="lineno">
      259
     </span>
     <span class="comment">
      // From Kwiatkowski et al. referencing Schwert (1989)
     </span>
    </div>
    <div class="line">
     <a name="l00260">
     </a>
     <span class="lineno">
      260
     </span>
     DataT lags_f = ceil(12.0 * pow(n_samples_f / 100.0, 0.25));
    </div>
    <div class="line">
     <a name="l00261">
     </a>
     <span class="lineno">
      261
     </span>
     IdxT lags =
     <span class="keyword">
      static_cast&lt;
     </span>
     IdxT
     <span class="keyword">
      &gt;
     </span>
     (lags_f);
    </div>
    <div class="line">
     <a name="l00262">
     </a>
     <span class="lineno">
      262
     </span>
    </div>
    <div class="line">
     <a name="l00263">
     </a>
     <span class="lineno">
      263
     </span>
     <span class="comment">
      /* This accumulator will be used for both the calculation of s2B, and later
     </span>
    </div>
    <div class="line">
     <a name="l00264">
     </a>
     <span class="lineno">
      264
     </span>
     <span class="comment">
      * the cumulative sum or y_cent_d */
     </span>
    </div>
    <div class="line">
     <a name="l00265">
     </a>
     <span class="lineno">
      265
     </span>
     DataT* accumulator_d =
    </div>
    <div class="line">
     <a name="l00266">
     </a>
     <span class="lineno">
      266
     </span>
     (DataT*)allocator-&gt;allocate(n_batches * n_samples *
     <span class="keyword">
      sizeof
     </span>
     (DataT), stream);
    </div>
    <div class="line">
     <a name="l00267">
     </a>
     <span class="lineno">
      267
     </span>
    </div>
    <div class="line">
     <a name="l00268">
     </a>
     <span class="lineno">
      268
     </span>
     <span class="comment">
      // This calculates the second sum in eq. 10 (second part of s^2)
     </span>
    </div>
    <div class="line">
     <a name="l00269">
     </a>
     <span class="lineno">
      269
     </span>
     DataT coeff_base =
     <span class="keyword">
      static_cast&lt;
     </span>
     DataT
     <span class="keyword">
      &gt;
     </span>
     (2.0) / n_samples_f;
    </div>
    <div class="line">
     <a name="l00270">
     </a>
     <span class="lineno">
      270
     </span>
     s2B_accumulation_kernel&lt;&lt;&lt;grid, block, 0, stream&gt;&gt;&gt;(
    </div>
    <div class="line">
     <a name="l00271">
     </a>
     <span class="lineno">
      271
     </span>
     accumulator_d, y_cent_d, lags, n_batches, n_samples,
    </div>
    <div class="line">
     <a name="l00272">
     </a>
     <span class="lineno">
      272
     </span>
     -coeff_base / (lags_f +
     <span class="keyword">
      static_cast&lt;
     </span>
     DataT
     <span class="keyword">
      &gt;
     </span>
     (1.0)), coeff_base);
    </div>
    <div class="line">
     <a name="l00273">
     </a>
     <span class="lineno">
      273
     </span>
     <a class="code" href="utils_8hpp.html#aeaf2b8792be9f99ad11147059ef5079d">
      CUDA_CHECK
     </a>
     (cudaPeekAtLastError());
    </div>
    <div class="line">
     <a name="l00274">
     </a>
     <span class="lineno">
      274
     </span>
     DataT* s2B_d = (DataT*)allocator-&gt;allocate(n_batches *
     <span class="keyword">
      sizeof
     </span>
     (DataT), stream);
    </div>
    <div class="line">
     <a name="l00275">
     </a>
     <span class="lineno">
      275
     </span>
     <a class="code" href="namespaceMLCommon_1_1LinAlg.html#a571fa35d10b1e7f59e00f56fbfdd64ee">
      MLCommon::LinAlg::reduce
     </a>
     (s2B_d, accumulator_d, n_batches, n_samples,
    </div>
    <div class="line">
     <a name="l00276">
     </a>
     <span class="lineno">
      276
     </span>
     <span class="keyword">
      static_cast&lt;
     </span>
     DataT
     <span class="keyword">
      &gt;
     </span>
     (0.0),
     <span class="keyword">
      false
     </span>
     ,
     <span class="keyword">
      false
     </span>
     , stream,
    </div>
    <div class="line">
     <a name="l00277">
     </a>
     <span class="lineno">
      277
     </span>
     <span class="keyword">
      false
     </span>
     );
    </div>
    <div class="line">
     <a name="l00278">
     </a>
     <span class="lineno">
      278
     </span>
    </div>
    <div class="line">
     <a name="l00279">
     </a>
     <span class="lineno">
      279
     </span>
     <span class="comment">
      // Cumulative sum (inclusive scan with + operator)
     </span>
    </div>
    <div class="line">
     <a name="l00280">
     </a>
     <span class="lineno">
      280
     </span>
     thrust::counting_iterator&lt;IdxT&gt; c_first(0);
    </div>
    <div class="line">
     <a name="l00281">
     </a>
     <span class="lineno">
      281
     </span>
     thrust::transform_iterator&lt;which_col&lt;IdxT&gt;, thrust::counting_iterator&lt;IdxT&gt;&gt;
    </div>
    <div class="line">
     <a name="l00282">
     </a>
     <span class="lineno">
      282
     </span>
     t_first(c_first, which_col&lt;IdxT&gt;(n_samples));
    </div>
    <div class="line">
     <a name="l00283">
     </a>
     <span class="lineno">
      283
     </span>
     thrust::device_ptr&lt;DataT&gt; __y_cent = thrust::device_pointer_cast(y_cent_d);
    </div>
    <div class="line">
     <a name="l00284">
     </a>
     <span class="lineno">
      284
     </span>
     thrust::device_ptr&lt;DataT&gt; __csum = thrust::device_pointer_cast(accumulator_d);
    </div>
    <div class="line">
     <a name="l00285">
     </a>
     <span class="lineno">
      285
     </span>
     thrust::inclusive_scan_by_key(thrust::cuda::par.on(stream), t_first,
    </div>
    <div class="line">
     <a name="l00286">
     </a>
     <span class="lineno">
      286
     </span>
     t_first + n_batches * n_samples, __y_cent,
    </div>
    <div class="line">
     <a name="l00287">
     </a>
     <span class="lineno">
      287
     </span>
     __csum);
    </div>
    <div class="line">
     <a name="l00288">
     </a>
     <span class="lineno">
      288
     </span>
    </div>
    <div class="line">
     <a name="l00289">
     </a>
     <span class="lineno">
      289
     </span>
     <span class="comment">
      // Eq. 11 (eta)
     </span>
    </div>
    <div class="line">
     <a name="l00290">
     </a>
     <span class="lineno">
      290
     </span>
     DataT* eta_d = (DataT*)allocator-&gt;allocate(n_batches *
     <span class="keyword">
      sizeof
     </span>
     (DataT), stream);
    </div>
    <div class="line">
     <a name="l00291">
     </a>
     <span class="lineno">
      291
     </span>
     <a class="code" href="namespaceMLCommon_1_1LinAlg.html#a571fa35d10b1e7f59e00f56fbfdd64ee">
      MLCommon::LinAlg::reduce
     </a>
     (eta_d, accumulator_d, n_batches, n_samples,
    </div>
    <div class="line">
     <a name="l00292">
     </a>
     <span class="lineno">
      292
     </span>
     <span class="keyword">
      static_cast&lt;
     </span>
     DataT
     <span class="keyword">
      &gt;
     </span>
     (0.0),
     <span class="keyword">
      false
     </span>
     ,
     <span class="keyword">
      false
     </span>
     , stream,
     <span class="keyword">
      false
     </span>
     ,
    </div>
    <div class="line">
     <a name="l00293">
     </a>
     <span class="lineno">
      293
     </span>
     L2Op&lt;DataT&gt;(), Sum&lt;DataT&gt;());
    </div>
    <div class="line">
     <a name="l00294">
     </a>
     <span class="lineno">
      294
     </span>
    </div>
    <div class="line">
     <a name="l00295">
     </a>
     <span class="lineno">
      295
     </span>
     <span class="comment">
      /* The following kernel will decide whether each series is stationary based on
     </span>
    </div>
    <div class="line">
     <a name="l00296">
     </a>
     <span class="lineno">
      296
     </span>
     <span class="comment">
      * s^2 and eta */
     </span>
    </div>
    <div class="line">
     <a name="l00297">
     </a>
     <span class="lineno">
      297
     </span>
     <span class="keywordtype">
      bool
     </span>
     * results_d =
    </div>
    <div class="line">
     <a name="l00298">
     </a>
     <span class="lineno">
      298
     </span>
     (
     <span class="keywordtype">
      bool
     </span>
     *)allocator-&gt;allocate(n_batches *
     <span class="keyword">
      sizeof
     </span>
     (
     <span class="keywordtype">
      bool
     </span>
     ), stream);
    </div>
    <div class="line">
     <a name="l00299">
     </a>
     <span class="lineno">
      299
     </span>
     stationarity_check_kernel&lt;&lt;&lt;ceildiv&lt;int&gt;(n_batches, TPB), TPB, 0, stream&gt;&gt;&gt;(
    </div>
    <div class="line">
     <a name="l00300">
     </a>
     <span class="lineno">
      300
     </span>
     results_d, s2A_d, s2B_d, eta_d, n_batches, n_samples_f, pval_threshold);
    </div>
    <div class="line">
     <a name="l00301">
     </a>
     <span class="lineno">
      301
     </span>
     <a class="code" href="utils_8hpp.html#aeaf2b8792be9f99ad11147059ef5079d">
      CUDA_CHECK
     </a>
     (cudaPeekAtLastError());
    </div>
    <div class="line">
     <a name="l00302">
     </a>
     <span class="lineno">
      302
     </span>
    </div>
    <div class="line">
     <a name="l00303">
     </a>
     <span class="lineno">
      303
     </span>
     <a class="code" href="group__Copy.html#ga9c1498ebc5825f9e63a9de94ced042d5">
      MLCommon::updateHost
     </a>
     (results, results_d, n_batches, stream);
    </div>
    <div class="line">
     <a name="l00304">
     </a>
     <span class="lineno">
      304
     </span>
     <a class="code" href="utils_8hpp.html#aeaf2b8792be9f99ad11147059ef5079d">
      CUDA_CHECK
     </a>
     (cudaStreamSynchronize(stream));
    </div>
    <div class="line">
     <a name="l00305">
     </a>
     <span class="lineno">
      305
     </span>
    </div>
    <div class="line">
     <a name="l00306">
     </a>
     <span class="lineno">
      306
     </span>
     <span class="comment">
      /* Free device memory */
     </span>
    </div>
    <div class="line">
     <a name="l00307">
     </a>
     <span class="lineno">
      307
     </span>
     allocator-&gt;deallocate(y_means_d, n_batches *
     <span class="keyword">
      sizeof
     </span>
     (DataT), stream);
    </div>
    <div class="line">
     <a name="l00308">
     </a>
     <span class="lineno">
      308
     </span>
     allocator-&gt;deallocate(y_cent_d, n_batches * n_samples *
     <span class="keyword">
      sizeof
     </span>
     (DataT),
    </div>
    <div class="line">
     <a name="l00309">
     </a>
     <span class="lineno">
      309
     </span>
     stream);
    </div>
    <div class="line">
     <a name="l00310">
     </a>
     <span class="lineno">
      310
     </span>
     allocator-&gt;deallocate(accumulator_d, n_batches * n_samples *
     <span class="keyword">
      sizeof
     </span>
     (DataT),
    </div>
    <div class="line">
     <a name="l00311">
     </a>
     <span class="lineno">
      311
     </span>
     stream);
    </div>
    <div class="line">
     <a name="l00312">
     </a>
     <span class="lineno">
      312
     </span>
     allocator-&gt;deallocate(eta_d, n_batches *
     <span class="keyword">
      sizeof
     </span>
     (DataT), stream);
    </div>
    <div class="line">
     <a name="l00313">
     </a>
     <span class="lineno">
      313
     </span>
     allocator-&gt;deallocate(s2A_d, n_batches *
     <span class="keyword">
      sizeof
     </span>
     (DataT), stream);
    </div>
    <div class="line">
     <a name="l00314">
     </a>
     <span class="lineno">
      314
     </span>
     allocator-&gt;deallocate(s2B_d, n_batches *
     <span class="keyword">
      sizeof
     </span>
     (DataT), stream);
    </div>
    <div class="line">
     <a name="l00315">
     </a>
     <span class="lineno">
      315
     </span>
     allocator-&gt;deallocate(results_d, n_batches *
     <span class="keyword">
      sizeof
     </span>
     (
     <span class="keywordtype">
      bool
     </span>
     ), stream);
    </div>
    <div class="line">
     <a name="l00316">
     </a>
     <span class="lineno">
      316
     </span>
     }
    </div>
    <div class="line">
     <a name="l00317">
     </a>
     <span class="lineno">
      317
     </span>
    </div>
    <div class="line">
     <a name="l00344">
     </a>
     <span class="lineno">
      344
     </span>
     <span class="keyword">
      template
     </span>
     &lt;
     <span class="keyword">
      typename
     </span>
     DataT,
     <span class="keyword">
      typename
     </span>
     IdxT&gt;
    </div>
    <div class="line">
     <a name="l00345">
     </a>
     <span class="lineno">
      <a class="line" href="namespaceMLCommon_1_1TimeSeries.html#ac6bb47711d6c5108df7c66b4cd4b8913">
       345
      </a>
     </span>
     <span class="keywordtype">
      int
     </span>
     <a class="code" href="namespaceMLCommon_1_1TimeSeries.html#ac6bb47711d6c5108df7c66b4cd4b8913">
      stationarity
     </a>
     (
     <span class="keyword">
      const
     </span>
     DataT* y_d,
     <span class="keywordtype">
      int
     </span>
     * d, IdxT n_batches, IdxT n_samples,
    </div>
    <div class="line">
     <a name="l00346">
     </a>
     <span class="lineno">
      346
     </span>
     std::shared_ptr&lt;MLCommon::deviceAllocator&gt; allocator,
    </div>
    <div class="line">
     <a name="l00347">
     </a>
     <span class="lineno">
      347
     </span>
     cudaStream_t stream, DataT pval_threshold = 0.05) {
    </div>
    <div class="line">
     <a name="l00348">
     </a>
     <span class="lineno">
      348
     </span>
     <span class="comment">
      // Run the test for d=0
     </span>
    </div>
    <div class="line">
     <a name="l00349">
     </a>
     <span class="lineno">
      349
     </span>
     <span class="keywordtype">
      bool
     </span>
     is_statio[n_batches];
    </div>
    <div class="line">
     <a name="l00350">
     </a>
     <span class="lineno">
      350
     </span>
     _is_stationary(y_d, is_statio, n_batches, n_samples, allocator, stream,
    </div>
    <div class="line">
     <a name="l00351">
     </a>
     <span class="lineno">
      351
     </span>
     pval_threshold);
    </div>
    <div class="line">
     <a name="l00352">
     </a>
     <span class="lineno">
      352
     </span>
    </div>
    <div class="line">
     <a name="l00353">
     </a>
     <span class="lineno">
      353
     </span>
     <span class="comment">
      // Check the results
     </span>
    </div>
    <div class="line">
     <a name="l00354">
     </a>
     <span class="lineno">
      354
     </span>
     std::vector&lt;int&gt; gather_map_h;
    </div>
    <div class="line">
     <a name="l00355">
     </a>
     <span class="lineno">
      355
     </span>
     <span class="keywordflow">
      for
     </span>
     (IdxT
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     = 0;
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     &lt; n_batches;
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     ++) {
    </div>
    <div class="line">
     <a name="l00356">
     </a>
     <span class="lineno">
      356
     </span>
     <span class="keywordflow">
      if
     </span>
     (is_statio[
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     ]) {
    </div>
    <div class="line">
     <a name="l00357">
     </a>
     <span class="lineno">
      357
     </span>
     d[
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     ] = 0;
    </div>
    <div class="line">
     <a name="l00358">
     </a>
     <span class="lineno">
      358
     </span>
     }
     <span class="keywordflow">
      else
     </span>
     {
    </div>
    <div class="line">
     <a name="l00359">
     </a>
     <span class="lineno">
      359
     </span>
     gather_map_h.push_back(
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     );
    </div>
    <div class="line">
     <a name="l00360">
     </a>
     <span class="lineno">
      360
     </span>
     }
    </div>
    <div class="line">
     <a name="l00361">
     </a>
     <span class="lineno">
      361
     </span>
     }
    </div>
    <div class="line">
     <a name="l00362">
     </a>
     <span class="lineno">
      362
     </span>
    </div>
    <div class="line">
     <a name="l00363">
     </a>
     <span class="lineno">
      363
     </span>
     IdxT n_diff_batches = gather_map_h.size();
    </div>
    <div class="line">
     <a name="l00364">
     </a>
     <span class="lineno">
      364
     </span>
     <span class="keywordflow">
      if
     </span>
     (n_diff_batches == 0)
     <span class="keywordflow">
      return
     </span>
     0;
     <span class="comment">
      // All series are stationary with d=0
     </span>
    </div>
    <div class="line">
     <a name="l00365">
     </a>
     <span class="lineno">
      365
     </span>
    </div>
    <div class="line">
     <a name="l00366">
     </a>
     <span class="lineno">
      366
     </span>
     <span class="comment">
      /* Construct a matrix of the first difference of the series that failed
     </span>
    </div>
    <div class="line">
     <a name="l00367">
     </a>
     <span class="lineno">
      367
     </span>
     <span class="comment">
      the test for d=0 */
     </span>
    </div>
    <div class="line">
     <a name="l00368">
     </a>
     <span class="lineno">
      368
     </span>
     IdxT n_diff_samples = n_samples - 1;
    </div>
    <div class="line">
     <a name="l00369">
     </a>
     <span class="lineno">
      369
     </span>
     IdxT* gather_map_d =
    </div>
    <div class="line">
     <a name="l00370">
     </a>
     <span class="lineno">
      370
     </span>
     (IdxT*)allocator-&gt;allocate(n_diff_batches *
     <span class="keyword">
      sizeof
     </span>
     (
     <span class="keywordtype">
      int
     </span>
     ), stream);
    </div>
    <div class="line">
     <a name="l00371">
     </a>
     <span class="lineno">
      371
     </span>
     <a class="code" href="group__Copy.html#ga18a265a5eb16da13a51f486fe5e3acb7">
      MLCommon::updateDevice
     </a>
     (gather_map_d, gather_map_h.data(), n_diff_batches,
    </div>
    <div class="line">
     <a name="l00372">
     </a>
     <span class="lineno">
      372
     </span>
     stream);
    </div>
    <div class="line">
     <a name="l00373">
     </a>
     <span class="lineno">
      373
     </span>
     DataT* y_diff_d = (DataT*)allocator-&gt;allocate(
    </div>
    <div class="line">
     <a name="l00374">
     </a>
     <span class="lineno">
      374
     </span>
     n_diff_batches * n_diff_samples *
     <span class="keyword">
      sizeof
     </span>
     (DataT), stream);
    </div>
    <div class="line">
     <a name="l00375">
     </a>
     <span class="lineno">
      375
     </span>
    </div>
    <div class="line">
     <a name="l00376">
     </a>
     <span class="lineno">
      376
     </span>
     constexpr
     <span class="keywordtype">
      int
     </span>
     TPB = 256;
    </div>
    <div class="line">
     <a name="l00377">
     </a>
     <span class="lineno">
      377
     </span>
     dim3 block = choose_block_dims&lt;TPB&gt;(n_diff_batches);
    </div>
    <div class="line">
     <a name="l00378">
     </a>
     <span class="lineno">
      378
     </span>
     dim3 grid(ceildiv&lt;IdxT&gt;(n_diff_samples, block.x),
    </div>
    <div class="line">
     <a name="l00379">
     </a>
     <span class="lineno">
      379
     </span>
     ceildiv&lt;IdxT&gt;(n_diff_batches, block.y));
    </div>
    <div class="line">
     <a name="l00380">
     </a>
     <span class="lineno">
      380
     </span>
    </div>
    <div class="line">
     <a name="l00381">
     </a>
     <span class="lineno">
      381
     </span>
     gather_diff_kernel&lt;&lt;&lt;grid, block, 0, stream&gt;&gt;&gt;(
    </div>
    <div class="line">
     <a name="l00382">
     </a>
     <span class="lineno">
      382
     </span>
     y_diff_d, y_d, gather_map_d, n_diff_batches, n_diff_samples);
    </div>
    <div class="line">
     <a name="l00383">
     </a>
     <span class="lineno">
      383
     </span>
     <a class="code" href="utils_8hpp.html#aeaf2b8792be9f99ad11147059ef5079d">
      CUDA_CHECK
     </a>
     (cudaPeekAtLastError());
    </div>
    <div class="line">
     <a name="l00384">
     </a>
     <span class="lineno">
      384
     </span>
    </div>
    <div class="line">
     <a name="l00385">
     </a>
     <span class="lineno">
      385
     </span>
     <span class="comment">
      // Test these series with d=1
     </span>
    </div>
    <div class="line">
     <a name="l00386">
     </a>
     <span class="lineno">
      386
     </span>
     _is_stationary(y_diff_d, is_statio, n_diff_batches, n_diff_samples, allocator,
    </div>
    <div class="line">
     <a name="l00387">
     </a>
     <span class="lineno">
      387
     </span>
     stream, pval_threshold);
    </div>
    <div class="line">
     <a name="l00388">
     </a>
     <span class="lineno">
      388
     </span>
    </div>
    <div class="line">
     <a name="l00389">
     </a>
     <span class="lineno">
      389
     </span>
     <span class="comment">
      // Check the results
     </span>
    </div>
    <div class="line">
     <a name="l00390">
     </a>
     <span class="lineno">
      390
     </span>
     <span class="keywordtype">
      int
     </span>
     ret_value = 1;
    </div>
    <div class="line">
     <a name="l00391">
     </a>
     <span class="lineno">
      391
     </span>
     <span class="keywordflow">
      for
     </span>
     (
     <span class="keywordtype">
      int
     </span>
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     = 0;
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     &lt; n_diff_batches;
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     ++) {
    </div>
    <div class="line">
     <a name="l00392">
     </a>
     <span class="lineno">
      392
     </span>
     <span class="keywordflow">
      if
     </span>
     (is_statio[
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     ]) {
    </div>
    <div class="line">
     <a name="l00393">
     </a>
     <span class="lineno">
      393
     </span>
     d[gather_map_h[
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     ]] = 1;
    </div>
    <div class="line">
     <a name="l00394">
     </a>
     <span class="lineno">
      394
     </span>
     }
     <span class="keywordflow">
      else
     </span>
     {
    </div>
    <div class="line">
     <a name="l00395">
     </a>
     <span class="lineno">
      395
     </span>
     d[gather_map_h[
     <a class="code" href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
      i
     </a>
     ]] = -1;
     <span class="comment">
      // Invalid value to indicate failure
     </span>
    </div>
    <div class="line">
     <a name="l00396">
     </a>
     <span class="lineno">
      396
     </span>
     ret_value = -1;
    </div>
    <div class="line">
     <a name="l00397">
     </a>
     <span class="lineno">
      397
     </span>
     }
    </div>
    <div class="line">
     <a name="l00398">
     </a>
     <span class="lineno">
      398
     </span>
     }
    </div>
    <div class="line">
     <a name="l00399">
     </a>
     <span class="lineno">
      399
     </span>
    </div>
    <div class="line">
     <a name="l00400">
     </a>
     <span class="lineno">
      400
     </span>
     allocator-&gt;deallocate(gather_map_d, n_diff_batches *
     <span class="keyword">
      sizeof
     </span>
     (IdxT), stream);
    </div>
    <div class="line">
     <a name="l00401">
     </a>
     <span class="lineno">
      401
     </span>
     allocator-&gt;deallocate(
    </div>
    <div class="line">
     <a name="l00402">
     </a>
     <span class="lineno">
      402
     </span>
     y_diff_d, n_diff_batches * n_diff_samples *
     <span class="keyword">
      sizeof
     </span>
     (DataT), stream);
    </div>
    <div class="line">
     <a name="l00403">
     </a>
     <span class="lineno">
      403
     </span>
    </div>
    <div class="line">
     <a name="l00404">
     </a>
     <span class="lineno">
      404
     </span>
     <span class="keywordflow">
      return
     </span>
     ret_value;
    </div>
    <div class="line">
     <a name="l00405">
     </a>
     <span class="lineno">
      405
     </span>
     }
    </div>
    <div class="line">
     <a name="l00406">
     </a>
     <span class="lineno">
      406
     </span>
    </div>
    <div class="line">
     <a name="l00407">
     </a>
     <span class="lineno">
      407
     </span>
     };
     <span class="comment">
      //end namespace TimeSeries
     </span>
    </div>
    <div class="line">
     <a name="l00408">
     </a>
     <span class="lineno">
      408
     </span>
     };
     <span class="comment">
      //end namespace MLCommon
     </span>
    </div>
   </div>
   <!-- fragment -->
  </div>
  <!-- contents -->
  <div class="ttc" id="anamespaceMLCommon_1_1LinAlg_html_a571fa35d10b1e7f59e00f56fbfdd64ee">
   <div class="ttname">
    <a href="namespaceMLCommon_1_1LinAlg.html#a571fa35d10b1e7f59e00f56fbfdd64ee">
     MLCommon::LinAlg::reduce
    </a>
   </div>
   <div class="ttdeci">
    __device__ void reduce(Type *out, const Type acc)
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    map_then_reduce.h:27
   </div>
  </div>
  <div class="ttc" id="anamespaceMLCommon_1_1LinAlg_html_afca6568e4de0e065f4ad1ccf8dbd2dad">
   <div class="ttname">
    <a href="namespaceMLCommon_1_1LinAlg.html#afca6568e4de0e065f4ad1ccf8dbd2dad">
     MLCommon::LinAlg::matrixVectorOp
    </a>
   </div>
   <div class="ttdeci">
    void matrixVectorOp(Type *out, const Type *matrix, const Type *vec, IdxType D, IdxType N, bool rowMajor, bool bcastAlongRows, Lambda op, cudaStream_t stream)
   </div>
   <div class="ttdoc">
    Operations for all the columns or rows with a given vector.
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    matrix_vector_op.h:91
   </div>
  </div>
  <div class="ttc" id="anamespaceML_1_1TSNE_html_a09fbcb069dfe61f730321699cfb9ebe7">
   <div class="ttname">
    <a href="namespaceML_1_1TSNE.html#a09fbcb069dfe61f730321699cfb9ebe7">
     ML::TSNE::diff
    </a>
   </div>
   <div class="ttdeci">
    const int diff
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    bh_kernels.h:544
   </div>
  </div>
  <div class="ttc" id="areduce_8h_html">
   <div class="ttname">
    <a href="reduce_8h.html">
     reduce.h
    </a>
   </div>
  </div>
  <div class="ttc" id="astructMLCommon_1_1TimeSeries_1_1which__col_html">
   <div class="ttname">
    <a href="structMLCommon_1_1TimeSeries_1_1which__col.html">
     MLCommon::TimeSeries::which_col
    </a>
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    stationarity.h:198
   </div>
  </div>
  <div class="ttc" id="amatrix__vector__op_8h_html">
   <div class="ttname">
    <a href="matrix__vector__op_8h.html">
     matrix_vector_op.h
    </a>
   </div>
  </div>
  <div class="ttc" id="anamespaceML_1_1TSNE_html_a795c41c3f064d2e2b9a449d805cd4161">
   <div class="ttname">
    <a href="namespaceML_1_1TSNE.html#a795c41c3f064d2e2b9a449d805cd4161">
     ML::TSNE::i
    </a>
   </div>
   <div class="ttdeci">
    const int i
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    bh_kernels.h:94
   </div>
  </div>
  <div class="ttc" id="astructMLCommon_1_1TimeSeries_1_1which__col_html_a00ffb83ec33f3a497b5380a5bd1da889">
   <div class="ttname">
    <a href="structMLCommon_1_1TimeSeries_1_1which__col.html#a00ffb83ec33f3a497b5380a5bd1da889">
     MLCommon::TimeSeries::which_col::operator()
    </a>
   </div>
   <div class="ttdeci">
    __host__ __device__ IdxT operator()(IdxT idx) const
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    stationarity.h:201
   </div>
  </div>
  <div class="ttc" id="amath_8h_html">
   <div class="ttname">
    <a href="math_8h.html">
     math.h
    </a>
   </div>
  </div>
  <div class="ttc" id="agroup__Copy_html_ga18a265a5eb16da13a51f486fe5e3acb7">
   <div class="ttname">
    <a href="group__Copy.html#ga18a265a5eb16da13a51f486fe5e3acb7">
     MLCommon::updateDevice
    </a>
   </div>
   <div class="ttdeci">
    void updateDevice(Type *dPtr, const Type *hPtr, size_t len, cudaStream_t stream)
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    cudart_utils.h:67
   </div>
  </div>
  <div class="ttc" id="agroup__Copy_html_ga9c1498ebc5825f9e63a9de94ced042d5">
   <div class="ttname">
    <a href="group__Copy.html#ga9c1498ebc5825f9e63a9de94ced042d5">
     MLCommon::updateHost
    </a>
   </div>
   <div class="ttdeci">
    void updateHost(Type *hPtr, const Type *dPtr, size_t len, cudaStream_t stream)
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    cudart_utils.h:74
   </div>
  </div>
  <div class="ttc" id="acudart__utils_8h_html">
   <div class="ttname">
    <a href="cudart__utils_8h.html">
     cudart_utils.h
    </a>
   </div>
  </div>
  <div class="ttc" id="astructMLCommon_1_1TimeSeries_1_1which__col_html_a06d72d5abfb77245b636f176acdb9d9c">
   <div class="ttname">
    <a href="structMLCommon_1_1TimeSeries_1_1which__col.html#a06d72d5abfb77245b636f176acdb9d9c">
     MLCommon::TimeSeries::which_col::col_length
    </a>
   </div>
   <div class="ttdeci">
    IdxT col_length
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    stationarity.h:199
   </div>
  </div>
  <div class="ttc" id="autils_8hpp_html_aeaf2b8792be9f99ad11147059ef5079d">
   <div class="ttname">
    <a href="utils_8hpp.html#aeaf2b8792be9f99ad11147059ef5079d">
     CUDA_CHECK
    </a>
   </div>
   <div class="ttdeci">
    #define CUDA_CHECK(call)
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    utils.hpp:99
   </div>
  </div>
  <div class="ttc" id="anamespaceMLCommon_1_1TimeSeries_html_ac6bb47711d6c5108df7c66b4cd4b8913">
   <div class="ttname">
    <a href="namespaceMLCommon_1_1TimeSeries.html#ac6bb47711d6c5108df7c66b4cd4b8913">
     MLCommon::TimeSeries::stationarity
    </a>
   </div>
   <div class="ttdeci">
    int stationarity(const DataT *y_d, int *d, IdxT n_batches, IdxT n_samples, std::shared_ptr&lt; MLCommon::deviceAllocator &gt; allocator, cudaStream_t stream, DataT pval_threshold=0.05)
   </div>
   <div class="ttdoc">
    Compute recommended trend parameter (d=0 or 1) for a batched series.
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    stationarity.h:345
   </div>
  </div>
  <div class="ttc" id="anamespaceML_1_1TSNE_html_afb851e919e0cd78a7c66faf65d407452">
   <div class="ttname">
    <a href="namespaceML_1_1TSNE.html#afb851e919e0cd78a7c66faf65d407452">
     ML::TSNE::k
    </a>
   </div>
   <div class="ttdeci">
    int k
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    bh_kernels.h:165
   </div>
  </div>
  <div class="ttc" id="astructMLCommon_1_1TimeSeries_1_1which__col_html_a3c3073bb111e38f693ab5399149093d6">
   <div class="ttname">
    <a href="structMLCommon_1_1TimeSeries_1_1which__col.html#a3c3073bb111e38f693ab5399149093d6">
     MLCommon::TimeSeries::which_col::which_col
    </a>
   </div>
   <div class="ttdeci">
    __host__ __device__ which_col(IdxT col_length_)
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    stationarity.h:200
   </div>
  </div>
  <div class="ttc" id="anamespaceMLCommon_1_1Stats_html_a07352f1bf28e65fe883e9bb07cad8f09">
   <div class="ttname">
    <a href="namespaceMLCommon_1_1Stats.html#a07352f1bf28e65fe883e9bb07cad8f09">
     MLCommon::Stats::mean
    </a>
   </div>
   <div class="ttdeci">
    void mean(Type *mu, const Type *data, IdxType D, IdxType N, bool sample, bool rowMajor, cudaStream_t stream)
   </div>
   <div class="ttdoc">
    Compute mean of the input matrix.
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    mean.h:82
   </div>
  </div>
  <div class="ttc" id="acublas__wrappers_8h_html">
   <div class="ttname">
    <a href="cublas__wrappers_8h.html">
     cublas_wrappers.h
    </a>
   </div>
  </div>
  <div class="ttc" id="anamespaceMLCommon_html">
   <div class="ttname">
    <a href="namespaceMLCommon.html">
     MLCommon
    </a>
   </div>
   <div class="ttdef">
    <b>
     Definition:
    </b>
    cuml_allocator.hpp:22
   </div>
  </div>
  <div class="ttc" id="acuml__allocator_8hpp_html">
   <div class="ttname">
    <a href="cuml__allocator_8hpp.html">
     cuml_allocator.hpp
    </a>
   </div>
  </div>
  <div class="ttc" id="amean_8h_html">
   <div class="ttname">
    <a href="mean_8h.html">
     mean.h
    </a>
   </div>
  </div>
  <!-- start footer part -->
  <hr class="footer"/>
  <address class="footer">
   <small>
    Generated by
    <a href="http://www.doxygen.org/index.html">
     <img alt="doxygen" class="footer" src="doxygen.png"/>
    </a>
    1.8.18
   </small>
  </address>
  <script defer id="rapids-selector-js" src="/assets/js/custom.js">
  </script>
 </body>
</html>
