
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Multi-GPU with Dask-cuDF &#8212; cudf 22.08.00 documentation</title>
<script>
  document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
  document.documentElement.dataset.theme = localStorage.getItem("theme") || "light"
</script>

  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=92025949c220c2e29695" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=92025949c220c2e29695" rel="stylesheet">


  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/params.css" />

  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=92025949c220c2e29695">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Pandas Compatibility Notes" href="PandasCompat.html" />
    <link rel="prev" title="Interoperability between cuDF and CuPy" href="cupy-interop.html" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="docsearch:language" content="en">
  </head>
  
  
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="180" data-default-mode="">
    <div class="bd-header-announcement container-fluid" id="banner">
      

    </div>

    
    <nav class="bd-header navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="bd-header__inner container-xl">

  <div id="navbar-start">
    
    
  


<a class="navbar-brand logo" href="../index.html">
  
  
  
  
    <img src="../_static/RAPIDS-logo-purple.png" class="logo__image only-light" alt="Logo image">
    <img src="../_static/RAPIDS-logo-purple.png" class="logo__image only-dark" alt="Logo image">
  
  
</a>
    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="fas fa-bars"></span>
  </button>

  
  <div id="navbar-collapsible" class=" collapse navbar-collapse">
    <div id="navbar-center" class="ml-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 current active nav-item">
 <a class="reference internal nav-link" href="index.html">
  User Guide
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../api_docs/index.html">
  API reference
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../developer_guide/index.html">
  Developer Guide
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <span id="theme-switch" class="btn btn-sm btn-outline-primary navbar-btn rounded-circle">
    <a class="theme-switch" data-mode="light"><i class="fas fa-sun"></i></a>
    <a class="theme-switch" data-mode="dark"><i class="far fa-moon"></i></a>
    <a class="theme-switch" data-mode="auto"><i class="fas fa-adjust"></i></a>
</span>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/rapidsai/cudf" rel="noopener" target="_blank" title="GitHub"><span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://twitter.com/rapidsai" rel="noopener" target="_blank" title="Twitter"><span><i class="fab fa-twitter-square"></i></span>
            <label class="sr-only">Twitter</label></a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="bd-container container-xl">
      <div class="bd-container__inner row">
          

<!-- Only show if we have sidebars configured, else just a small margin  -->
<div class="bd-sidebar-primary col-12 col-md-3 bd-sidebar">
  <div class="sidebar-start-items"><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="10min.html">
   10 Minutes to cuDF and Dask-cuDF
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="pandas-comparison.html">
   Comparison of cuDF and Pandas
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="data-types.html">
   Supported Data Types
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="io.html">
   Input / Output
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="missing-data.html">
   Working with missing data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="groupby.html">
   GroupBy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="guide-to-udfs.html">
   Overview of User Defined Functions with cuDF
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="cupy-interop.html">
   Interoperability between cuDF and CuPy
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Multi-GPU with Dask-cuDF
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="PandasCompat.html">
   Pandas Compatibility Notes
  </a>
 </li>
</ul>

  </div>
</nav>
  </div>
  <div class="sidebar-end-items">
  </div>
</div>


          


<div class="bd-sidebar-secondary d-none d-xl-block col-xl-2 bd-toc">
  
    
    <div class="toc-item">
      
<div class="tocsection onthispage mt-5 pt-1 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#what-works">
   What works
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#developing-the-api">
   Developing the API
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#navigating-the-api">
   Navigating the API
  </a>
 </li>
</ul>

</nav>
    </div>
    
    <div class="toc-item">
      
    </div>
    
  
</div>


          
          
          <div class="bd-content col-12 col-md-9 col-xl-7">
              
              <article class="bd-article" role="main">
                
  <section id="multi-gpu-with-dask-cudf">
<h1>Multi-GPU with Dask-cuDF<a class="headerlink" href="#multi-gpu-with-dask-cudf" title="Permalink to this heading">#</a></h1>
<p>cuDF is a single-GPU library. For Multi-GPU cuDF solutions we use
<a class="reference external" href="https://dask.org/">Dask</a> and the <a class="reference external" href="https://github.com/rapidsai/cudf/tree/main/python/dask_cudf">dask-cudf
package</a>,
which is able to scale cuDF across multiple GPUs on a single machine,
or multiple GPUs across many machines in a cluster.</p>
<p><a class="reference external" href="http://docs.dask.org/en/latest/dataframe.html">Dask DataFrame</a> was
originally designed to scale Pandas, orchestrating many Pandas
DataFrames spread across many CPUs into a cohesive parallel DataFrame.
Because cuDF currently implements only a subset of the Pandas API, not
all Dask DataFrame operations work with cuDF.</p>
<p>The following is tested and expected to work:</p>
<section id="what-works">
<h2>What works<a class="headerlink" href="#what-works" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p>Data ingestion</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">dask_cudf.read_csv</span></code></p></li>
<li><p>Use standard Dask ingestion with Pandas, then convert to cuDF (For
Parquet and other formats this is often decently fast)</p></li>
</ul>
</li>
<li><p>Linear operations</p>
<ul>
<li><p>Element-wise operations: <code class="docutils literal notranslate"><span class="pre">df.x</span> <span class="pre">+</span> <span class="pre">df.y</span></code>, <code class="docutils literal notranslate"><span class="pre">df</span> <span class="pre">**</span> <span class="pre">2</span></code></p></li>
<li><p>Assignment: <code class="docutils literal notranslate"><span class="pre">df['z']</span> <span class="pre">=</span> <span class="pre">df.x</span> <span class="pre">+</span> <span class="pre">df.y</span></code></p></li>
<li><p>Row-wise selections: <code class="docutils literal notranslate"><span class="pre">df[df.x</span> <span class="pre">&gt;</span> <span class="pre">0]</span></code></p></li>
<li><p>Loc: <code class="docutils literal notranslate"><span class="pre">df.loc['2001-01-01':</span> <span class="pre">'2005-02-02']</span></code></p></li>
<li><p>Date time/string accessors: <code class="docutils literal notranslate"><span class="pre">df.timestamp.dt.dayofweek</span></code></p></li>
<li><p>… and most similar operations in this category that are already
implemented in cuDF</p></li>
</ul>
</li>
<li><p>Reductions</p>
<ul>
<li><p>Like <code class="docutils literal notranslate"><span class="pre">sum</span></code>, <code class="docutils literal notranslate"><span class="pre">mean</span></code>, <code class="docutils literal notranslate"><span class="pre">max</span></code>, <code class="docutils literal notranslate"><span class="pre">count</span></code>, and so on on
<code class="docutils literal notranslate"><span class="pre">Series</span></code> objects</p></li>
<li><p>Support for reductions on full dataframes</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">std</span></code></p></li>
<li><p>Custom reductions with
<a class="reference external" href="https://docs.dask.org/en/latest/generated/dask.dataframe.Series.reduction.html">dask.dataframe.reduction</a></p></li>
</ul>
</li>
<li><p>Groupby aggregations</p>
<ul>
<li><p>On single columns: <code class="docutils literal notranslate"><span class="pre">df.groupby('x').y.max()</span></code></p></li>
<li><p>With custom aggregations:</p></li>
<li><p>groupby standard deviation</p></li>
<li><p>grouping on multiple columns</p></li>
<li><p>groupby agg for multiple outputs</p></li>
</ul>
</li>
<li><p>Joins:</p>
<ul>
<li><p>On full unsorted columns: <code class="docutils literal notranslate"><span class="pre">left.merge(right,</span> <span class="pre">on='id')</span></code>
(expensive)</p></li>
<li><p>On sorted indexes:
<code class="docutils literal notranslate"><span class="pre">left.merge(right,</span> <span class="pre">left_index=True,</span> <span class="pre">right_index=True)</span></code> (fast)</p></li>
<li><p>On large and small dataframes: <code class="docutils literal notranslate"><span class="pre">left.merge(cudf_df,</span> <span class="pre">on='id')</span></code>
(fast)</p></li>
</ul>
</li>
<li><p>Rolling operations</p></li>
<li><p>Converting to and from other forms</p>
<ul>
<li><p>Dask + Pandas to Dask + cuDF
<code class="docutils literal notranslate"><span class="pre">df.map_partitions(cudf.DataFrame.from_pandas)</span></code></p></li>
<li><p>Dask + cuDF to Dask + Pandas
<code class="docutils literal notranslate"><span class="pre">df.map_partitions(lambda</span> <span class="pre">df:</span> <span class="pre">df.to_pandas())</span></code></p></li>
<li><p>cuDF to Dask + cuDF:
<code class="docutils literal notranslate"><span class="pre">dask.dataframe.from_pandas(df,</span> <span class="pre">npartitions=20)</span></code></p></li>
<li><p>Dask + cuDF to cuDF: <code class="docutils literal notranslate"><span class="pre">df.compute()</span></code></p></li>
</ul>
</li>
</ul>
<p>Additionally all generic Dask operations, like <code class="docutils literal notranslate"><span class="pre">compute</span></code>, <code class="docutils literal notranslate"><span class="pre">persist</span></code>,
<code class="docutils literal notranslate"><span class="pre">visualize</span></code> and so on work regardless.</p>
</section>
<section id="developing-the-api">
<h2>Developing the API<a class="headerlink" href="#developing-the-api" title="Permalink to this heading">#</a></h2>
<p>Above we mention the following:</p>
<blockquote>
<div><p>and most similar operations in this category that are already
implemented in cuDF</p>
</div></blockquote>
<p>This is because it is difficult to create a comprehensive list of
operations in the cuDF and Pandas libraries. The API is large enough to
be difficult to track effectively. For any operation that operates
row-wise like <code class="docutils literal notranslate"><span class="pre">fillna</span></code> or <code class="docutils literal notranslate"><span class="pre">query</span></code> things will likely, but not
certainly work. If operations don’t work it is often due to a slight
inconsistency between Pandas and cuDF that is generally easy to fix. We
encourage users to look at the <a class="reference external" href="https://github.com/rapidsai/cudf/issues">cuDF issue
tracker</a> to see if their
issue has already been reported and, if not, <a class="reference external" href="https://github.com/rapidsai/cudf/issues/new">raise a new
issue</a>.</p>
</section>
<section id="navigating-the-api">
<h2>Navigating the API<a class="headerlink" href="#navigating-the-api" title="Permalink to this heading">#</a></h2>
<p>This project reuses the <a class="reference external" href="https://docs.dask.org/en/latest/dataframe.html">Dask
DataFrame</a> project,
which was originally designed for Pandas, with the newer library cuDF.
Because we use the same Dask classes for both projects there are often
methods that are implemented for Pandas, but not yet for cuDF. As a
result users looking at the full Dask DataFrame API can be misleading,
and often lead to frustration when operations that are advertised in the
Dask API do not work as expected with cuDF. We apologize for this in
advance.</p>
</section>
</section>


              </article>
              

              
              <footer class="bd-footer-article">
                  <!-- Previous / next buttons -->
<div class='prev-next-area'>
  <a class='left-prev' id="prev-link" href="cupy-interop.html" title="previous page">
      <i class="fas fa-angle-left"></i>
      <div class="prev-next-info">
          <p class="prev-next-subtitle">previous</p>
          <p class="prev-next-title">Interoperability between cuDF and CuPy</p>
      </div>
  </a>
  <a class='right-next' id="next-link" href="PandasCompat.html" title="next page">
  <div class="prev-next-info">
      <p class="prev-next-subtitle">next</p>
      <p class="prev-next-title">Pandas Compatibility Notes</p>
  </div>
  <i class="fas fa-angle-right"></i>
  </a>
</div>
              </footer>
              
          </div>
          
      </div>
    </div>

  
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=92025949c220c2e29695"></script>

<footer class="bd-footer"><div class="bd-footer__inner container">
  
  <div class="footer-item">
    <p class="copyright">
    &copy; Copyright 2018-2021, NVIDIA.<br>
</p>
  </div>
  
  <div class="footer-item">
    <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 5.0.2.<br>
</p>
  </div>
  
</div>
</footer>
  </body>
</html>