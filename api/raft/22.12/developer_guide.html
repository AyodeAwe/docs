<!DOCTYPE html>
<html class="writer-html5" lang="en"><head>
  <meta charset="utf-8"><meta content="Docutils 0.17.1: http://docutils.sourceforge.net/" name="generator">

  <meta content="width=device-width, initial-scale=1.0" name="viewport">
  <title>Developer Guide &mdash; raft 22.12.00 documentation</title>
      <link href="_static/pygments.css" rel="stylesheet" type="text/css">
      <link href="_static/css/theme.css" rel="stylesheet" type="text/css">
      <link href="_static/copybutton.css" rel="stylesheet" type="text/css">
      <link href="_static/infoboxes.css" rel="stylesheet" type="text/css">
      <link href="_static/references.css" rel="stylesheet" type="text/css">
      <link href="https://docs.rapids.ai/assets/css/custom.css" rel="stylesheet" type="text/css">
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
        <script defer="defer" src="https://docs.rapids.ai/assets/js/custom.js"></script>
        <script src="_static/example_mod.js"></script>
    <script src="_static/js/theme.js"></script>
    <link href="genindex.html" rel="index" title="Index">
    <link href="search.html" rel="search" title="Search">
    <link href="cpp_api.html" rel="next" title="C++ API Reference">
    <link href="build.html" rel="prev" title="Install Guide"> 
<script id="rapids-selector-pixel-src" src="https://assets.adobedtm.com/5d4962a43b79/814eb6e9b4e1/launch-4bc07f1e0b0b.min.js"></script><link href="/assets/css/custom.css" id="rapids-selector-css" rel="stylesheet"></head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav class="wy-nav-side" data-toggle="wy-nav-shift">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"><div id="rapids-jtd-container"><div class="rapids-home-container"><a class="rapids-home-container__home-btn" href="/api">Home</a></div><div class="rapids-selector__container rapids-selector--hidden"><div class="rapids-selector__selected">raft</div><div class="rapids-selector__menu"><a class="rapids-selector__menu-item" href="/api/clx/stable/api.html">clx</a><a class="rapids-selector__menu-item" href="/api/cucim/stable/api.html">cucim</a><a class="rapids-selector__menu-item" href="/api/cudf/stable/index.html">cudf</a><a class="rapids-selector__menu-item" href="/api/cudf-java/stable">cudf-java</a><a class="rapids-selector__menu-item" href="/api/cugraph/stable">cugraph</a><a class="rapids-selector__menu-item" href="/api/cuml/stable/api.html">cuml</a><a class="rapids-selector__menu-item" href="/api/cusignal/stable/api.html">cusignal</a><a class="rapids-selector__menu-item" href="/api/cuspatial/stable">cuspatial</a><a class="rapids-selector__menu-item" href="/api/cuxfilter/stable">cuxfilter</a><a class="rapids-selector__menu-item" href="/api/dask-cuda/stable/api.html">dask-cuda</a><a class="rapids-selector__menu-item" href="/api/kvikio/stable/api.html">kvikio</a><a class="rapids-selector__menu-item" href="/api/libcudf/stable/namespacecudf.html">libcudf</a><a class="rapids-selector__menu-item" href="/api/libcugraph/stable">libcugraph</a><a class="rapids-selector__menu-item" href="/api/libcuml/stable">libcuml</a><a class="rapids-selector__menu-item" href="/api/libcuspatial/stable">libcuspatial</a><a class="rapids-selector__menu-item" href="/api/libkvikio/stable">libkvikio</a><a class="rapids-selector__menu-item" href="/api/librmm/stable/annotated.html">librmm</a><a class="rapids-selector__menu-item rapids-selector__menu-item--selected" href="/api/raft/stable">raft</a><a class="rapids-selector__menu-item" href="/api/rapids-cmake/stable/api.html">rapids-cmake</a><a class="rapids-selector__menu-item" href="/api/rmm/stable/api.html">rmm</a></div></div><div class="rapids-selector__container rapids-selector--hidden"><div class="rapids-selector__selected">nightly (22.12)</div><div class="rapids-selector__menu"><a class="rapids-selector__menu-item rapids-selector__menu-item--selected" href="/api/raft/nightly">nightly (22.12)</a><a class="rapids-selector__menu-item" href="/api/raft/stable">stable (22.10)</a><a class="rapids-selector__menu-item" href="/api/raft/legacy">legacy (22.08)</a></div></div></div>
            
              
<div role="search">
  <form action="search.html" class="wy-form" id="rtd-search-form" method="get">
    <input name="q" placeholder="Search docs" type="text">
    <input name="check_keywords" type="hidden" value="yes">
    <input name="area" type="hidden" value="default">
  </form>
</div>
        </div><div aria-label="Navigation menu" class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="quick_start.html">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="build.html">Install Guide</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Developer Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#local-development">Local Development</a></li>
<li class="toctree-l2"><a class="reference internal" href="#api-stability">API stability</a></li>
<li class="toctree-l2"><a class="reference internal" href="#common-design-considerations">Common Design Considerations</a></li>
<li class="toctree-l2"><a class="reference internal" href="#testing">Testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="#documentation">Documentation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="cpp_api.html">C++ API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="pylibraft_api.html">PyLibRAFT API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="raft_dask_api.html">RAFT Dask API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section class="wy-nav-content-wrap" data-toggle="wy-nav-shift"><nav aria-label="Mobile navigation menu" class="wy-nav-top">
          <i class="fa fa-bars" data-toggle="wy-nav-top"></i>
          <a href="index.html">raft</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div aria-label="Page navigation" role="navigation">
  <ul class="wy-breadcrumbs">
      <li><a class="icon icon-home" href="index.html"></a></li>
      <li class="breadcrumb-item active">Developer Guide</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/developer_guide.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr>
</div>
          <div class="document" itemscope="itemscope" itemtype="http://schema.org/Article" role="main">
           <div itemprop="articleBody">
             
  <section id="developer-guide">
<h1>Developer Guide<a class="headerlink" href="#developer-guide" title="Permalink to this heading">&para;</a></h1>
<section id="local-development">
<h2>Local Development<a class="headerlink" href="#local-development" title="Permalink to this heading">&para;</a></h2>
<p>Developing features and fixing bugs for the RAFT library itself is straightforward and only requires building and installing the relevant RAFT artifacts.</p>
<p>The process for working on a CUDA/C++ feature which might span RAFT and one or more consuming libraries can vary slightly depending on whether the consuming project relies on a source build (as outlined in the <a class="reference external" href="BUILD.md#install_header_only_cpp">BUILD</a> docs). In such a case, the option <code class="docutils literal notranslate"><span class="pre">CPM_raft_SOURCE=/path/to/raft/source</span></code> can be passed to the cmake of the consuming project in order to build the local RAFT from source. The PR with relevant changes to the consuming project can also pin the RAFT version temporarily by explicitly changing the <code class="docutils literal notranslate"><span class="pre">FORK</span></code> and <code class="docutils literal notranslate"><span class="pre">PINNED_TAG</span></code> arguments to the RAFT branch containing their changes when invoking <code class="docutils literal notranslate"><span class="pre">find_and_configure_raft</span></code>.  The pin should be reverted after the changed is merged to the RAFT project and before it is merged to the dependent project(s) downstream.</p>
<p>If building a feature which spans projects and not using the source build in cmake, the RAFT changes (both C++ and Python) will need to be installed into the environment of the consuming project before they can be used. The ideal integration of RAFT into consuming projects will enable both the source build in the consuming project only for this case but also rely on a more stable packaging (such as conda packaging) otherwise.</p>
</section>
<section id="api-stability">
<h2>API stability<a class="headerlink" href="#api-stability" title="Permalink to this heading">&para;</a></h2>
<p>Since RAFT is a core library with multiple consumers, it&rsquo;s important that the public APIs maintain stability across versions and any changes to them are done with caution, adding new functions and deprecating the old functions over a couple releases as necessary.</p>
<p>The public APIs should be lightweight wrappers around calls to private APIs inside the <code class="docutils literal notranslate"><span class="pre">detail</span></code> namespace.</p>
</section>
<section id="common-design-considerations">
<h2>Common Design Considerations<a class="headerlink" href="#common-design-considerations" title="Permalink to this heading">&para;</a></h2>
<ol class="simple">
<li><p>Use the <code class="docutils literal notranslate"><span class="pre">hpp</span></code> extension for files which can be compiled with <code class="docutils literal notranslate"><span class="pre">gcc</span></code> against the CUDA-runtime. Use the <code class="docutils literal notranslate"><span class="pre">cuh</span></code> extension for files which require <code class="docutils literal notranslate"><span class="pre">nvcc</span></code> to be compiled. <code class="docutils literal notranslate"><span class="pre">hpp</span></code> can also be used for functions marked <code class="docutils literal notranslate"><span class="pre">__host__</span> <span class="pre">__device__</span></code> only if proper checks are in place to remove the <code class="docutils literal notranslate"><span class="pre">__device__</span></code> designation when not compiling with <code class="docutils literal notranslate"><span class="pre">nvcc</span></code>.</p></li>
<li><p>When additional classes, structs, or general POCO types are needed to be used for representing data in the public API, place them in a new file called <code class="docutils literal notranslate"><span class="pre">&lt;primitive_name&gt;_types.hpp</span></code>. This tells users they are safe to expose these types on their own public APIs without bringing in device code. At a minimum, the definitions for these types, at least, should not require <code class="docutils literal notranslate"><span class="pre">nvcc</span></code>. In general, these classes should only store very simple state and should not perform their own computations. Instead, new functions should be exposed on the public API which accept these objects, reading or updating their state as necessary.</p></li>
<li><p>Documentation for public APIs should be well documented, easy to use, and it is highly preferred that they include usage instructions.</p></li>
<li><p>Before creating a new primitive, check to see if one exists already. If one exists but the API isn&rsquo;t flexible enough to include your use-case, consider first refactoring the existing primitive. If that is not possible without an extreme number of changes, consider how the public API could be made more flexible. If the new primitive is different enough from all existing primitives, consider whether an existing public API could invoke the new primitive as an option or argument. If the new primitive is different enough from what exists already, add a header for the new public API function to the appropriate subdirectory and namespace.</p></li>
</ol>
</section>
<section id="testing">
<h2>Testing<a class="headerlink" href="#testing" title="Permalink to this heading">&para;</a></h2>
<p>It&rsquo;s important for RAFT to maintain a high test coverage in order to minimize the potential for downstream projects to encounter unexpected build or runtime behavior as a result of changes. A well-defined public API can help maintain compile-time stability but means more focus should be placed on testing the functional requirements and verifying execution on the various edge cases within RAFT itself. Ideally, bug fixes and new features should be able to be made to RAFT independently of the consuming projects.</p>
</section>
<section id="documentation">
<h2>Documentation<a class="headerlink" href="#documentation" title="Permalink to this heading">&para;</a></h2>
<p>Public APIs always require documentation, since those will be exposed directly to users. In addition to summarizing the purpose of each class / function in the public API, the arguments (and relevant templates) should be documented along with brief usage examples.</p>
</section>
</section>


           </div>
          </div>
          <footer><div aria-label="Footer" class="rst-footer-buttons" role="navigation">
        <a accesskey="p" class="btn btn-neutral float-left" href="build.html" rel="prev" title="Install Guide"><span aria-hidden="true" class="fa fa-arrow-circle-left"></span> Previous</a>
        <a accesskey="n" class="btn btn-neutral float-right" href="cpp_api.html" rel="next" title="C++ API Reference">Next <span aria-hidden="true" class="fa fa-arrow-circle-right"></span></a>
    </div>

  <hr>

  <div role="contentinfo">
    <p>&copy; Copyright 2022, nvidia.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 


<script defer id="rapids-selector-js" src="/assets/js/custom.js"></script><script id="rapids-selector-pixel-invocation" type="text/javascript">_satellite.pageBottom();</script></body></html>