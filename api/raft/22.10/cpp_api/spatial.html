<!DOCTYPE html>
<html class="writer-html5" lang="en"><head>
  <meta charset="utf-8"><meta content="Docutils 0.17.1: http://docutils.sourceforge.net/" name="generator">

  <meta content="width=device-width, initial-scale=1.0" name="viewport">
  <title>Spatial &mdash; raft 22.10.00 documentation</title>
      <link href="../_static/pygments.css" rel="stylesheet" type="text/css">
      <link href="../_static/css/theme.css" rel="stylesheet" type="text/css">
      <link href="../_static/copybutton.css" rel="stylesheet" type="text/css">
      <link href="../_static/infoboxes.css" rel="stylesheet" type="text/css">
      <link href="../_static/references.css" rel="stylesheet" type="text/css">
      <link href="https://docs.rapids.ai/assets/css/custom.css" rel="stylesheet" type="text/css">
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script defer="defer" src="https://docs.rapids.ai/assets/js/custom.js"></script>
        <script src="../_static/example_mod.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link href="../genindex.html" rel="index" title="Index">
    <link href="../search.html" rel="search" title="Search">
    <link href="sparse.html" rel="next" title="Sparse">
    <link href="random.html" rel="prev" title="Random"> 
<script id="rapids-selector-pixel-src" src="https://assets.adobedtm.com/5d4962a43b79/814eb6e9b4e1/launch-4bc07f1e0b0b.min.js"></script><link href="/assets/css/custom.css" id="rapids-selector-css" rel="stylesheet"></head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav class="wy-nav-side" data-toggle="wy-nav-shift">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"><div id="rapids-jtd-container"><div class="rapids-home-container"><a class="rapids-home-container__home-btn" href="/api">Home</a></div><div class="rapids-selector__container rapids-selector--hidden"><div class="rapids-selector__selected">raft</div><div class="rapids-selector__menu"><a class="rapids-selector__menu-item" href="/api/clx/stable/api.html">clx</a><a class="rapids-selector__menu-item" href="/api/cucim/stable/api.html">cucim</a><a class="rapids-selector__menu-item" href="/api/cudf/stable/index.html">cudf</a><a class="rapids-selector__menu-item" href="/api/cudf-java/stable">cudf-java</a><a class="rapids-selector__menu-item" href="/api/cugraph/stable">cugraph</a><a class="rapids-selector__menu-item" href="/api/cuml/stable/api.html">cuml</a><a class="rapids-selector__menu-item" href="/api/cusignal/stable/api.html">cusignal</a><a class="rapids-selector__menu-item" href="/api/cuspatial/stable">cuspatial</a><a class="rapids-selector__menu-item" href="/api/cuxfilter/stable">cuxfilter</a><a class="rapids-selector__menu-item" href="/api/dask-cuda/stable/api.html">dask-cuda</a><a class="rapids-selector__menu-item" href="/api/kvikio/stable/api.html">kvikio</a><a class="rapids-selector__menu-item" href="/api/libcudf/stable/namespacecudf.html">libcudf</a><a class="rapids-selector__menu-item" href="/api/libcugraph/stable">libcugraph</a><a class="rapids-selector__menu-item" href="/api/libcuml/stable">libcuml</a><a class="rapids-selector__menu-item" href="/api/libcuspatial/stable">libcuspatial</a><a class="rapids-selector__menu-item" href="/api/libkvikio/stable">libkvikio</a><a class="rapids-selector__menu-item" href="/api/librmm/stable/annotated.html">librmm</a><a class="rapids-selector__menu-item rapids-selector__menu-item--selected" href="/api/raft/stable">raft</a><a class="rapids-selector__menu-item" href="/api/rapids-cmake/stable/api.html">rapids-cmake</a><a class="rapids-selector__menu-item" href="/api/rmm/stable/api.html">rmm</a></div></div><div class="rapids-selector__container rapids-selector--hidden"><div class="rapids-selector__selected">nightly (22.10)</div><div class="rapids-selector__menu"><a class="rapids-selector__menu-item rapids-selector__menu-item--selected" href="/api/raft/nightly">nightly (22.10)</a><a class="rapids-selector__menu-item" href="/api/raft/stable">stable (22.06)</a><a class="rapids-selector__menu-item" href="/api/raft/legacy">legacy (22.04)</a></div></div></div>
            
              
<div role="search">
  <form action="../search.html" class="wy-form" id="rtd-search-form" method="get">
    <input name="q" placeholder="Search docs" type="text">
    <input name="check_keywords" type="hidden" value="yes">
    <input name="area" type="hidden" value="default">
  </form>
</div>
        </div><div aria-label="Navigation menu" class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../cpp_api.html">RAFT C++ API Reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="core.html">Core</a></li>
<li class="toctree-l2"><a class="reference internal" href="clustering.html">Clustering</a></li>
<li class="toctree-l2"><a class="reference internal" href="linalg.html">Linear Algebra</a></li>
<li class="toctree-l2"><a class="reference internal" href="matrix.html">Matrix</a></li>
<li class="toctree-l2"><a class="reference internal" href="optimization.html">Optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="random.html">Random</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Spatial</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#distance">Distance</a></li>
<li class="toctree-l3"><a class="reference internal" href="#nearest-neighbors">Nearest Neighbors</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#ivf-flat">IVF-Flat</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="sparse.html">Sparse</a></li>
<li class="toctree-l2"><a class="reference internal" href="stats.html">Stats</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../pyraft_api.html">PyRAFT API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pylibraft_api.html">PyLibRAFT API Reference</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section class="wy-nav-content-wrap" data-toggle="wy-nav-shift"><nav aria-label="Mobile navigation menu" class="wy-nav-top">
          <i class="fa fa-bars" data-toggle="wy-nav-top"></i>
          <a href="../index.html">raft</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div aria-label="Page navigation" role="navigation">
  <ul class="wy-breadcrumbs">
      <li><a class="icon icon-home" href="../index.html"></a> &raquo;</li>
          <li><a href="../cpp_api.html">RAFT C++ API Reference</a> &raquo;</li>
      <li>Spatial</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/cpp_api/spatial.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr>
</div>
          <div class="document" itemscope="itemscope" itemtype="http://schema.org/Article" role="main">
           <div itemprop="articleBody">
             
  <section id="spatial">
<h1>Spatial<a class="headerlink" href="#spatial" title="Permalink to this heading">&para;</a></h1>
<p>This page provides C++ class references for the publicly-exposed elements of the spatial package.</p>
<section id="distance">
<h2>Distance<a class="headerlink" href="#distance" title="Permalink to this heading">&para;</a></h2>
<dl class="cpp type">
<dt class="sig sig-object cpp" id="_CPPv4N4raft8distanceE">
<span id="_CPPv3N4raft8distanceE"></span><span id="_CPPv2N4raft8distanceE"></span><span id="raft::distance"></span><span class="target" id="namespaceraft_1_1distance"></span><span class="k"><span class="pre">namespace</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">distance</span></span></span><a class="headerlink" href="#_CPPv4N4raft8distanceE" title="Permalink to this definition">&para;</a><br></dt>
<dd><div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-typedefs">Typedefs</p>
<dl class="cpp type">
<dt class="sig sig-object cpp" id="_CPPv4I00EN4raft8distance12KVPMinReduceE">
<span id="_CPPv3I00EN4raft8distance12KVPMinReduceE"></span><span id="_CPPv2I00EN4raft8distance12KVPMinReduceE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">LabelT</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">DataT</span></span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="namespaceraft_1_1distance_1abb6b16e8f3b34780f10c348585d388b1"></span><span class="k"><span class="pre">using</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">KVPMinReduce</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">detail</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">KVPMinReduceImpl</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I00EN4raft8distance12KVPMinReduceE" title="raft::distance::KVPMinReduce::LabelT"><span class="n"><span class="pre">LabelT</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft8distance12KVPMinReduceE" title="raft::distance::KVPMinReduce::DataT"><span class="n"><span class="pre">DataT</span></span></a><span class="p"><span class="pre">&gt;</span></span><a class="headerlink" href="#_CPPv4I00EN4raft8distance12KVPMinReduceE" title="Permalink to this definition">&para;</a><br></dt>
<dd></dd></dl>

<dl class="cpp type">
<dt class="sig sig-object cpp" id="_CPPv4I00EN4raft8distance22MinAndDistanceReduceOpE">
<span id="_CPPv3I00EN4raft8distance22MinAndDistanceReduceOpE"></span><span id="_CPPv2I00EN4raft8distance22MinAndDistanceReduceOpE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">LabelT</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">DataT</span></span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="namespaceraft_1_1distance_1a5d7c5661704344e7be1908bef409e6f8"></span><span class="k"><span class="pre">using</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">MinAndDistanceReduceOp</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">detail</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">MinAndDistanceReduceOpImpl</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I00EN4raft8distance22MinAndDistanceReduceOpE" title="raft::distance::MinAndDistanceReduceOp::LabelT"><span class="n"><span class="pre">LabelT</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft8distance22MinAndDistanceReduceOpE" title="raft::distance::MinAndDistanceReduceOp::DataT"><span class="n"><span class="pre">DataT</span></span></a><span class="p"><span class="pre">&gt;</span></span><a class="headerlink" href="#_CPPv4I00EN4raft8distance22MinAndDistanceReduceOpE" title="Permalink to this definition">&para;</a><br></dt>
<dd></dd></dl>

<dl class="cpp type">
<dt class="sig sig-object cpp" id="_CPPv4I00EN4raft8distance11MinReduceOpE">
<span id="_CPPv3I00EN4raft8distance11MinReduceOpE"></span><span id="_CPPv2I00EN4raft8distance11MinReduceOpE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">LabelT</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">DataT</span></span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="namespaceraft_1_1distance_1ad2c23feb7a46f9f23815ca81fbf234f2"></span><span class="k"><span class="pre">using</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">MinReduceOp</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">detail</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">MinReduceOpImpl</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I00EN4raft8distance11MinReduceOpE" title="raft::distance::MinReduceOp::LabelT"><span class="n"><span class="pre">LabelT</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft8distance11MinReduceOpE" title="raft::distance::MinReduceOp::DataT"><span class="n"><span class="pre">DataT</span></span></a><span class="p"><span class="pre">&gt;</span></span><a class="headerlink" href="#_CPPv4I00EN4raft8distance11MinReduceOpE" title="Permalink to this definition">&para;</a><br></dt>
<dd></dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-enums">Enums</p>
<dl class="cpp enum">
<dt class="sig sig-object cpp" id="_CPPv4N4raft8distance12DistanceTypeE">
<span id="_CPPv3N4raft8distance12DistanceTypeE"></span><span id="_CPPv2N4raft8distance12DistanceTypeE"></span><span class="target" id="namespaceraft_1_1distance_1a6e3fb35fdd7e258f6759f43428ca0ba1"></span><span class="k"><span class="pre">enum</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">DistanceType</span></span></span><a class="headerlink" href="#_CPPv4N4raft8distance12DistanceTypeE" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>enum to tell how to compute distance </p>
<p><em>Values:</em></p>
<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N4raft8distance12DistanceType10L2ExpandedE">
<span id="_CPPv3N4raft8distance12DistanceType10L2ExpandedE"></span><span id="_CPPv2N4raft8distance12DistanceType10L2ExpandedE"></span><span class="target" id="namespaceraft_1_1distance_1a6e3fb35fdd7e258f6759f43428ca0ba1a260d2830aacf708d5a9bab724efdcdf8"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">L2Expanded</span></span></span><a class="headerlink" href="#_CPPv4N4raft8distance12DistanceType10L2ExpandedE" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>evaluate as dist_ij = sum(x_ik^2) + sum(y_ij)^2 - 2*sum(x_ik * y_jk) </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N4raft8distance12DistanceType14L2SqrtExpandedE">
<span id="_CPPv3N4raft8distance12DistanceType14L2SqrtExpandedE"></span><span id="_CPPv2N4raft8distance12DistanceType14L2SqrtExpandedE"></span><span class="target" id="namespaceraft_1_1distance_1a6e3fb35fdd7e258f6759f43428ca0ba1a4d8d107312a2302379fb165bfae2d3c6"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">L2SqrtExpanded</span></span></span><a class="headerlink" href="#_CPPv4N4raft8distance12DistanceType14L2SqrtExpandedE" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>same as above, but inside the epilogue, perform square root operation </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N4raft8distance12DistanceType14CosineExpandedE">
<span id="_CPPv3N4raft8distance12DistanceType14CosineExpandedE"></span><span id="_CPPv2N4raft8distance12DistanceType14CosineExpandedE"></span><span class="target" id="namespaceraft_1_1distance_1a6e3fb35fdd7e258f6759f43428ca0ba1a48fb8815b598ea06333f61749afefb9b"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">CosineExpanded</span></span></span><a class="headerlink" href="#_CPPv4N4raft8distance12DistanceType14CosineExpandedE" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>cosine distance </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N4raft8distance12DistanceType2L1E">
<span id="_CPPv3N4raft8distance12DistanceType2L1E"></span><span id="_CPPv2N4raft8distance12DistanceType2L1E"></span><span class="target" id="namespaceraft_1_1distance_1a6e3fb35fdd7e258f6759f43428ca0ba1a4342e21a9d5a89dd05165b548ed76f31"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">L1</span></span></span><a class="headerlink" href="#_CPPv4N4raft8distance12DistanceType2L1E" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>L1 distance </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N4raft8distance12DistanceType12L2UnexpandedE">
<span id="_CPPv3N4raft8distance12DistanceType12L2UnexpandedE"></span><span id="_CPPv2N4raft8distance12DistanceType12L2UnexpandedE"></span><span class="target" id="namespaceraft_1_1distance_1a6e3fb35fdd7e258f6759f43428ca0ba1a81c2e8b19beb55f0771bff42a03ac810"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">L2Unexpanded</span></span></span><a class="headerlink" href="#_CPPv4N4raft8distance12DistanceType12L2UnexpandedE" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>evaluate as dist_ij += (x_ik - y-jk)^2 </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N4raft8distance12DistanceType16L2SqrtUnexpandedE">
<span id="_CPPv3N4raft8distance12DistanceType16L2SqrtUnexpandedE"></span><span id="_CPPv2N4raft8distance12DistanceType16L2SqrtUnexpandedE"></span><span class="target" id="namespaceraft_1_1distance_1a6e3fb35fdd7e258f6759f43428ca0ba1a8318dbfebd41e0f93b0c8a211bef3cb8"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">L2SqrtUnexpanded</span></span></span><a class="headerlink" href="#_CPPv4N4raft8distance12DistanceType16L2SqrtUnexpandedE" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>same as above, but inside the epilogue, perform square root operation </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N4raft8distance12DistanceType12InnerProductE">
<span id="_CPPv3N4raft8distance12DistanceType12InnerProductE"></span><span id="_CPPv2N4raft8distance12DistanceType12InnerProductE"></span><span class="target" id="namespaceraft_1_1distance_1a6e3fb35fdd7e258f6759f43428ca0ba1a70f89c9bf7fa6f05a13646e1de6d7178"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">InnerProduct</span></span></span><a class="headerlink" href="#_CPPv4N4raft8distance12DistanceType12InnerProductE" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>basic inner product </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N4raft8distance12DistanceType4LinfE">
<span id="_CPPv3N4raft8distance12DistanceType4LinfE"></span><span id="_CPPv2N4raft8distance12DistanceType4LinfE"></span><span class="target" id="namespaceraft_1_1distance_1a6e3fb35fdd7e258f6759f43428ca0ba1a185b8e11ff85c7ffb16372cc11f40833"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Linf</span></span></span><a class="headerlink" href="#_CPPv4N4raft8distance12DistanceType4LinfE" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Chebyshev (Linf) distance </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N4raft8distance12DistanceType8CanberraE">
<span id="_CPPv3N4raft8distance12DistanceType8CanberraE"></span><span id="_CPPv2N4raft8distance12DistanceType8CanberraE"></span><span class="target" id="namespaceraft_1_1distance_1a6e3fb35fdd7e258f6759f43428ca0ba1aa772a76513c29f7b67b8884d92a3debd"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Canberra</span></span></span><a class="headerlink" href="#_CPPv4N4raft8distance12DistanceType8CanberraE" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Canberra distance </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N4raft8distance12DistanceType12LpUnexpandedE">
<span id="_CPPv3N4raft8distance12DistanceType12LpUnexpandedE"></span><span id="_CPPv2N4raft8distance12DistanceType12LpUnexpandedE"></span><span class="target" id="namespaceraft_1_1distance_1a6e3fb35fdd7e258f6759f43428ca0ba1a5f1ddb80c7c8de7a58719c06fcb55aa9"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">LpUnexpanded</span></span></span><a class="headerlink" href="#_CPPv4N4raft8distance12DistanceType12LpUnexpandedE" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Generalized Minkowski distance </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N4raft8distance12DistanceType19CorrelationExpandedE">
<span id="_CPPv3N4raft8distance12DistanceType19CorrelationExpandedE"></span><span id="_CPPv2N4raft8distance12DistanceType19CorrelationExpandedE"></span><span class="target" id="namespaceraft_1_1distance_1a6e3fb35fdd7e258f6759f43428ca0ba1ac52ba9a65568dfd526ef3e0e79dd7d76"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">CorrelationExpanded</span></span></span><a class="headerlink" href="#_CPPv4N4raft8distance12DistanceType19CorrelationExpandedE" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Correlation distance </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N4raft8distance12DistanceType15JaccardExpandedE">
<span id="_CPPv3N4raft8distance12DistanceType15JaccardExpandedE"></span><span id="_CPPv2N4raft8distance12DistanceType15JaccardExpandedE"></span><span class="target" id="namespaceraft_1_1distance_1a6e3fb35fdd7e258f6759f43428ca0ba1afa8c62f78f79f7e9ea54fe96de211a06"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">JaccardExpanded</span></span></span><a class="headerlink" href="#_CPPv4N4raft8distance12DistanceType15JaccardExpandedE" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Jaccard distance </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N4raft8distance12DistanceType17HellingerExpandedE">
<span id="_CPPv3N4raft8distance12DistanceType17HellingerExpandedE"></span><span id="_CPPv2N4raft8distance12DistanceType17HellingerExpandedE"></span><span class="target" id="namespaceraft_1_1distance_1a6e3fb35fdd7e258f6759f43428ca0ba1afb2bdeb001658bf43f341662fd25d4bf"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">HellingerExpanded</span></span></span><a class="headerlink" href="#_CPPv4N4raft8distance12DistanceType17HellingerExpandedE" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Hellinger distance </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N4raft8distance12DistanceType9HaversineE">
<span id="_CPPv3N4raft8distance12DistanceType9HaversineE"></span><span id="_CPPv2N4raft8distance12DistanceType9HaversineE"></span><span class="target" id="namespaceraft_1_1distance_1a6e3fb35fdd7e258f6759f43428ca0ba1a85f595d27413bf51df240faf9fd51a1b"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Haversine</span></span></span><a class="headerlink" href="#_CPPv4N4raft8distance12DistanceType9HaversineE" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Haversine distance </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N4raft8distance12DistanceType10BrayCurtisE">
<span id="_CPPv3N4raft8distance12DistanceType10BrayCurtisE"></span><span id="_CPPv2N4raft8distance12DistanceType10BrayCurtisE"></span><span class="target" id="namespaceraft_1_1distance_1a6e3fb35fdd7e258f6759f43428ca0ba1a260486b7750910efc426c3011c187fc7"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">BrayCurtis</span></span></span><a class="headerlink" href="#_CPPv4N4raft8distance12DistanceType10BrayCurtisE" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Bray-Curtis distance </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N4raft8distance12DistanceType13JensenShannonE">
<span id="_CPPv3N4raft8distance12DistanceType13JensenShannonE"></span><span id="_CPPv2N4raft8distance12DistanceType13JensenShannonE"></span><span class="target" id="namespaceraft_1_1distance_1a6e3fb35fdd7e258f6759f43428ca0ba1a6c4feaa8cee536fb43bb62ec5d640d84"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">JensenShannon</span></span></span><a class="headerlink" href="#_CPPv4N4raft8distance12DistanceType13JensenShannonE" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Jensen-Shannon distance </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N4raft8distance12DistanceType17HammingUnexpandedE">
<span id="_CPPv3N4raft8distance12DistanceType17HammingUnexpandedE"></span><span id="_CPPv2N4raft8distance12DistanceType17HammingUnexpandedE"></span><span class="target" id="namespaceraft_1_1distance_1a6e3fb35fdd7e258f6759f43428ca0ba1a463aa03baa6d1ebfe73cb7e117c54799"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">HammingUnexpanded</span></span></span><a class="headerlink" href="#_CPPv4N4raft8distance12DistanceType17HammingUnexpandedE" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Hamming distance </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N4raft8distance12DistanceType12KLDivergenceE">
<span id="_CPPv3N4raft8distance12DistanceType12KLDivergenceE"></span><span id="_CPPv2N4raft8distance12DistanceType12KLDivergenceE"></span><span class="target" id="namespaceraft_1_1distance_1a6e3fb35fdd7e258f6759f43428ca0ba1a120ce453ec90b2f0cc900b427ba17859"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">KLDivergence</span></span></span><a class="headerlink" href="#_CPPv4N4raft8distance12DistanceType12KLDivergenceE" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>KLDivergence </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N4raft8distance12DistanceType17RusselRaoExpandedE">
<span id="_CPPv3N4raft8distance12DistanceType17RusselRaoExpandedE"></span><span id="_CPPv2N4raft8distance12DistanceType17RusselRaoExpandedE"></span><span class="target" id="namespaceraft_1_1distance_1a6e3fb35fdd7e258f6759f43428ca0ba1aeaed6497e19d80f7a3da8ca9f8f3f2f9"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">RusselRaoExpanded</span></span></span><a class="headerlink" href="#_CPPv4N4raft8distance12DistanceType17RusselRaoExpandedE" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>RusselRao </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N4raft8distance12DistanceType12DiceExpandedE">
<span id="_CPPv3N4raft8distance12DistanceType12DiceExpandedE"></span><span id="_CPPv2N4raft8distance12DistanceType12DiceExpandedE"></span><span class="target" id="namespaceraft_1_1distance_1a6e3fb35fdd7e258f6759f43428ca0ba1a045a33649506444b73c2c91854a425a3"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">DiceExpanded</span></span></span><a class="headerlink" href="#_CPPv4N4raft8distance12DistanceType12DiceExpandedE" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Dice-Sorensen distance </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N4raft8distance12DistanceType11PrecomputedE">
<span id="_CPPv3N4raft8distance12DistanceType11PrecomputedE"></span><span id="_CPPv2N4raft8distance12DistanceType11PrecomputedE"></span><span class="target" id="namespaceraft_1_1distance_1a6e3fb35fdd7e258f6759f43428ca0ba1ab06de53ee826704ad219603dcc4bf9cd"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Precomputed</span></span></span><a class="headerlink" href="#_CPPv4N4raft8distance12DistanceType11PrecomputedE" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Precomputed (special value) </p>
</dd></dl>

</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-functions">Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I_N4raft8distance12DistanceTypeE00000EN4raft8distance8distanceEvPK6InTypePK6InTypeP7OutType6Index_6Index_6Index_Pv6size_t11FinalLambda12cudaStream_tb6InType">
<span id="_CPPv3I_N4raft8distance12DistanceTypeE00000EN4raft8distance8distanceEPK6InTypePK6InTypeP7OutType6Index_6Index_6Index_Pv6size_t11FinalLambda12cudaStream_tb6InType"></span><span id="_CPPv2I_N4raft8distance12DistanceTypeE00000EN4raft8distance8distanceEPK6InTypePK6InTypeP7OutType6Index_6Index_6Index_Pv6size_t11FinalLambda12cudaStream_tb6InType"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="#_CPPv4N4raft8distanceE" title="raft::distance"><span class="n"><span class="pre">distance</span></span></a><span class="p"><span class="pre">::</span></span><a class="reference internal" href="#_CPPv4N4raft8distance12DistanceTypeE" title="raft::distance::DistanceType"><span class="n"><span class="pre">DistanceType</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">distanceType</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">InType</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">AccType</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">OutType</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">FinalLambda</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Index_</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="namespaceraft_1_1distance_1a30b5d0ad9c6fd2da977963427f6b4179"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">distance</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I_N4raft8distance12DistanceTypeE00000EN4raft8distance8distanceEvPK6InTypePK6InTypeP7OutType6Index_6Index_6Index_Pv6size_t11FinalLambda12cudaStream_tb6InType" title="raft::distance::distance::InType"><span class="n"><span class="pre">InType</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">x</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I_N4raft8distance12DistanceTypeE00000EN4raft8distance8distanceEvPK6InTypePK6InTypeP7OutType6Index_6Index_6Index_Pv6size_t11FinalLambda12cudaStream_tb6InType" title="raft::distance::distance::InType"><span class="n"><span class="pre">InType</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">y</span></span>, <a class="reference internal" href="#_CPPv4I_N4raft8distance12DistanceTypeE00000EN4raft8distance8distanceEvPK6InTypePK6InTypeP7OutType6Index_6Index_6Index_Pv6size_t11FinalLambda12cudaStream_tb6InType" title="raft::distance::distance::OutType"><span class="n"><span class="pre">OutType</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">dist</span></span>, <a class="reference internal" href="#_CPPv4I_N4raft8distance12DistanceTypeE00000EN4raft8distance8distanceEvPK6InTypePK6InTypeP7OutType6Index_6Index_6Index_Pv6size_t11FinalLambda12cudaStream_tb6InType" title="raft::distance::distance::Index_"><span class="n"><span class="pre">Index_</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">m</span></span>, <a class="reference internal" href="#_CPPv4I_N4raft8distance12DistanceTypeE00000EN4raft8distance8distanceEvPK6InTypePK6InTypeP7OutType6Index_6Index_6Index_Pv6size_t11FinalLambda12cudaStream_tb6InType" title="raft::distance::distance::Index_"><span class="n"><span class="pre">Index_</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">n</span></span>, <a class="reference internal" href="#_CPPv4I_N4raft8distance12DistanceTypeE00000EN4raft8distance8distanceEvPK6InTypePK6InTypeP7OutType6Index_6Index_6Index_Pv6size_t11FinalLambda12cudaStream_tb6InType" title="raft::distance::distance::Index_"><span class="n"><span class="pre">Index_</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">k</span></span>, <span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">workspace</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">worksize</span></span>, <a class="reference internal" href="#_CPPv4I_N4raft8distance12DistanceTypeE00000EN4raft8distance8distanceEvPK6InTypePK6InTypeP7OutType6Index_6Index_6Index_Pv6size_t11FinalLambda12cudaStream_tb6InType" title="raft::distance::distance::FinalLambda"><span class="n"><span class="pre">FinalLambda</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">fin_op</span></span>, <span class="n"><span class="pre">cudaStream_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">stream</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">isRowMajor</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">true</span></span>, <a class="reference internal" href="#_CPPv4I_N4raft8distance12DistanceTypeE00000EN4raft8distance8distanceEvPK6InTypePK6InTypeP7OutType6Index_6Index_6Index_Pv6size_t11FinalLambda12cudaStream_tb6InType" title="raft::distance::distance::InType"><span class="n"><span class="pre">InType</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">metric_arg</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">2.0f</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I_N4raft8distance12DistanceTypeE00000EN4raft8distance8distanceEvPK6InTypePK6InTypeP7OutType6Index_6Index_6Index_Pv6size_t11FinalLambda12cudaStream_tb6InType" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Evaluate pairwise distances with the user epilogue lamba allowed. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>fin_op: This is a device lambda which is supposed to operate upon the input which is AccType and returns the output in OutType. It&rsquo;s signature is as follows: . If one needs any other parameters, feel free to pass them via closure. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>DistanceType</strong> &ndash; which distance to evaluate </p></li>
<li><p><strong>InType</strong> &ndash; input argument type </p></li>
<li><p><strong>AccType</strong> &ndash; accumulation type </p></li>
<li><p><strong>OutType</strong> &ndash; output type </p></li>
<li><p><strong>FinalLambda</strong> &ndash; user-defined epilogue lamba </p></li>
<li><p><strong>Index_</strong> &ndash; Index type </p></li>
</ul>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>x</strong> &ndash; first set of points </p></li>
<li><p><strong>y</strong> &ndash; second set of points </p></li>
<li><p><strong>dist</strong> &ndash; output distance matrix </p></li>
<li><p><strong>m</strong> &ndash; number of points in x </p></li>
<li><p><strong>n</strong> &ndash; number of points in y </p></li>
<li><p><strong>k</strong> &ndash; dimensionality </p></li>
<li><p><strong>workspace</strong> &ndash; temporary workspace needed for computations </p></li>
<li><p><strong>worksize</strong> &ndash; number of bytes of the workspace </p></li>
<li><p><strong>fin_op</strong> &ndash; the final gemm epilogue lambda </p></li>
<li><p><strong>stream</strong> &ndash; cuda stream </p></li>
<li><p><strong>isRowMajor</strong> &ndash; whether the matrices are row-major or col-major </p></li>
<li><p><strong>metric_arg</strong> &ndash; metric argument (used for Minkowski distance)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I_N4raft8distance12DistanceTypeE0000EN4raft8distance8distanceEvPK6InTypePK6InTypeP7OutType6Index_6Index_6Index_Pv6size_t12cudaStream_tb6InType">
<span id="_CPPv3I_N4raft8distance12DistanceTypeE0000EN4raft8distance8distanceEPK6InTypePK6InTypeP7OutType6Index_6Index_6Index_Pv6size_t12cudaStream_tb6InType"></span><span id="_CPPv2I_N4raft8distance12DistanceTypeE0000EN4raft8distance8distanceEPK6InTypePK6InTypeP7OutType6Index_6Index_6Index_Pv6size_t12cudaStream_tb6InType"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="#_CPPv4N4raft8distanceE" title="raft::distance"><span class="n"><span class="pre">distance</span></span></a><span class="p"><span class="pre">::</span></span><a class="reference internal" href="#_CPPv4N4raft8distance12DistanceTypeE" title="raft::distance::DistanceType"><span class="n"><span class="pre">DistanceType</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">distanceType</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">InType</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">AccType</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">OutType</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Index_</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="namespaceraft_1_1distance_1ad7690136a3ce7b161692a58f97c1929e"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">distance</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I_N4raft8distance12DistanceTypeE0000EN4raft8distance8distanceEvPK6InTypePK6InTypeP7OutType6Index_6Index_6Index_Pv6size_t12cudaStream_tb6InType" title="raft::distance::distance::InType"><span class="n"><span class="pre">InType</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">x</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I_N4raft8distance12DistanceTypeE0000EN4raft8distance8distanceEvPK6InTypePK6InTypeP7OutType6Index_6Index_6Index_Pv6size_t12cudaStream_tb6InType" title="raft::distance::distance::InType"><span class="n"><span class="pre">InType</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">y</span></span>, <a class="reference internal" href="#_CPPv4I_N4raft8distance12DistanceTypeE0000EN4raft8distance8distanceEvPK6InTypePK6InTypeP7OutType6Index_6Index_6Index_Pv6size_t12cudaStream_tb6InType" title="raft::distance::distance::OutType"><span class="n"><span class="pre">OutType</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">dist</span></span>, <a class="reference internal" href="#_CPPv4I_N4raft8distance12DistanceTypeE0000EN4raft8distance8distanceEvPK6InTypePK6InTypeP7OutType6Index_6Index_6Index_Pv6size_t12cudaStream_tb6InType" title="raft::distance::distance::Index_"><span class="n"><span class="pre">Index_</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">m</span></span>, <a class="reference internal" href="#_CPPv4I_N4raft8distance12DistanceTypeE0000EN4raft8distance8distanceEvPK6InTypePK6InTypeP7OutType6Index_6Index_6Index_Pv6size_t12cudaStream_tb6InType" title="raft::distance::distance::Index_"><span class="n"><span class="pre">Index_</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">n</span></span>, <a class="reference internal" href="#_CPPv4I_N4raft8distance12DistanceTypeE0000EN4raft8distance8distanceEvPK6InTypePK6InTypeP7OutType6Index_6Index_6Index_Pv6size_t12cudaStream_tb6InType" title="raft::distance::distance::Index_"><span class="n"><span class="pre">Index_</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">k</span></span>, <span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">workspace</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">worksize</span></span>, <span class="n"><span class="pre">cudaStream_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">stream</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">isRowMajor</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">true</span></span>, <a class="reference internal" href="#_CPPv4I_N4raft8distance12DistanceTypeE0000EN4raft8distance8distanceEvPK6InTypePK6InTypeP7OutType6Index_6Index_6Index_Pv6size_t12cudaStream_tb6InType" title="raft::distance::distance::InType"><span class="n"><span class="pre">InType</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">metric_arg</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">2.0f</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I_N4raft8distance12DistanceTypeE0000EN4raft8distance8distanceEvPK6InTypePK6InTypeP7OutType6Index_6Index_6Index_Pv6size_t12cudaStream_tb6InType" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Evaluate pairwise distances for the simple use case. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>if workspace is passed as nullptr, this will return in worksize, the number of bytes of workspace required </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>DistanceType</strong> &ndash; which distance to evaluate </p></li>
<li><p><strong>InType</strong> &ndash; input argument type </p></li>
<li><p><strong>AccType</strong> &ndash; accumulation type </p></li>
<li><p><strong>OutType</strong> &ndash; output type </p></li>
<li><p><strong>Index_</strong> &ndash; Index type </p></li>
</ul>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>x</strong> &ndash; first set of points </p></li>
<li><p><strong>y</strong> &ndash; second set of points </p></li>
<li><p><strong>dist</strong> &ndash; output distance matrix </p></li>
<li><p><strong>m</strong> &ndash; number of points in x </p></li>
<li><p><strong>n</strong> &ndash; number of points in y </p></li>
<li><p><strong>k</strong> &ndash; dimensionality </p></li>
<li><p><strong>workspace</strong> &ndash; temporary workspace needed for computations </p></li>
<li><p><strong>worksize</strong> &ndash; number of bytes of the workspace </p></li>
<li><p><strong>stream</strong> &ndash; cuda stream </p></li>
<li><p><strong>isRowMajor</strong> &ndash; whether the matrices are row-major or col-major </p></li>
<li><p><strong>metric_arg</strong> &ndash; metric argument (used for Minkowski distance)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I_N4raft8distance12DistanceTypeE0000EN4raft8distance16getWorkspaceSizeE6size_tPK6InTypePK6InType6Index_6Index_6Index_">
<span id="_CPPv3I_N4raft8distance12DistanceTypeE0000EN4raft8distance16getWorkspaceSizeEPK6InTypePK6InType6Index_6Index_6Index_"></span><span id="_CPPv2I_N4raft8distance12DistanceTypeE0000EN4raft8distance16getWorkspaceSizeEPK6InTypePK6InType6Index_6Index_6Index_"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="#_CPPv4N4raft8distanceE" title="raft::distance"><span class="n"><span class="pre">distance</span></span></a><span class="p"><span class="pre">::</span></span><a class="reference internal" href="#_CPPv4N4raft8distance12DistanceTypeE" title="raft::distance::DistanceType"><span class="n"><span class="pre">DistanceType</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">distanceType</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">InType</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">AccType</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">OutType</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Index_</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="namespaceraft_1_1distance_1a088c016777ff14cfe25dd028224135c6"></span><span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">getWorkspaceSize</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I_N4raft8distance12DistanceTypeE0000EN4raft8distance16getWorkspaceSizeE6size_tPK6InTypePK6InType6Index_6Index_6Index_" title="raft::distance::getWorkspaceSize::InType"><span class="n"><span class="pre">InType</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">x</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I_N4raft8distance12DistanceTypeE0000EN4raft8distance16getWorkspaceSizeE6size_tPK6InTypePK6InType6Index_6Index_6Index_" title="raft::distance::getWorkspaceSize::InType"><span class="n"><span class="pre">InType</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">y</span></span>, <a class="reference internal" href="#_CPPv4I_N4raft8distance12DistanceTypeE0000EN4raft8distance16getWorkspaceSizeE6size_tPK6InTypePK6InType6Index_6Index_6Index_" title="raft::distance::getWorkspaceSize::Index_"><span class="n"><span class="pre">Index_</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">m</span></span>, <a class="reference internal" href="#_CPPv4I_N4raft8distance12DistanceTypeE0000EN4raft8distance16getWorkspaceSizeE6size_tPK6InTypePK6InType6Index_6Index_6Index_" title="raft::distance::getWorkspaceSize::Index_"><span class="n"><span class="pre">Index_</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">n</span></span>, <a class="reference internal" href="#_CPPv4I_N4raft8distance12DistanceTypeE0000EN4raft8distance16getWorkspaceSizeE6size_tPK6InTypePK6InType6Index_6Index_6Index_" title="raft::distance::getWorkspaceSize::Index_"><span class="n"><span class="pre">Index_</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">k</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I_N4raft8distance12DistanceTypeE0000EN4raft8distance16getWorkspaceSizeE6size_tPK6InTypePK6InType6Index_6Index_6Index_" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Return the exact workspace size to compute the distance. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If the specified distanceType doesn&rsquo;t need the workspace at all, it returns 0. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>DistanceType</strong> &ndash; which distance to evaluate </p></li>
<li><p><strong>InType</strong> &ndash; input argument type </p></li>
<li><p><strong>AccType</strong> &ndash; accumulation type </p></li>
<li><p><strong>OutType</strong> &ndash; output type </p></li>
<li><p><strong>Index_</strong> &ndash; Index type </p></li>
</ul>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>x</strong> &ndash; first set of points </p></li>
<li><p><strong>y</strong> &ndash; second set of points </p></li>
<li><p><strong>m</strong> &ndash; number of points in x </p></li>
<li><p><strong>n</strong> &ndash; number of points in y </p></li>
<li><p><strong>k</strong> &ndash; dimensionality</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I_N4raft8distance12DistanceTypeE00000EN4raft8distance16getWorkspaceSizeE6size_tKN4raft18device_matrix_viewI6InType6layoutEEKN4raft18device_matrix_viewI6InType6layoutEE">
<span id="_CPPv3I_N4raft8distance12DistanceTypeE00000EN4raft8distance16getWorkspaceSizeEKN4raft18device_matrix_viewI6InType6layoutEEKN4raft18device_matrix_viewI6InType6layoutEE"></span><span id="_CPPv2I_N4raft8distance12DistanceTypeE00000EN4raft8distance16getWorkspaceSizeEKN4raft18device_matrix_viewI6InType6layoutEEKN4raft18device_matrix_viewI6InType6layoutEE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="#_CPPv4N4raft8distanceE" title="raft::distance"><span class="n"><span class="pre">distance</span></span></a><span class="p"><span class="pre">::</span></span><a class="reference internal" href="#_CPPv4N4raft8distance12DistanceTypeE" title="raft::distance::DistanceType"><span class="n"><span class="pre">DistanceType</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">distanceType</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">InType</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">AccType</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">OutType</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Index_</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">layout</span></span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="namespaceraft_1_1distance_1afef1ec261e2fb5f236cb8a8e0eb7b9fc"></span><span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">getWorkspaceSize</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">device_matrix_view</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I_N4raft8distance12DistanceTypeE00000EN4raft8distance16getWorkspaceSizeE6size_tKN4raft18device_matrix_viewI6InType6layoutEEKN4raft18device_matrix_viewI6InType6layoutEE" title="raft::distance::getWorkspaceSize::InType"><span class="n"><span class="pre">InType</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I_N4raft8distance12DistanceTypeE00000EN4raft8distance16getWorkspaceSizeE6size_tKN4raft18device_matrix_viewI6InType6layoutEEKN4raft18device_matrix_viewI6InType6layoutEE" title="raft::distance::getWorkspaceSize::layout"><span class="n"><span class="pre">layout</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">x</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">device_matrix_view</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I_N4raft8distance12DistanceTypeE00000EN4raft8distance16getWorkspaceSizeE6size_tKN4raft18device_matrix_viewI6InType6layoutEEKN4raft18device_matrix_viewI6InType6layoutEE" title="raft::distance::getWorkspaceSize::InType"><span class="n"><span class="pre">InType</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I_N4raft8distance12DistanceTypeE00000EN4raft8distance16getWorkspaceSizeE6size_tKN4raft18device_matrix_viewI6InType6layoutEEKN4raft18device_matrix_viewI6InType6layoutEE" title="raft::distance::getWorkspaceSize::layout"><span class="n"><span class="pre">layout</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">y</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I_N4raft8distance12DistanceTypeE00000EN4raft8distance16getWorkspaceSizeE6size_tKN4raft18device_matrix_viewI6InType6layoutEEKN4raft18device_matrix_viewI6InType6layoutEE" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Return the exact workspace size to compute the distance. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If the specified distanceType doesn&rsquo;t need the workspace at all, it returns 0. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>DistanceType</strong> &ndash; which distance to evaluate </p></li>
<li><p><strong>InType</strong> &ndash; input argument type </p></li>
<li><p><strong>AccType</strong> &ndash; accumulation type </p></li>
<li><p><strong>OutType</strong> &ndash; output type </p></li>
<li><p><strong>Index_</strong> &ndash; Index type </p></li>
</ul>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>x</strong> &ndash; first set of points (size m*k) </p></li>
<li><p><strong>y</strong> &ndash; second set of points (size n*k) </p></li>
</ul>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>number of bytes needed in workspace</p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I_N4raft8distance12DistanceTypeE0000EN4raft8distance8distanceEvPK6InTypePK6InTypeP7OutType6Index_6Index_6Index_12cudaStream_tb6InType">
<span id="_CPPv3I_N4raft8distance12DistanceTypeE0000EN4raft8distance8distanceEPK6InTypePK6InTypeP7OutType6Index_6Index_6Index_12cudaStream_tb6InType"></span><span id="_CPPv2I_N4raft8distance12DistanceTypeE0000EN4raft8distance8distanceEPK6InTypePK6InTypeP7OutType6Index_6Index_6Index_12cudaStream_tb6InType"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="#_CPPv4N4raft8distanceE" title="raft::distance"><span class="n"><span class="pre">distance</span></span></a><span class="p"><span class="pre">::</span></span><a class="reference internal" href="#_CPPv4N4raft8distance12DistanceTypeE" title="raft::distance::DistanceType"><span class="n"><span class="pre">DistanceType</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">distanceType</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">InType</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">AccType</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">OutType</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Index_</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="namespaceraft_1_1distance_1a343f180fa6587eebb0d32c765f83b543"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">distance</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I_N4raft8distance12DistanceTypeE0000EN4raft8distance8distanceEvPK6InTypePK6InTypeP7OutType6Index_6Index_6Index_12cudaStream_tb6InType" title="raft::distance::distance::InType"><span class="n"><span class="pre">InType</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">x</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I_N4raft8distance12DistanceTypeE0000EN4raft8distance8distanceEvPK6InTypePK6InTypeP7OutType6Index_6Index_6Index_12cudaStream_tb6InType" title="raft::distance::distance::InType"><span class="n"><span class="pre">InType</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">y</span></span>, <a class="reference internal" href="#_CPPv4I_N4raft8distance12DistanceTypeE0000EN4raft8distance8distanceEvPK6InTypePK6InTypeP7OutType6Index_6Index_6Index_12cudaStream_tb6InType" title="raft::distance::distance::OutType"><span class="n"><span class="pre">OutType</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">dist</span></span>, <a class="reference internal" href="#_CPPv4I_N4raft8distance12DistanceTypeE0000EN4raft8distance8distanceEvPK6InTypePK6InTypeP7OutType6Index_6Index_6Index_12cudaStream_tb6InType" title="raft::distance::distance::Index_"><span class="n"><span class="pre">Index_</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">m</span></span>, <a class="reference internal" href="#_CPPv4I_N4raft8distance12DistanceTypeE0000EN4raft8distance8distanceEvPK6InTypePK6InTypeP7OutType6Index_6Index_6Index_12cudaStream_tb6InType" title="raft::distance::distance::Index_"><span class="n"><span class="pre">Index_</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">n</span></span>, <a class="reference internal" href="#_CPPv4I_N4raft8distance12DistanceTypeE0000EN4raft8distance8distanceEvPK6InTypePK6InTypeP7OutType6Index_6Index_6Index_12cudaStream_tb6InType" title="raft::distance::distance::Index_"><span class="n"><span class="pre">Index_</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">k</span></span>, <span class="n"><span class="pre">cudaStream_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">stream</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">isRowMajor</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">true</span></span>, <a class="reference internal" href="#_CPPv4I_N4raft8distance12DistanceTypeE0000EN4raft8distance8distanceEvPK6InTypePK6InTypeP7OutType6Index_6Index_6Index_12cudaStream_tb6InType" title="raft::distance::distance::InType"><span class="n"><span class="pre">InType</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">metric_arg</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">2.0f</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I_N4raft8distance12DistanceTypeE0000EN4raft8distance8distanceEvPK6InTypePK6InTypeP7OutType6Index_6Index_6Index_12cudaStream_tb6InType" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Evaluate pairwise distances for the simple use case. </p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>DistanceType</strong> &ndash; which distance to evaluate </p></li>
<li><p><strong>InType</strong> &ndash; input argument type </p></li>
<li><p><strong>AccType</strong> &ndash; accumulation type </p></li>
<li><p><strong>OutType</strong> &ndash; output type </p></li>
<li><p><strong>Index_</strong> &ndash; Index type </p></li>
</ul>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>x</strong> &ndash; first set of points </p></li>
<li><p><strong>y</strong> &ndash; second set of points </p></li>
<li><p><strong>dist</strong> &ndash; output distance matrix </p></li>
<li><p><strong>m</strong> &ndash; number of points in x </p></li>
<li><p><strong>n</strong> &ndash; number of points in y </p></li>
<li><p><strong>k</strong> &ndash; dimensionality </p></li>
<li><p><strong>stream</strong> &ndash; cuda stream </p></li>
<li><p><strong>isRowMajor</strong> &ndash; whether the matrices are row-major or col-major </p></li>
<li><p><strong>metric_arg</strong> &ndash; metric argument (used for Minkowski distance) </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I_N4raft8distance12DistanceTypeE00000EN4raft8distance8distanceEvRKN4raft8handle_tEKN4raft18device_matrix_viewI6InType6Index_6layoutEEKN4raft18device_matrix_viewI6InType6Index_6layoutEEN4raft18device_matrix_viewI7OutType6Index_6layoutEE6InType">
<span id="_CPPv3I_N4raft8distance12DistanceTypeE00000EN4raft8distance8distanceERKN4raft8handle_tEKN4raft18device_matrix_viewI6InType6Index_6layoutEEKN4raft18device_matrix_viewI6InType6Index_6layoutEEN4raft18device_matrix_viewI7OutType6Index_6layoutEE6InType"></span><span id="_CPPv2I_N4raft8distance12DistanceTypeE00000EN4raft8distance8distanceERKN4raft8handle_tEKN4raft18device_matrix_viewI6InType6Index_6layoutEEKN4raft18device_matrix_viewI6InType6Index_6layoutEEN4raft18device_matrix_viewI7OutType6Index_6layoutEE6InType"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="#_CPPv4N4raft8distanceE" title="raft::distance"><span class="n"><span class="pre">distance</span></span></a><span class="p"><span class="pre">::</span></span><a class="reference internal" href="#_CPPv4N4raft8distance12DistanceTypeE" title="raft::distance::DistanceType"><span class="n"><span class="pre">DistanceType</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">distanceType</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">InType</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">AccType</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">OutType</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">layout</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">layout_c_contiguous</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Index_</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="namespaceraft_1_1distance_1af3cd2723a7ceba7666645cea5ff1ddac"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">distance</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="core.html#_CPPv4N4raft8handle_tE" title="raft::handle_t"><span class="n"><span class="pre">handle_t</span></span></a><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">handle</span></span>, <span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">device_matrix_view</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I_N4raft8distance12DistanceTypeE00000EN4raft8distance8distanceEvRKN4raft8handle_tEKN4raft18device_matrix_viewI6InType6Index_6layoutEEKN4raft18device_matrix_viewI6InType6Index_6layoutEEN4raft18device_matrix_viewI7OutType6Index_6layoutEE6InType" title="raft::distance::distance::InType"><span class="n"><span class="pre">InType</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I_N4raft8distance12DistanceTypeE00000EN4raft8distance8distanceEvRKN4raft8handle_tEKN4raft18device_matrix_viewI6InType6Index_6layoutEEKN4raft18device_matrix_viewI6InType6Index_6layoutEEN4raft18device_matrix_viewI7OutType6Index_6layoutEE6InType" title="raft::distance::distance::Index_"><span class="n"><span class="pre">Index_</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I_N4raft8distance12DistanceTypeE00000EN4raft8distance8distanceEvRKN4raft8handle_tEKN4raft18device_matrix_viewI6InType6Index_6layoutEEKN4raft18device_matrix_viewI6InType6Index_6layoutEEN4raft18device_matrix_viewI7OutType6Index_6layoutEE6InType" title="raft::distance::distance::layout"><span class="n"><span class="pre">layout</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">x</span></span>, <span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">device_matrix_view</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I_N4raft8distance12DistanceTypeE00000EN4raft8distance8distanceEvRKN4raft8handle_tEKN4raft18device_matrix_viewI6InType6Index_6layoutEEKN4raft18device_matrix_viewI6InType6Index_6layoutEEN4raft18device_matrix_viewI7OutType6Index_6layoutEE6InType" title="raft::distance::distance::InType"><span class="n"><span class="pre">InType</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I_N4raft8distance12DistanceTypeE00000EN4raft8distance8distanceEvRKN4raft8handle_tEKN4raft18device_matrix_viewI6InType6Index_6layoutEEKN4raft18device_matrix_viewI6InType6Index_6layoutEEN4raft18device_matrix_viewI7OutType6Index_6layoutEE6InType" title="raft::distance::distance::Index_"><span class="n"><span class="pre">Index_</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I_N4raft8distance12DistanceTypeE00000EN4raft8distance8distanceEvRKN4raft8handle_tEKN4raft18device_matrix_viewI6InType6Index_6layoutEEKN4raft18device_matrix_viewI6InType6Index_6layoutEEN4raft18device_matrix_viewI7OutType6Index_6layoutEE6InType" title="raft::distance::distance::layout"><span class="n"><span class="pre">layout</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">y</span></span>, <span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">device_matrix_view</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I_N4raft8distance12DistanceTypeE00000EN4raft8distance8distanceEvRKN4raft8handle_tEKN4raft18device_matrix_viewI6InType6Index_6layoutEEKN4raft18device_matrix_viewI6InType6Index_6layoutEEN4raft18device_matrix_viewI7OutType6Index_6layoutEE6InType" title="raft::distance::distance::OutType"><span class="n"><span class="pre">OutType</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I_N4raft8distance12DistanceTypeE00000EN4raft8distance8distanceEvRKN4raft8handle_tEKN4raft18device_matrix_viewI6InType6Index_6layoutEEKN4raft18device_matrix_viewI6InType6Index_6layoutEEN4raft18device_matrix_viewI7OutType6Index_6layoutEE6InType" title="raft::distance::distance::Index_"><span class="n"><span class="pre">Index_</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I_N4raft8distance12DistanceTypeE00000EN4raft8distance8distanceEvRKN4raft8handle_tEKN4raft18device_matrix_viewI6InType6Index_6layoutEEKN4raft18device_matrix_viewI6InType6Index_6layoutEEN4raft18device_matrix_viewI7OutType6Index_6layoutEE6InType" title="raft::distance::distance::layout"><span class="n"><span class="pre">layout</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">dist</span></span>, <a class="reference internal" href="#_CPPv4I_N4raft8distance12DistanceTypeE00000EN4raft8distance8distanceEvRKN4raft8handle_tEKN4raft18device_matrix_viewI6InType6Index_6layoutEEKN4raft18device_matrix_viewI6InType6Index_6layoutEEN4raft18device_matrix_viewI7OutType6Index_6layoutEE6InType" title="raft::distance::distance::InType"><span class="n"><span class="pre">InType</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">metric_arg</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">2.0f</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I_N4raft8distance12DistanceTypeE00000EN4raft8distance8distanceEvRKN4raft8handle_tEKN4raft18device_matrix_viewI6InType6Index_6layoutEEKN4raft18device_matrix_viewI6InType6Index_6layoutEEN4raft18device_matrix_viewI7OutType6Index_6layoutEE6InType" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Evaluate pairwise distances for the simple use case. </p>
<p>Note: Only contiguous row- or column-major layouts supported currently.</p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>DistanceType</strong> &ndash; which distance to evaluate </p></li>
<li><p><strong>InType</strong> &ndash; input argument type </p></li>
<li><p><strong>AccType</strong> &ndash; accumulation type </p></li>
<li><p><strong>OutType</strong> &ndash; output type </p></li>
<li><p><strong>Index_</strong> &ndash; Index type </p></li>
</ul>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>handle</strong> &ndash; raft handle for managing expensive resources </p></li>
<li><p><strong>x</strong> &ndash; first set of points (size n*k) </p></li>
<li><p><strong>y</strong> &ndash; second set of points (size m*k) </p></li>
<li><p><strong>dist</strong> &ndash; output distance matrix (size n*m) </p></li>
<li><p><strong>metric_arg</strong> &ndash; metric argument (used for Minkowski distance) </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I00EN4raft8distance17pairwise_distanceEvRKN4raft8handle_tEPK4TypePK4TypeP4Type6Index_6Index_6Index_RN3rmm14device_uvectorIcEEN4raft8distance12DistanceTypeEb4Type">
<span id="_CPPv3I00EN4raft8distance17pairwise_distanceERKN4raft8handle_tEPK4TypePK4TypeP4Type6Index_6Index_6Index_RN3rmm14device_uvectorIcEEN4raft8distance12DistanceTypeEb4Type"></span><span id="_CPPv2I00EN4raft8distance17pairwise_distanceERKN4raft8handle_tEPK4TypePK4TypeP4Type6Index_6Index_6Index_RN3rmm14device_uvectorIcEEN4raft8distance12DistanceTypeEb4Type"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Type</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Index_</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="namespaceraft_1_1distance_1a379cae44de27631bee797702aea7bf58"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">pairwise_distance</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="core.html#_CPPv4N4raft8handle_tE" title="raft::handle_t"><span class="n"><span class="pre">handle_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">handle</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft8distance17pairwise_distanceEvRKN4raft8handle_tEPK4TypePK4TypeP4Type6Index_6Index_6Index_RN3rmm14device_uvectorIcEEN4raft8distance12DistanceTypeEb4Type" title="raft::distance::pairwise_distance::Type"><span class="n"><span class="pre">Type</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">x</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft8distance17pairwise_distanceEvRKN4raft8handle_tEPK4TypePK4TypeP4Type6Index_6Index_6Index_RN3rmm14device_uvectorIcEEN4raft8distance12DistanceTypeEb4Type" title="raft::distance::pairwise_distance::Type"><span class="n"><span class="pre">Type</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">y</span></span>, <a class="reference internal" href="#_CPPv4I00EN4raft8distance17pairwise_distanceEvRKN4raft8handle_tEPK4TypePK4TypeP4Type6Index_6Index_6Index_RN3rmm14device_uvectorIcEEN4raft8distance12DistanceTypeEb4Type" title="raft::distance::pairwise_distance::Type"><span class="n"><span class="pre">Type</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">dist</span></span>, <a class="reference internal" href="#_CPPv4I00EN4raft8distance17pairwise_distanceEvRKN4raft8handle_tEPK4TypePK4TypeP4Type6Index_6Index_6Index_RN3rmm14device_uvectorIcEEN4raft8distance12DistanceTypeEb4Type" title="raft::distance::pairwise_distance::Index_"><span class="n"><span class="pre">Index_</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">m</span></span>, <a class="reference internal" href="#_CPPv4I00EN4raft8distance17pairwise_distanceEvRKN4raft8handle_tEPK4TypePK4TypeP4Type6Index_6Index_6Index_RN3rmm14device_uvectorIcEEN4raft8distance12DistanceTypeEb4Type" title="raft::distance::pairwise_distance::Index_"><span class="n"><span class="pre">Index_</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">n</span></span>, <a class="reference internal" href="#_CPPv4I00EN4raft8distance17pairwise_distanceEvRKN4raft8handle_tEPK4TypePK4TypeP4Type6Index_6Index_6Index_RN3rmm14device_uvectorIcEEN4raft8distance12DistanceTypeEb4Type" title="raft::distance::pairwise_distance::Index_"><span class="n"><span class="pre">Index_</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">k</span></span>, <span class="n"><span class="pre">rmm</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">device_uvector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">char</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">workspace</span></span>, <span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="#_CPPv4N4raft8distanceE" title="raft::distance"><span class="n"><span class="pre">distance</span></span></a><span class="p"><span class="pre">::</span></span><a class="reference internal" href="#_CPPv4N4raft8distance12DistanceTypeE" title="raft::distance::DistanceType"><span class="n"><span class="pre">DistanceType</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">metric</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">isRowMajor</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">true</span></span>, <a class="reference internal" href="#_CPPv4I00EN4raft8distance17pairwise_distanceEvRKN4raft8handle_tEPK4TypePK4TypeP4Type6Index_6Index_6Index_RN3rmm14device_uvectorIcEEN4raft8distance12DistanceTypeEb4Type" title="raft::distance::pairwise_distance::Type"><span class="n"><span class="pre">Type</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">metric_arg</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">2.0f</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I00EN4raft8distance17pairwise_distanceEvRKN4raft8handle_tEPK4TypePK4TypeP4Type6Index_6Index_6Index_RN3rmm14device_uvectorIcEEN4raft8distance12DistanceTypeEb4Type" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Convenience wrapper around &lsquo;distance&rsquo; prim to convert runtime metric into compile time for the purpose of dispatch. </p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Type</strong> &ndash; input/accumulation/output data-type </p></li>
<li><p><strong>Index_</strong> &ndash; indexing type </p></li>
</ul>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>handle</strong> &ndash; raft handle for managing expensive resources </p></li>
<li><p><strong>x</strong> &ndash; first set of points </p></li>
<li><p><strong>y</strong> &ndash; second set of points </p></li>
<li><p><strong>dist</strong> &ndash; output distance matrix </p></li>
<li><p><strong>m</strong> &ndash; number of points in x </p></li>
<li><p><strong>n</strong> &ndash; number of points in y </p></li>
<li><p><strong>k</strong> &ndash; dimensionality </p></li>
<li><p><strong>workspace</strong> &ndash; temporary workspace buffer which can get resized as per the needed workspace size </p></li>
<li><p><strong>metric</strong> &ndash; distance metric </p></li>
<li><p><strong>isRowMajor</strong> &ndash; whether the matrices are row-major or col-major </p></li>
<li><p><strong>metric_arg</strong> &ndash; metric argument (used for Minkowski distance) </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I00EN4raft8distance17pairwise_distanceEvRKN4raft8handle_tEPK4TypePK4TypeP4Type6Index_6Index_6Index_N4raft8distance12DistanceTypeEb4Type">
<span id="_CPPv3I00EN4raft8distance17pairwise_distanceERKN4raft8handle_tEPK4TypePK4TypeP4Type6Index_6Index_6Index_N4raft8distance12DistanceTypeEb4Type"></span><span id="_CPPv2I00EN4raft8distance17pairwise_distanceERKN4raft8handle_tEPK4TypePK4TypeP4Type6Index_6Index_6Index_N4raft8distance12DistanceTypeEb4Type"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Type</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Index_</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="namespaceraft_1_1distance_1af26ef24cd2317ae5ec2c78740d1a22c9"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">pairwise_distance</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="core.html#_CPPv4N4raft8handle_tE" title="raft::handle_t"><span class="n"><span class="pre">handle_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">handle</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft8distance17pairwise_distanceEvRKN4raft8handle_tEPK4TypePK4TypeP4Type6Index_6Index_6Index_N4raft8distance12DistanceTypeEb4Type" title="raft::distance::pairwise_distance::Type"><span class="n"><span class="pre">Type</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">x</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft8distance17pairwise_distanceEvRKN4raft8handle_tEPK4TypePK4TypeP4Type6Index_6Index_6Index_N4raft8distance12DistanceTypeEb4Type" title="raft::distance::pairwise_distance::Type"><span class="n"><span class="pre">Type</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">y</span></span>, <a class="reference internal" href="#_CPPv4I00EN4raft8distance17pairwise_distanceEvRKN4raft8handle_tEPK4TypePK4TypeP4Type6Index_6Index_6Index_N4raft8distance12DistanceTypeEb4Type" title="raft::distance::pairwise_distance::Type"><span class="n"><span class="pre">Type</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">dist</span></span>, <a class="reference internal" href="#_CPPv4I00EN4raft8distance17pairwise_distanceEvRKN4raft8handle_tEPK4TypePK4TypeP4Type6Index_6Index_6Index_N4raft8distance12DistanceTypeEb4Type" title="raft::distance::pairwise_distance::Index_"><span class="n"><span class="pre">Index_</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">m</span></span>, <a class="reference internal" href="#_CPPv4I00EN4raft8distance17pairwise_distanceEvRKN4raft8handle_tEPK4TypePK4TypeP4Type6Index_6Index_6Index_N4raft8distance12DistanceTypeEb4Type" title="raft::distance::pairwise_distance::Index_"><span class="n"><span class="pre">Index_</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">n</span></span>, <a class="reference internal" href="#_CPPv4I00EN4raft8distance17pairwise_distanceEvRKN4raft8handle_tEPK4TypePK4TypeP4Type6Index_6Index_6Index_N4raft8distance12DistanceTypeEb4Type" title="raft::distance::pairwise_distance::Index_"><span class="n"><span class="pre">Index_</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">k</span></span>, <span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="#_CPPv4N4raft8distanceE" title="raft::distance"><span class="n"><span class="pre">distance</span></span></a><span class="p"><span class="pre">::</span></span><a class="reference internal" href="#_CPPv4N4raft8distance12DistanceTypeE" title="raft::distance::DistanceType"><span class="n"><span class="pre">DistanceType</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">metric</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">isRowMajor</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">true</span></span>, <a class="reference internal" href="#_CPPv4I00EN4raft8distance17pairwise_distanceEvRKN4raft8handle_tEPK4TypePK4TypeP4Type6Index_6Index_6Index_N4raft8distance12DistanceTypeEb4Type" title="raft::distance::pairwise_distance::Type"><span class="n"><span class="pre">Type</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">metric_arg</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">2.0f</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I00EN4raft8distance17pairwise_distanceEvRKN4raft8handle_tEPK4TypePK4TypeP4Type6Index_6Index_6Index_N4raft8distance12DistanceTypeEb4Type" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Convenience wrapper around &lsquo;distance&rsquo; prim to convert runtime metric into compile time for the purpose of dispatch. </p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Type</strong> &ndash; input/accumulation/output data-type </p></li>
<li><p><strong>Index_</strong> &ndash; indexing type </p></li>
</ul>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>handle</strong> &ndash; raft handle for managing expensive resources </p></li>
<li><p><strong>x</strong> &ndash; first set of points </p></li>
<li><p><strong>y</strong> &ndash; second set of points </p></li>
<li><p><strong>dist</strong> &ndash; output distance matrix </p></li>
<li><p><strong>m</strong> &ndash; number of points in x </p></li>
<li><p><strong>n</strong> &ndash; number of points in y </p></li>
<li><p><strong>k</strong> &ndash; dimensionality </p></li>
<li><p><strong>metric</strong> &ndash; distance metric </p></li>
<li><p><strong>isRowMajor</strong> &ndash; whether the matrices are row-major or col-major </p></li>
<li><p><strong>metric_arg</strong> &ndash; metric argument (used for Minkowski distance) </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I000EN4raft8distance17pairwise_distanceEvRKN4raft8handle_tEK18device_matrix_viewI4Type6Index_6layoutEK18device_matrix_viewI4Type6Index_6layoutE18device_matrix_viewI4Type6Index_6layoutEN4raft8distance12DistanceTypeE4Type">
<span id="_CPPv3I000EN4raft8distance17pairwise_distanceERKN4raft8handle_tEK18device_matrix_viewI4Type6Index_6layoutEK18device_matrix_viewI4Type6Index_6layoutE18device_matrix_viewI4Type6Index_6layoutEN4raft8distance12DistanceTypeE4Type"></span><span id="_CPPv2I000EN4raft8distance17pairwise_distanceERKN4raft8handle_tEK18device_matrix_viewI4Type6Index_6layoutEK18device_matrix_viewI4Type6Index_6layoutE18device_matrix_viewI4Type6Index_6layoutEN4raft8distance12DistanceTypeE4Type"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Type</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">layout</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">layout_c_contiguous</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Index_</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="namespaceraft_1_1distance_1a9b33e196aaa3704790a2ad24df68a3ca"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">pairwise_distance</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="core.html#_CPPv4N4raft8handle_tE" title="raft::handle_t"><span class="n"><span class="pre">handle_t</span></span></a><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">handle</span></span>, <span class="n"><span class="pre">device_matrix_view</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I000EN4raft8distance17pairwise_distanceEvRKN4raft8handle_tEK18device_matrix_viewI4Type6Index_6layoutEK18device_matrix_viewI4Type6Index_6layoutE18device_matrix_viewI4Type6Index_6layoutEN4raft8distance12DistanceTypeE4Type" title="raft::distance::pairwise_distance::Type"><span class="n"><span class="pre">Type</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I000EN4raft8distance17pairwise_distanceEvRKN4raft8handle_tEK18device_matrix_viewI4Type6Index_6layoutEK18device_matrix_viewI4Type6Index_6layoutE18device_matrix_viewI4Type6Index_6layoutEN4raft8distance12DistanceTypeE4Type" title="raft::distance::pairwise_distance::Index_"><span class="n"><span class="pre">Index_</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I000EN4raft8distance17pairwise_distanceEvRKN4raft8handle_tEK18device_matrix_viewI4Type6Index_6layoutEK18device_matrix_viewI4Type6Index_6layoutE18device_matrix_viewI4Type6Index_6layoutEN4raft8distance12DistanceTypeE4Type" title="raft::distance::pairwise_distance::layout"><span class="n"><span class="pre">layout</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">x</span></span>, <span class="n"><span class="pre">device_matrix_view</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I000EN4raft8distance17pairwise_distanceEvRKN4raft8handle_tEK18device_matrix_viewI4Type6Index_6layoutEK18device_matrix_viewI4Type6Index_6layoutE18device_matrix_viewI4Type6Index_6layoutEN4raft8distance12DistanceTypeE4Type" title="raft::distance::pairwise_distance::Type"><span class="n"><span class="pre">Type</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I000EN4raft8distance17pairwise_distanceEvRKN4raft8handle_tEK18device_matrix_viewI4Type6Index_6layoutEK18device_matrix_viewI4Type6Index_6layoutE18device_matrix_viewI4Type6Index_6layoutEN4raft8distance12DistanceTypeE4Type" title="raft::distance::pairwise_distance::Index_"><span class="n"><span class="pre">Index_</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I000EN4raft8distance17pairwise_distanceEvRKN4raft8handle_tEK18device_matrix_viewI4Type6Index_6layoutEK18device_matrix_viewI4Type6Index_6layoutE18device_matrix_viewI4Type6Index_6layoutEN4raft8distance12DistanceTypeE4Type" title="raft::distance::pairwise_distance::layout"><span class="n"><span class="pre">layout</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">y</span></span>, <span class="n"><span class="pre">device_matrix_view</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I000EN4raft8distance17pairwise_distanceEvRKN4raft8handle_tEK18device_matrix_viewI4Type6Index_6layoutEK18device_matrix_viewI4Type6Index_6layoutE18device_matrix_viewI4Type6Index_6layoutEN4raft8distance12DistanceTypeE4Type" title="raft::distance::pairwise_distance::Type"><span class="n"><span class="pre">Type</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I000EN4raft8distance17pairwise_distanceEvRKN4raft8handle_tEK18device_matrix_viewI4Type6Index_6layoutEK18device_matrix_viewI4Type6Index_6layoutE18device_matrix_viewI4Type6Index_6layoutEN4raft8distance12DistanceTypeE4Type" title="raft::distance::pairwise_distance::Index_"><span class="n"><span class="pre">Index_</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I000EN4raft8distance17pairwise_distanceEvRKN4raft8handle_tEK18device_matrix_viewI4Type6Index_6layoutEK18device_matrix_viewI4Type6Index_6layoutE18device_matrix_viewI4Type6Index_6layoutEN4raft8distance12DistanceTypeE4Type" title="raft::distance::pairwise_distance::layout"><span class="n"><span class="pre">layout</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">dist</span></span>, <span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="#_CPPv4N4raft8distanceE" title="raft::distance"><span class="n"><span class="pre">distance</span></span></a><span class="p"><span class="pre">::</span></span><a class="reference internal" href="#_CPPv4N4raft8distance12DistanceTypeE" title="raft::distance::DistanceType"><span class="n"><span class="pre">DistanceType</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">metric</span></span>, <a class="reference internal" href="#_CPPv4I000EN4raft8distance17pairwise_distanceEvRKN4raft8handle_tEK18device_matrix_viewI4Type6Index_6layoutEK18device_matrix_viewI4Type6Index_6layoutE18device_matrix_viewI4Type6Index_6layoutEN4raft8distance12DistanceTypeE4Type" title="raft::distance::pairwise_distance::Type"><span class="n"><span class="pre">Type</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">metric_arg</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">2.0f</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I000EN4raft8distance17pairwise_distanceEvRKN4raft8handle_tEK18device_matrix_viewI4Type6Index_6layoutEK18device_matrix_viewI4Type6Index_6layoutE18device_matrix_viewI4Type6Index_6layoutEN4raft8distance12DistanceTypeE4Type" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Convenience wrapper around &lsquo;distance&rsquo; prim to convert runtime metric into compile time for the purpose of dispatch. </p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Type</strong> &ndash; input/accumulation/output data-type </p></li>
<li><p><strong>Index_</strong> &ndash; indexing type </p></li>
</ul>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>handle</strong> &ndash; raft handle for managing expensive resources </p></li>
<li><p><strong>x</strong> &ndash; first matrix of points (size mxk) </p></li>
<li><p><strong>y</strong> &ndash; second matrix of points (size nxk) </p></li>
<li><p><strong>dist</strong> &ndash; output distance matrix (size mxn) </p></li>
<li><p><strong>metric</strong> &ndash; distance metric </p></li>
<li><p><strong>metric_arg</strong> &ndash; metric argument (used for Minkowski distance) </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0000EN4raft8distance10initializeEvRKN4raft8handle_tEP4OutT4IdxT5DataT9ReduceOpT">
<span id="_CPPv3I0000EN4raft8distance10initializeERKN4raft8handle_tEP4OutT4IdxT5DataT9ReduceOpT"></span><span id="_CPPv2I0000EN4raft8distance10initializeERKN4raft8handle_tEP4OutT4IdxT5DataT9ReduceOpT"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">DataT</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">OutT</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">IdxT</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ReduceOpT</span></span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="namespaceraft_1_1distance_1a8d3c8c84ddc2e9d8fc282a8fc4b787f6"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">initialize</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="core.html#_CPPv4N4raft8handle_tE" title="raft::handle_t"><span class="n"><span class="pre">handle_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">handle</span></span>, <a class="reference internal" href="#_CPPv4I0000EN4raft8distance10initializeEvRKN4raft8handle_tEP4OutT4IdxT5DataT9ReduceOpT" title="raft::distance::initialize::OutT"><span class="n"><span class="pre">OutT</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">min</span></span>, <a class="reference internal" href="#_CPPv4I0000EN4raft8distance10initializeEvRKN4raft8handle_tEP4OutT4IdxT5DataT9ReduceOpT" title="raft::distance::initialize::IdxT"><span class="n"><span class="pre">IdxT</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">m</span></span>, <a class="reference internal" href="#_CPPv4I0000EN4raft8distance10initializeEvRKN4raft8handle_tEP4OutT4IdxT5DataT9ReduceOpT" title="raft::distance::initialize::DataT"><span class="n"><span class="pre">DataT</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">maxVal</span></span>, <a class="reference internal" href="#_CPPv4I0000EN4raft8distance10initializeEvRKN4raft8handle_tEP4OutT4IdxT5DataT9ReduceOpT" title="raft::distance::initialize::ReduceOpT"><span class="n"><span class="pre">ReduceOpT</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">redOp</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I0000EN4raft8distance10initializeEvRKN4raft8handle_tEP4OutT4IdxT5DataT9ReduceOpT" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Initialize array using init value from reduction op </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I00000EN4raft8distance9fusedL2NNEvP4OutTPK5DataTPK5DataTPK5DataTPK5DataT4IdxT4IdxT4IdxTPv9ReduceOpT12KVPReduceOpTbb12cudaStream_t">
<span id="_CPPv3I00000EN4raft8distance9fusedL2NNEP4OutTPK5DataTPK5DataTPK5DataTPK5DataT4IdxT4IdxT4IdxTPv9ReduceOpT12KVPReduceOpTbb12cudaStream_t"></span><span id="_CPPv2I00000EN4raft8distance9fusedL2NNEP4OutTPK5DataTPK5DataTPK5DataTPK5DataT4IdxT4IdxT4IdxTPv9ReduceOpT12KVPReduceOpTbb12cudaStream_t"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">DataT</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">OutT</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">IdxT</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ReduceOpT</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">KVPReduceOpT</span></span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="namespaceraft_1_1distance_1a00a2383d2785d2962b7ea2e01ee5d491"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">fusedL2NN</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4I00000EN4raft8distance9fusedL2NNEvP4OutTPK5DataTPK5DataTPK5DataTPK5DataT4IdxT4IdxT4IdxTPv9ReduceOpT12KVPReduceOpTbb12cudaStream_t" title="raft::distance::fusedL2NN::OutT"><span class="n"><span class="pre">OutT</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">min</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00000EN4raft8distance9fusedL2NNEvP4OutTPK5DataTPK5DataTPK5DataTPK5DataT4IdxT4IdxT4IdxTPv9ReduceOpT12KVPReduceOpTbb12cudaStream_t" title="raft::distance::fusedL2NN::DataT"><span class="n"><span class="pre">DataT</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">x</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00000EN4raft8distance9fusedL2NNEvP4OutTPK5DataTPK5DataTPK5DataTPK5DataT4IdxT4IdxT4IdxTPv9ReduceOpT12KVPReduceOpTbb12cudaStream_t" title="raft::distance::fusedL2NN::DataT"><span class="n"><span class="pre">DataT</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">y</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00000EN4raft8distance9fusedL2NNEvP4OutTPK5DataTPK5DataTPK5DataTPK5DataT4IdxT4IdxT4IdxTPv9ReduceOpT12KVPReduceOpTbb12cudaStream_t" title="raft::distance::fusedL2NN::DataT"><span class="n"><span class="pre">DataT</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">xn</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00000EN4raft8distance9fusedL2NNEvP4OutTPK5DataTPK5DataTPK5DataTPK5DataT4IdxT4IdxT4IdxTPv9ReduceOpT12KVPReduceOpTbb12cudaStream_t" title="raft::distance::fusedL2NN::DataT"><span class="n"><span class="pre">DataT</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">yn</span></span>, <a class="reference internal" href="#_CPPv4I00000EN4raft8distance9fusedL2NNEvP4OutTPK5DataTPK5DataTPK5DataTPK5DataT4IdxT4IdxT4IdxTPv9ReduceOpT12KVPReduceOpTbb12cudaStream_t" title="raft::distance::fusedL2NN::IdxT"><span class="n"><span class="pre">IdxT</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">m</span></span>, <a class="reference internal" href="#_CPPv4I00000EN4raft8distance9fusedL2NNEvP4OutTPK5DataTPK5DataTPK5DataTPK5DataT4IdxT4IdxT4IdxTPv9ReduceOpT12KVPReduceOpTbb12cudaStream_t" title="raft::distance::fusedL2NN::IdxT"><span class="n"><span class="pre">IdxT</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">n</span></span>, <a class="reference internal" href="#_CPPv4I00000EN4raft8distance9fusedL2NNEvP4OutTPK5DataTPK5DataTPK5DataTPK5DataT4IdxT4IdxT4IdxTPv9ReduceOpT12KVPReduceOpTbb12cudaStream_t" title="raft::distance::fusedL2NN::IdxT"><span class="n"><span class="pre">IdxT</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">k</span></span>, <span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">workspace</span></span>, <a class="reference internal" href="#_CPPv4I00000EN4raft8distance9fusedL2NNEvP4OutTPK5DataTPK5DataTPK5DataTPK5DataT4IdxT4IdxT4IdxTPv9ReduceOpT12KVPReduceOpTbb12cudaStream_t" title="raft::distance::fusedL2NN::ReduceOpT"><span class="n"><span class="pre">ReduceOpT</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">redOp</span></span>, <a class="reference internal" href="#_CPPv4I00000EN4raft8distance9fusedL2NNEvP4OutTPK5DataTPK5DataTPK5DataTPK5DataT4IdxT4IdxT4IdxTPv9ReduceOpT12KVPReduceOpTbb12cudaStream_t" title="raft::distance::fusedL2NN::KVPReduceOpT"><span class="n"><span class="pre">KVPReduceOpT</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">pairRedOp</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">sqrt</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">initOutBuffer</span></span>, <span class="n"><span class="pre">cudaStream_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">stream</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I00000EN4raft8distance9fusedL2NNEvP4OutTPK5DataTPK5DataTPK5DataTPK5DataT4IdxT4IdxT4IdxTPv9ReduceOpT12KVPReduceOpTbb12cudaStream_t" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Fused L2 distance and 1-nearest-neighbor computation in a single call. </p>
<p>The benefits of such a call are 2-fold: 1) eliminate the need for an intermediate buffer to store the output of gemm 2) reduce the memory read traffic on this intermediate buffer, otherwise needed during the reduction phase for 1-NN.</p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>DataT</strong> &ndash; data type </p></li>
<li><p><strong>OutT</strong> &ndash; output type to either store 1-NN indices and their minimum distances or store only the min distances. Accordingly, one has to pass an appropriate <code class="docutils literal notranslate"><span class="pre">ReduceOpT</span></code> </p></li>
<li><p><strong>IdxT</strong> &ndash; indexing arithmetic type </p></li>
<li><p><strong>ReduceOpT</strong> &ndash; A struct to perform the final needed reduction operation and also to initialize the output array elements with the appropriate initial value needed for reduction.</p></li>
</ul>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>min</strong> &ndash; <strong>[out]</strong> will contain the reduced output (Length = <code class="docutils literal notranslate"><span class="pre">m</span></code>) (on device) </p></li>
<li><p><strong>x</strong> &ndash; <strong>[in]</strong> first matrix. Row major. Dim = <code class="docutils literal notranslate"><span class="pre">m</span> <span class="pre">x</span> <span class="pre">k</span></code>. (on device). </p></li>
<li><p><strong>y</strong> &ndash; <strong>[in]</strong> second matrix. Row major. Dim = <code class="docutils literal notranslate"><span class="pre">n</span> <span class="pre">x</span> <span class="pre">k</span></code>. (on device). </p></li>
<li><p><strong>xn</strong> &ndash; <strong>[in]</strong> L2 squared norm of <code class="docutils literal notranslate"><span class="pre">x</span></code>. Length = <code class="docutils literal notranslate"><span class="pre">m</span></code>. (on device). </p></li>
<li><p><strong>yn</strong> &ndash; <strong>[in]</strong> L2 squared norm of <code class="docutils literal notranslate"><span class="pre">y</span></code>. Length = <code class="docutils literal notranslate"><span class="pre">n</span></code>. (on device) </p></li>
<li><p><strong>m</strong> &ndash; <strong>[in]</strong> gemm m </p></li>
<li><p><strong>n</strong> &ndash; <strong>[in]</strong> gemm n </p></li>
<li><p><strong>k</strong> &ndash; <strong>[in]</strong> gemm k </p></li>
<li><p><strong>workspace</strong> &ndash; <strong>[in]</strong> temp workspace. Size = sizeof(int)*m. (on device) </p></li>
<li><p><strong>redOp</strong> &ndash; <strong>[in]</strong> reduction operator in the epilogue </p></li>
<li><p><strong>pairRedOp</strong> &ndash; <strong>[in]</strong> reduction operation on key value pairs </p></li>
<li><p><strong>sqrt</strong> &ndash; <strong>[in]</strong> Whether the output <code class="docutils literal notranslate"><span class="pre">minDist</span></code> should contain L2-sqrt </p></li>
<li><p><strong>initOutBuffer</strong> &ndash; <strong>[in]</strong> whether to initialize the output buffer before the main kernel launch </p></li>
<li><p><strong>stream</strong> &ndash; <strong>[in]</strong> cuda stream </p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<dl class="cpp type">
<dt class="sig sig-object cpp" id="_CPPv4N4raft8distance7runtimeE">
<span id="_CPPv3N4raft8distance7runtimeE"></span><span id="_CPPv2N4raft8distance7runtimeE"></span><span id="raft::distance::runtime"></span><span class="target" id="namespaceraft_1_1distance_1_1runtime"></span><span class="k"><span class="pre">namespace</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">runtime</span></span></span><a class="headerlink" href="#_CPPv4N4raft8distance7runtimeE" title="Permalink to this definition">&para;</a><br></dt>
<dd><div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-functions">Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4raft8distance7runtime17pairwise_distanceERKN4raft8handle_tEPfPfPfiiiN4raft8distance12DistanceTypeEbf">
<span id="_CPPv3N4raft8distance7runtime17pairwise_distanceERKN4raft8handle_tEPfPfPfiiiN4raft8distance12DistanceTypeEbf"></span><span id="_CPPv2N4raft8distance7runtime17pairwise_distanceERKN4raft8handle_tEPfPfPfiiiN4raft8distance12DistanceTypeEbf"></span><span id="raft::distance::runtime::pairwise_distance__raft::handle_tCR.floatP.floatP.floatP.i.i.i.raft::distance::DistanceType.b.float"></span><span class="target" id="namespaceraft_1_1distance_1_1runtime_1a0913983595ea9ae13af305048cd3d2d7"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">pairwise_distance</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="core.html#_CPPv4N4raft8handle_tE" title="raft::handle_t"><span class="n"><span class="pre">handle_t</span></span></a><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">handle</span></span>, <span class="kt"><span class="pre">float</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">x</span></span>, <span class="kt"><span class="pre">float</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">y</span></span>, <span class="kt"><span class="pre">float</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">dists</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">m</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">n</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">k</span></span>, <span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="#_CPPv4N4raft8distanceE" title="raft::distance"><span class="n"><span class="pre">distance</span></span></a><span class="p"><span class="pre">::</span></span><a class="reference internal" href="#_CPPv4N4raft8distance12DistanceTypeE" title="raft::distance::DistanceType"><span class="n"><span class="pre">DistanceType</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">metric</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">isRowMajor</span></span>, <span class="kt"><span class="pre">float</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">metric_arg</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4raft8distance7runtime17pairwise_distanceERKN4raft8handle_tEPfPfPfiiiN4raft8distance12DistanceTypeEbf" title="Permalink to this definition">&para;</a><br></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4raft8distance7runtime17pairwise_distanceERKN4raft8handle_tEPdPdPdiiiN4raft8distance12DistanceTypeEbf">
<span id="_CPPv3N4raft8distance7runtime17pairwise_distanceERKN4raft8handle_tEPdPdPdiiiN4raft8distance12DistanceTypeEbf"></span><span id="_CPPv2N4raft8distance7runtime17pairwise_distanceERKN4raft8handle_tEPdPdPdiiiN4raft8distance12DistanceTypeEbf"></span><span id="raft::distance::runtime::pairwise_distance__raft::handle_tCR.doubleP.doubleP.doubleP.i.i.i.raft::distance::DistanceType.b.float"></span><span class="target" id="namespaceraft_1_1distance_1_1runtime_1a58e6972cd916cd9a70d35907181036f4"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">pairwise_distance</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="core.html#_CPPv4N4raft8handle_tE" title="raft::handle_t"><span class="n"><span class="pre">handle_t</span></span></a><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">handle</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">x</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">y</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">dists</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">m</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">n</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">k</span></span>, <span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="#_CPPv4N4raft8distanceE" title="raft::distance"><span class="n"><span class="pre">distance</span></span></a><span class="p"><span class="pre">::</span></span><a class="reference internal" href="#_CPPv4N4raft8distance12DistanceTypeE" title="raft::distance::DistanceType"><span class="n"><span class="pre">DistanceType</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">metric</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">isRowMajor</span></span>, <span class="kt"><span class="pre">float</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">metric_arg</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4raft8distance7runtime17pairwise_distanceERKN4raft8handle_tEPdPdPdiiiN4raft8distance12DistanceTypeEbf" title="Permalink to this definition">&para;</a><br></dt>
<dd></dd></dl>

</div>
</dd></dl>

</dd></dl>

</section>
<section id="nearest-neighbors">
<h2>Nearest Neighbors<a class="headerlink" href="#nearest-neighbors" title="Permalink to this heading">&para;</a></h2>
<dl class="cpp type">
<dt class="sig sig-object cpp" id="_CPPv4N4raft7spatial3knnE">
<span id="_CPPv3N4raft7spatial3knnE"></span><span id="_CPPv2N4raft7spatial3knnE"></span><span id="raft::spatial::knn"></span><span class="target" id="namespaceraft_1_1spatial_1_1knn"></span><span class="k"><span class="pre">namespace</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">knn</span></span></span><a class="headerlink" href="#_CPPv4N4raft7spatial3knnE" title="Permalink to this definition">&para;</a><br></dt>
<dd><div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-enums">Enums</p>
<dl class="cpp enum-class">
<dt class="sig sig-object cpp" id="_CPPv4N4raft7spatial3knn11SelectKAlgoE">
<span id="_CPPv3N4raft7spatial3knn11SelectKAlgoE"></span><span id="_CPPv2N4raft7spatial3knn11SelectKAlgoE"></span><span class="target" id="namespaceraft_1_1spatial_1_1knn_1a7312e4277a4a17ddef652d4fe630c077"></span><span class="k"><span class="pre">enum</span></span><span class="w"> </span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">SelectKAlgo</span></span></span><a class="headerlink" href="#_CPPv4N4raft7spatial3knn11SelectKAlgoE" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Choose an implementation for the select-top-k, </p>
<p><em>Values:</em></p>
<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N4raft7spatial3knn11SelectKAlgo5FAISSE">
<span id="_CPPv3N4raft7spatial3knn11SelectKAlgo5FAISSE"></span><span id="_CPPv2N4raft7spatial3knn11SelectKAlgo5FAISSE"></span><span class="target" id="namespaceraft_1_1spatial_1_1knn_1a7312e4277a4a17ddef652d4fe630c077ab43c5ca08091da8036f21e54e5167743"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">FAISS</span></span></span><a class="headerlink" href="#_CPPv4N4raft7spatial3knn11SelectKAlgo5FAISSE" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Adapted from the faiss project. Result: sorted (not stable). </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N4raft7spatial3knn11SelectKAlgo12RADIX_8_BITSE">
<span id="_CPPv3N4raft7spatial3knn11SelectKAlgo12RADIX_8_BITSE"></span><span id="_CPPv2N4raft7spatial3knn11SelectKAlgo12RADIX_8_BITSE"></span><span class="target" id="namespaceraft_1_1spatial_1_1knn_1a7312e4277a4a17ddef652d4fe630c077a7c6e24edcfb7505cd1bfc2ae83067b22"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">RADIX_8_BITS</span></span></span><a class="headerlink" href="#_CPPv4N4raft7spatial3knn11SelectKAlgo12RADIX_8_BITSE" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Incomplete series of radix sort passes, comparing 8 bits per pass. Result: unsorted. </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N4raft7spatial3knn11SelectKAlgo13RADIX_11_BITSE">
<span id="_CPPv3N4raft7spatial3knn11SelectKAlgo13RADIX_11_BITSE"></span><span id="_CPPv2N4raft7spatial3knn11SelectKAlgo13RADIX_11_BITSE"></span><span class="target" id="namespaceraft_1_1spatial_1_1knn_1a7312e4277a4a17ddef652d4fe630c077ad7278fb166109a89ebdd92597f8152a7"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">RADIX_11_BITS</span></span></span><a class="headerlink" href="#_CPPv4N4raft7spatial3knn11SelectKAlgo13RADIX_11_BITSE" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Incomplete series of radix sort passes, comparing 11 bits per pass. Result: unsorted. </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N4raft7spatial3knn11SelectKAlgo9WARP_SORTE">
<span id="_CPPv3N4raft7spatial3knn11SelectKAlgo9WARP_SORTE"></span><span id="_CPPv2N4raft7spatial3knn11SelectKAlgo9WARP_SORTE"></span><span class="target" id="namespaceraft_1_1spatial_1_1knn_1a7312e4277a4a17ddef652d4fe630c077a4b50e4b988b6196b0aa46482da3e87d8"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">WARP_SORT</span></span></span><a class="headerlink" href="#_CPPv4N4raft7spatial3knn11SelectKAlgo9WARP_SORTE" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Filtering with a bitonic-sort-based priority queue. Result: sorted (not stable). </p>
</dd></dl>

</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-functions">Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I00EN4raft7spatial3knn22approx_knn_build_indexEvRN4raft8handle_tEPN4raft7spatial3knn8knnIndexEP13knnIndexParamN4raft8distance12DistanceTypeEfP1T9value_idx9value_idx">
<span id="_CPPv3I00EN4raft7spatial3knn22approx_knn_build_indexERN4raft8handle_tEPN4raft7spatial3knn8knnIndexEP13knnIndexParamN4raft8distance12DistanceTypeEfP1T9value_idx9value_idx"></span><span id="_CPPv2I00EN4raft7spatial3knn22approx_knn_build_indexERN4raft8handle_tEPN4raft7spatial3knn8knnIndexEP13knnIndexParamN4raft8distance12DistanceTypeEfP1T9value_idx9value_idx"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="kt"><span class="pre">float</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">value_idx</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="namespaceraft_1_1spatial_1_1knn_1a5242d3f0b15ddd7ec068178e6f2e24f7"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">approx_knn_build_index</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="core.html#_CPPv4N4raft8handle_tE" title="raft::handle_t"><span class="n"><span class="pre">handle_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">handle</span></span>, <span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">spatial</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="#_CPPv4N4raft7spatial3knnE" title="raft::spatial::knn"><span class="n"><span class="pre">knn</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">knnIndex</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">index</span></span>, <span class="n"><span class="pre">knnIndexParam</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">params</span></span>, <span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="#_CPPv4N4raft8distanceE" title="raft::distance"><span class="n"><span class="pre">distance</span></span></a><span class="p"><span class="pre">::</span></span><a class="reference internal" href="#_CPPv4N4raft8distance12DistanceTypeE" title="raft::distance::DistanceType"><span class="n"><span class="pre">DistanceType</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">metric</span></span>, <span class="kt"><span class="pre">float</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">metricArg</span></span>, <a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn22approx_knn_build_indexEvRN4raft8handle_tEPN4raft7spatial3knn8knnIndexEP13knnIndexParamN4raft8distance12DistanceTypeEfP1T9value_idx9value_idx" title="raft::spatial::knn::approx_knn_build_index::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">index_array</span></span>, <a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn22approx_knn_build_indexEvRN4raft8handle_tEPN4raft7spatial3knn8knnIndexEP13knnIndexParamN4raft8distance12DistanceTypeEfP1T9value_idx9value_idx" title="raft::spatial::knn::approx_knn_build_index::value_idx"><span class="n"><span class="pre">value_idx</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">n</span></span>, <a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn22approx_knn_build_indexEvRN4raft8handle_tEPN4raft7spatial3knn8knnIndexEP13knnIndexParamN4raft8distance12DistanceTypeEfP1T9value_idx9value_idx" title="raft::spatial::knn::approx_knn_build_index::value_idx"><span class="n"><span class="pre">value_idx</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">D</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I00EN4raft7spatial3knn22approx_knn_build_indexEvRN4raft8handle_tEPN4raft7spatial3knn8knnIndexEP13knnIndexParamN4raft8distance12DistanceTypeEfP1T9value_idx9value_idx" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Flat C++ API function to build an approximate nearest neighbors index from an index array and a set of parameters. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>handle</strong> &ndash; <strong>[in]</strong> RAFT handle </p></li>
<li><p><strong>index</strong> &ndash; <strong>[out]</strong> index to be built </p></li>
<li><p><strong>params</strong> &ndash; <strong>[in]</strong> parametrization of the index to be built </p></li>
<li><p><strong>metric</strong> &ndash; <strong>[in]</strong> distance metric to use. Euclidean (L2) is used by default </p></li>
<li><p><strong>metricArg</strong> &ndash; <strong>[in]</strong> metric argument </p></li>
<li><p><strong>index_array</strong> &ndash; <strong>[in]</strong> the index array to build the index with </p></li>
<li><p><strong>n</strong> &ndash; <strong>[in]</strong> number of rows in the index array </p></li>
<li><p><strong>D</strong> &ndash; <strong>[in]</strong> the dimensionality of the index array </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I00EN4raft7spatial3knn17approx_knn_searchEvRN4raft8handle_tEPfP7int64_tPN4raft7spatial3knn8knnIndexE9value_idxP1T9value_idx">
<span id="_CPPv3I00EN4raft7spatial3knn17approx_knn_searchERN4raft8handle_tEPfP7int64_tPN4raft7spatial3knn8knnIndexE9value_idxP1T9value_idx"></span><span id="_CPPv2I00EN4raft7spatial3knn17approx_knn_searchERN4raft8handle_tEPfP7int64_tPN4raft7spatial3knn8knnIndexE9value_idxP1T9value_idx"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="kt"><span class="pre">float</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">value_idx</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="namespaceraft_1_1spatial_1_1knn_1aca6a8115da0d843756c6019c6a29136b"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">approx_knn_search</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="core.html#_CPPv4N4raft8handle_tE" title="raft::handle_t"><span class="n"><span class="pre">handle_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">handle</span></span>, <span class="kt"><span class="pre">float</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">distances</span></span>, <span class="n"><span class="pre">int64_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">indices</span></span>, <span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">spatial</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="#_CPPv4N4raft7spatial3knnE" title="raft::spatial::knn"><span class="n"><span class="pre">knn</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">knnIndex</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">index</span></span>, <a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn17approx_knn_searchEvRN4raft8handle_tEPfP7int64_tPN4raft7spatial3knn8knnIndexE9value_idxP1T9value_idx" title="raft::spatial::knn::approx_knn_search::value_idx"><span class="n"><span class="pre">value_idx</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">k</span></span>, <a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn17approx_knn_searchEvRN4raft8handle_tEPfP7int64_tPN4raft7spatial3knn8knnIndexE9value_idxP1T9value_idx" title="raft::spatial::knn::approx_knn_search::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">query_array</span></span>, <a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn17approx_knn_searchEvRN4raft8handle_tEPfP7int64_tPN4raft7spatial3knn8knnIndexE9value_idxP1T9value_idx" title="raft::spatial::knn::approx_knn_search::value_idx"><span class="n"><span class="pre">value_idx</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">n</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I00EN4raft7spatial3knn17approx_knn_searchEvRN4raft8handle_tEPfP7int64_tPN4raft7spatial3knn8knnIndexE9value_idxP1T9value_idx" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Flat C++ API function to perform an approximate nearest neighbors search from previously built index and a query array. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>handle</strong> &ndash; <strong>[in]</strong> RAFT handle </p></li>
<li><p><strong>distances</strong> &ndash; <strong>[out]</strong> distances of the nearest neighbors toward their query point </p></li>
<li><p><strong>indices</strong> &ndash; <strong>[out]</strong> indices of the nearest neighbors </p></li>
<li><p><strong>index</strong> &ndash; <strong>[in]</strong> index to perform a search with </p></li>
<li><p><strong>k</strong> &ndash; <strong>[in]</strong> the number of nearest neighbors to search for </p></li>
<li><p><strong>query_array</strong> &ndash; <strong>[in]</strong> the query to perform a search with </p></li>
<li><p><strong>n</strong> &ndash; <strong>[in]</strong> number of rows in the query array </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I000EN4raft7spatial3knn15rbc_build_indexEvRKN4raft8handle_tER14BallCoverIndexI9value_idx7value_t9value_intE">
<span id="_CPPv3I000EN4raft7spatial3knn15rbc_build_indexERKN4raft8handle_tER14BallCoverIndexI9value_idx7value_t9value_intE"></span><span id="_CPPv2I000EN4raft7spatial3knn15rbc_build_indexERKN4raft8handle_tER14BallCoverIndexI9value_idx7value_t9value_intE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">value_idx</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int64_t</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">value_t</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">value_int</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">uint32_t</span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="namespaceraft_1_1spatial_1_1knn_1a8a42099b9b596201e235e15d1dfbd3a0"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">rbc_build_index</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="core.html#_CPPv4N4raft8handle_tE" title="raft::handle_t"><span class="n"><span class="pre">handle_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">handle</span></span>, <span class="n"><span class="pre">BallCoverIndex</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I000EN4raft7spatial3knn15rbc_build_indexEvRKN4raft8handle_tER14BallCoverIndexI9value_idx7value_t9value_intE" title="raft::spatial::knn::rbc_build_index::value_idx"><span class="n"><span class="pre">value_idx</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I000EN4raft7spatial3knn15rbc_build_indexEvRKN4raft8handle_tER14BallCoverIndexI9value_idx7value_t9value_intE" title="raft::spatial::knn::rbc_build_index::value_t"><span class="n"><span class="pre">value_t</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I000EN4raft7spatial3knn15rbc_build_indexEvRKN4raft8handle_tER14BallCoverIndexI9value_idx7value_t9value_intE" title="raft::spatial::knn::rbc_build_index::value_int"><span class="n"><span class="pre">value_int</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">index</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I000EN4raft7spatial3knn15rbc_build_indexEvRKN4raft8handle_tER14BallCoverIndexI9value_idx7value_t9value_intE" title="Permalink to this definition">&para;</a><br></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I000EN4raft7spatial3knn17rbc_all_knn_queryEvRKN4raft8handle_tER14BallCoverIndexI9value_idx7value_t9value_intE9value_intP9value_idxP7value_tbf">
<span id="_CPPv3I000EN4raft7spatial3knn17rbc_all_knn_queryERKN4raft8handle_tER14BallCoverIndexI9value_idx7value_t9value_intE9value_intP9value_idxP7value_tbf"></span><span id="_CPPv2I000EN4raft7spatial3knn17rbc_all_knn_queryERKN4raft8handle_tER14BallCoverIndexI9value_idx7value_t9value_intE9value_intP9value_idxP7value_tbf"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">value_idx</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int64_t</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">value_t</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">value_int</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">uint32_t</span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="namespaceraft_1_1spatial_1_1knn_1abda779504786d21ab71d27bdd31c1fa0"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">rbc_all_knn_query</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="core.html#_CPPv4N4raft8handle_tE" title="raft::handle_t"><span class="n"><span class="pre">handle_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">handle</span></span>, <span class="n"><span class="pre">BallCoverIndex</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I000EN4raft7spatial3knn17rbc_all_knn_queryEvRKN4raft8handle_tER14BallCoverIndexI9value_idx7value_t9value_intE9value_intP9value_idxP7value_tbf" title="raft::spatial::knn::rbc_all_knn_query::value_idx"><span class="n"><span class="pre">value_idx</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I000EN4raft7spatial3knn17rbc_all_knn_queryEvRKN4raft8handle_tER14BallCoverIndexI9value_idx7value_t9value_intE9value_intP9value_idxP7value_tbf" title="raft::spatial::knn::rbc_all_knn_query::value_t"><span class="n"><span class="pre">value_t</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I000EN4raft7spatial3knn17rbc_all_knn_queryEvRKN4raft8handle_tER14BallCoverIndexI9value_idx7value_t9value_intE9value_intP9value_idxP7value_tbf" title="raft::spatial::knn::rbc_all_knn_query::value_int"><span class="n"><span class="pre">value_int</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">index</span></span>, <a class="reference internal" href="#_CPPv4I000EN4raft7spatial3knn17rbc_all_knn_queryEvRKN4raft8handle_tER14BallCoverIndexI9value_idx7value_t9value_intE9value_intP9value_idxP7value_tbf" title="raft::spatial::knn::rbc_all_knn_query::value_int"><span class="n"><span class="pre">value_int</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">k</span></span>, <a class="reference internal" href="#_CPPv4I000EN4raft7spatial3knn17rbc_all_knn_queryEvRKN4raft8handle_tER14BallCoverIndexI9value_idx7value_t9value_intE9value_intP9value_idxP7value_tbf" title="raft::spatial::knn::rbc_all_knn_query::value_idx"><span class="n"><span class="pre">value_idx</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">inds</span></span>, <a class="reference internal" href="#_CPPv4I000EN4raft7spatial3knn17rbc_all_knn_queryEvRKN4raft8handle_tER14BallCoverIndexI9value_idx7value_t9value_intE9value_intP9value_idxP7value_tbf" title="raft::spatial::knn::rbc_all_knn_query::value_t"><span class="n"><span class="pre">value_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">dists</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">perform_post_filtering</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">true</span></span>, <span class="kt"><span class="pre">float</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">weight</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">1.0</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I000EN4raft7spatial3knn17rbc_all_knn_queryEvRKN4raft8handle_tER14BallCoverIndexI9value_idx7value_t9value_intE9value_intP9value_idxP7value_tbf" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Performs a faster exact knn in metric spaces using the triangle inequality with a number of landmark points to reduce the number of distance computations from O(n^2) to O(sqrt(n)). This performs an all neighbors knn, which can reuse memory when the index and query are the same array. This function will build the index and assumes <a class="reference internal" href="#namespaceraft_1_1spatial_1_1knn_1a8a42099b9b596201e235e15d1dfbd3a0"><span class="std std-ref">rbc_build_index()</span></a> has not already been called. </p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>value_idx</strong> &ndash; knn index type </p></li>
<li><p><strong>value_t</strong> &ndash; knn distance type </p></li>
<li><p><strong>value_int</strong> &ndash; type for integers, such as number of rows/cols </p></li>
</ul>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>handle</strong> &ndash; raft handle for resource management </p></li>
<li><p><strong>index</strong> &ndash; ball cover index which has not yet been built </p></li>
<li><p><strong>k</strong> &ndash; number of nearest neighbors to find </p></li>
<li><p><strong>perform_post_filtering</strong> &ndash; if this is false, only the closest k landmarks are considered (which will return approximate results). </p></li>
<li><p><strong>inds</strong> &ndash; <strong>[out]</strong> output knn indices </p></li>
<li><p><strong>dists</strong> &ndash; <strong>[out]</strong> output knn distances </p></li>
<li><p><strong>weight</strong> &ndash; a weight for overlap between the closest landmark and the radius of other landmarks when pruning distances. Setting this value below 1 can effectively turn off computing distances against many other balls, enabling approximate nearest neighbors. Recall can be adjusted based on how many relevant balls are ignored. Note that many datasets can still have great recall even by only looking in the closest landmark. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I000EN4raft7spatial3knn13rbc_knn_queryEvRKN4raft8handle_tER14BallCoverIndexI9value_idx7value_t9value_intE9value_intPK7value_t9value_intP9value_idxP7value_tbf">
<span id="_CPPv3I000EN4raft7spatial3knn13rbc_knn_queryERKN4raft8handle_tER14BallCoverIndexI9value_idx7value_t9value_intE9value_intPK7value_t9value_intP9value_idxP7value_tbf"></span><span id="_CPPv2I000EN4raft7spatial3knn13rbc_knn_queryERKN4raft8handle_tER14BallCoverIndexI9value_idx7value_t9value_intE9value_intPK7value_t9value_intP9value_idxP7value_tbf"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">value_idx</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int64_t</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">value_t</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">value_int</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">uint32_t</span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="namespaceraft_1_1spatial_1_1knn_1a45efa41956d3ade7e79b32f907af6bfc"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">rbc_knn_query</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="core.html#_CPPv4N4raft8handle_tE" title="raft::handle_t"><span class="n"><span class="pre">handle_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">handle</span></span>, <span class="n"><span class="pre">BallCoverIndex</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I000EN4raft7spatial3knn13rbc_knn_queryEvRKN4raft8handle_tER14BallCoverIndexI9value_idx7value_t9value_intE9value_intPK7value_t9value_intP9value_idxP7value_tbf" title="raft::spatial::knn::rbc_knn_query::value_idx"><span class="n"><span class="pre">value_idx</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I000EN4raft7spatial3knn13rbc_knn_queryEvRKN4raft8handle_tER14BallCoverIndexI9value_idx7value_t9value_intE9value_intPK7value_t9value_intP9value_idxP7value_tbf" title="raft::spatial::knn::rbc_knn_query::value_t"><span class="n"><span class="pre">value_t</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I000EN4raft7spatial3knn13rbc_knn_queryEvRKN4raft8handle_tER14BallCoverIndexI9value_idx7value_t9value_intE9value_intPK7value_t9value_intP9value_idxP7value_tbf" title="raft::spatial::knn::rbc_knn_query::value_int"><span class="n"><span class="pre">value_int</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">index</span></span>, <a class="reference internal" href="#_CPPv4I000EN4raft7spatial3knn13rbc_knn_queryEvRKN4raft8handle_tER14BallCoverIndexI9value_idx7value_t9value_intE9value_intPK7value_t9value_intP9value_idxP7value_tbf" title="raft::spatial::knn::rbc_knn_query::value_int"><span class="n"><span class="pre">value_int</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">k</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I000EN4raft7spatial3knn13rbc_knn_queryEvRKN4raft8handle_tER14BallCoverIndexI9value_idx7value_t9value_intE9value_intPK7value_t9value_intP9value_idxP7value_tbf" title="raft::spatial::knn::rbc_knn_query::value_t"><span class="n"><span class="pre">value_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">query</span></span>, <a class="reference internal" href="#_CPPv4I000EN4raft7spatial3knn13rbc_knn_queryEvRKN4raft8handle_tER14BallCoverIndexI9value_idx7value_t9value_intE9value_intPK7value_t9value_intP9value_idxP7value_tbf" title="raft::spatial::knn::rbc_knn_query::value_int"><span class="n"><span class="pre">value_int</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">n_query_pts</span></span>, <a class="reference internal" href="#_CPPv4I000EN4raft7spatial3knn13rbc_knn_queryEvRKN4raft8handle_tER14BallCoverIndexI9value_idx7value_t9value_intE9value_intPK7value_t9value_intP9value_idxP7value_tbf" title="raft::spatial::knn::rbc_knn_query::value_idx"><span class="n"><span class="pre">value_idx</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">inds</span></span>, <a class="reference internal" href="#_CPPv4I000EN4raft7spatial3knn13rbc_knn_queryEvRKN4raft8handle_tER14BallCoverIndexI9value_idx7value_t9value_intE9value_intPK7value_t9value_intP9value_idxP7value_tbf" title="raft::spatial::knn::rbc_knn_query::value_t"><span class="n"><span class="pre">value_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">dists</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">perform_post_filtering</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">true</span></span>, <span class="kt"><span class="pre">float</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">weight</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">1.0</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I000EN4raft7spatial3knn13rbc_knn_queryEvRKN4raft8handle_tER14BallCoverIndexI9value_idx7value_t9value_intE9value_intPK7value_t9value_intP9value_idxP7value_tbf" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Performs a faster exact knn in metric spaces using the triangle inequality with a number of landmark points to reduce the number of distance computations from O(n^2) to O(sqrt(n)). This function does not build the index and assumes <a class="reference internal" href="#namespaceraft_1_1spatial_1_1knn_1a8a42099b9b596201e235e15d1dfbd3a0"><span class="std std-ref">rbc_build_index()</span></a> has already been called. Use this function when the index and query arrays are different, otherwise use <a class="reference internal" href="#namespaceraft_1_1spatial_1_1knn_1abda779504786d21ab71d27bdd31c1fa0"><span class="std std-ref">rbc_all_knn_query()</span></a>. </p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>value_idx</strong> &ndash; index type </p></li>
<li><p><strong>value_t</strong> &ndash; distances type </p></li>
<li><p><strong>value_int</strong> &ndash; integer type for size info </p></li>
</ul>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>handle</strong> &ndash; raft handle for resource management </p></li>
<li><p><strong>index</strong> &ndash; ball cover index which has not yet been built </p></li>
<li><p><strong>k</strong> &ndash; number of nearest neighbors to find </p></li>
<li><p><strong>query</strong> &ndash; the </p></li>
<li><p><strong>perform_post_filtering</strong> &ndash; if this is false, only the closest k landmarks are considered (which will return approximate results). </p></li>
<li><p><strong>inds</strong> &ndash; <strong>[out]</strong> output knn indices </p></li>
<li><p><strong>dists</strong> &ndash; <strong>[out]</strong> output knn distances </p></li>
<li><p><strong>weight</strong> &ndash; a weight for overlap between the closest landmark and the radius of other landmarks when pruning distances. Setting this value below 1 can effectively turn off computing distances against many other balls, enabling approximate nearest neighbors. Recall can be adjusted based on how many relevant balls are ignored. Note that many datasets can still have great recall even by only looking in the closest landmark. </p></li>
<li><p><strong>n_query_pts</strong> &ndash; <strong>[in]</strong> number of query points </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I00EN4raft7spatial3knn24epsUnexpL2SqNeighborhoodEvPbP4IdxTPK5DataTPK5DataT4IdxT4IdxT4IdxT5DataT12cudaStream_t">
<span id="_CPPv3I00EN4raft7spatial3knn24epsUnexpL2SqNeighborhoodEPbP4IdxTPK5DataTPK5DataT4IdxT4IdxT4IdxT5DataT12cudaStream_t"></span><span id="_CPPv2I00EN4raft7spatial3knn24epsUnexpL2SqNeighborhoodEPbP4IdxTPK5DataTPK5DataT4IdxT4IdxT4IdxT5DataT12cudaStream_t"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">DataT</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">IdxT</span></span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="namespaceraft_1_1spatial_1_1knn_1a33a901a25c6c35497f78154513bcf407"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">epsUnexpL2SqNeighborhood</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">adj</span></span>, <a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn24epsUnexpL2SqNeighborhoodEvPbP4IdxTPK5DataTPK5DataT4IdxT4IdxT4IdxT5DataT12cudaStream_t" title="raft::spatial::knn::epsUnexpL2SqNeighborhood::IdxT"><span class="n"><span class="pre">IdxT</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">vd</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn24epsUnexpL2SqNeighborhoodEvPbP4IdxTPK5DataTPK5DataT4IdxT4IdxT4IdxT5DataT12cudaStream_t" title="raft::spatial::knn::epsUnexpL2SqNeighborhood::DataT"><span class="n"><span class="pre">DataT</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">x</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn24epsUnexpL2SqNeighborhoodEvPbP4IdxTPK5DataTPK5DataT4IdxT4IdxT4IdxT5DataT12cudaStream_t" title="raft::spatial::knn::epsUnexpL2SqNeighborhood::DataT"><span class="n"><span class="pre">DataT</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">y</span></span>, <a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn24epsUnexpL2SqNeighborhoodEvPbP4IdxTPK5DataTPK5DataT4IdxT4IdxT4IdxT5DataT12cudaStream_t" title="raft::spatial::knn::epsUnexpL2SqNeighborhood::IdxT"><span class="n"><span class="pre">IdxT</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">m</span></span>, <a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn24epsUnexpL2SqNeighborhoodEvPbP4IdxTPK5DataTPK5DataT4IdxT4IdxT4IdxT5DataT12cudaStream_t" title="raft::spatial::knn::epsUnexpL2SqNeighborhood::IdxT"><span class="n"><span class="pre">IdxT</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">n</span></span>, <a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn24epsUnexpL2SqNeighborhoodEvPbP4IdxTPK5DataTPK5DataT4IdxT4IdxT4IdxT5DataT12cudaStream_t" title="raft::spatial::knn::epsUnexpL2SqNeighborhood::IdxT"><span class="n"><span class="pre">IdxT</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">k</span></span>, <a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn24epsUnexpL2SqNeighborhoodEvPbP4IdxTPK5DataTPK5DataT4IdxT4IdxT4IdxT5DataT12cudaStream_t" title="raft::spatial::knn::epsUnexpL2SqNeighborhood::DataT"><span class="n"><span class="pre">DataT</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">eps</span></span>, <span class="n"><span class="pre">cudaStream_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">stream</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I00EN4raft7spatial3knn24epsUnexpL2SqNeighborhoodEvPbP4IdxTPK5DataTPK5DataT4IdxT4IdxT4IdxT5DataT12cudaStream_t" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Computes epsilon neighborhood for the L2-Squared distance metric. </p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>DataT</strong> &ndash; IO and math type </p></li>
<li><p><strong>IdxT</strong> &ndash; Index type</p></li>
</ul>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>adj</strong> &ndash; <strong>[out]</strong> adjacency matrix [row-major] [on device] [dim = m x n] </p></li>
<li><p><strong>vd</strong> &ndash; <strong>[out]</strong> vertex degree array [on device] [len = m + 1] <code class="docutils literal notranslate"><span class="pre">vd</span> <span class="pre">+</span> <span class="pre">m</span></code> stores the total number of edges in the adjacency matrix. Pass a nullptr if you don&rsquo;t need this info. </p></li>
<li><p><strong>x</strong> &ndash; <strong>[in]</strong> first matrix [row-major] [on device] [dim = m x k] </p></li>
<li><p><strong>y</strong> &ndash; <strong>[in]</strong> second matrix [row-major] [on device] [dim = n x k] </p></li>
<li><p><strong>m</strong> &ndash; <strong>[in]</strong> number of rows in x </p></li>
<li><p><strong>n</strong> &ndash; <strong>[in]</strong> number of rows in y </p></li>
<li><p><strong>k</strong> &ndash; <strong>[in]</strong> number of columns in x and k </p></li>
<li><p><strong>eps</strong> &ndash; <strong>[in]</strong> defines epsilon neighborhood radius (should be passed as squared as we compute L2-squared distance in this method) </p></li>
<li><p><strong>stream</strong> &ndash; <strong>[in]</strong> cuda stream </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I00EN4raft7spatial3knn15knn_merge_partsEvP7value_tP5idx_tP7value_tP5idx_t6size_tii12cudaStream_tP5idx_t">
<span id="_CPPv3I00EN4raft7spatial3knn15knn_merge_partsEP7value_tP5idx_tP7value_tP5idx_t6size_tii12cudaStream_tP5idx_t"></span><span id="_CPPv2I00EN4raft7spatial3knn15knn_merge_partsEP7value_tP5idx_tP7value_tP5idx_t6size_tii12cudaStream_tP5idx_t"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">idx_t</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">int64_t</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">value_t</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="kt"><span class="pre">float</span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="namespaceraft_1_1spatial_1_1knn_1ac53c0383ed1bf2c77c802c882d7d4a8a"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">knn_merge_parts</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn15knn_merge_partsEvP7value_tP5idx_tP7value_tP5idx_t6size_tii12cudaStream_tP5idx_t" title="raft::spatial::knn::knn_merge_parts::value_t"><span class="n"><span class="pre">value_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">in_keys</span></span>, <a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn15knn_merge_partsEvP7value_tP5idx_tP7value_tP5idx_t6size_tii12cudaStream_tP5idx_t" title="raft::spatial::knn::knn_merge_parts::idx_t"><span class="n"><span class="pre">idx_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">in_values</span></span>, <a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn15knn_merge_partsEvP7value_tP5idx_tP7value_tP5idx_t6size_tii12cudaStream_tP5idx_t" title="raft::spatial::knn::knn_merge_parts::value_t"><span class="n"><span class="pre">value_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">out_keys</span></span>, <a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn15knn_merge_partsEvP7value_tP5idx_tP7value_tP5idx_t6size_tii12cudaStream_tP5idx_t" title="raft::spatial::knn::knn_merge_parts::idx_t"><span class="n"><span class="pre">idx_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">out_values</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">n_samples</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">n_parts</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">k</span></span>, <span class="n"><span class="pre">cudaStream_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">stream</span></span>, <a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn15knn_merge_partsEvP7value_tP5idx_tP7value_tP5idx_t6size_tii12cudaStream_tP5idx_t" title="raft::spatial::knn::knn_merge_parts::idx_t"><span class="n"><span class="pre">idx_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">translations</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I00EN4raft7spatial3knn15knn_merge_partsEvP7value_tP5idx_tP7value_tP5idx_t6size_tii12cudaStream_tP5idx_t" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Performs a k-select across row partitioned index/distance matrices formatted like the following: row1: k0, k1, k2 row2: k0, k1, k2 row3: k0, k1, k2 row1: k0, k1, k2 row2: k0, k1, k2 row3: k0, k1, k2</p>
<p>etc&hellip;</p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>idx_t</strong> &ndash; </p></li>
<li><p><strong>value_t</strong> &ndash; </p></li>
</ul>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>in_keys</strong> &ndash; </p></li>
<li><p><strong>in_values</strong> &ndash; </p></li>
<li><p><strong>out_keys</strong> &ndash; </p></li>
<li><p><strong>out_values</strong> &ndash; </p></li>
<li><p><strong>n_samples</strong> &ndash; </p></li>
<li><p><strong>n_parts</strong> &ndash; </p></li>
<li><p><strong>k</strong> &ndash; </p></li>
<li><p><strong>stream</strong> &ndash; </p></li>
<li><p><strong>translations</strong> &ndash; </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I00EN4raft7spatial3knn8select_kEvPK7value_tPK5idx_t6size_t6size_tP7value_tP5idx_tbi12cudaStream_t11SelectKAlgo">
<span id="_CPPv3I00EN4raft7spatial3knn8select_kEPK7value_tPK5idx_t6size_t6size_tP7value_tP5idx_tbi12cudaStream_t11SelectKAlgo"></span><span id="_CPPv2I00EN4raft7spatial3knn8select_kEPK7value_tPK5idx_t6size_t6size_tP7value_tP5idx_tbi12cudaStream_t11SelectKAlgo"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">idx_t</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">value_t</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="kt"><span class="pre">float</span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="namespaceraft_1_1spatial_1_1knn_1a2bebc4f0961322d8ee90a278d545c3c9"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">select_k</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn8select_kEvPK7value_tPK5idx_t6size_t6size_tP7value_tP5idx_tbi12cudaStream_t11SelectKAlgo" title="raft::spatial::knn::select_k::value_t"><span class="n"><span class="pre">value_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">in_keys</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn8select_kEvPK7value_tPK5idx_t6size_t6size_tP7value_tP5idx_tbi12cudaStream_t11SelectKAlgo" title="raft::spatial::knn::select_k::idx_t"><span class="n"><span class="pre">idx_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">in_values</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">n_inputs</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">input_len</span></span>, <a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn8select_kEvPK7value_tPK5idx_t6size_t6size_tP7value_tP5idx_tbi12cudaStream_t11SelectKAlgo" title="raft::spatial::knn::select_k::value_t"><span class="n"><span class="pre">value_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">out_keys</span></span>, <a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn8select_kEvPK7value_tPK5idx_t6size_t6size_tP7value_tP5idx_tbi12cudaStream_t11SelectKAlgo" title="raft::spatial::knn::select_k::idx_t"><span class="n"><span class="pre">idx_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">out_values</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">select_min</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">k</span></span>, <span class="n"><span class="pre">cudaStream_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">stream</span></span>, <a class="reference internal" href="#_CPPv4N4raft7spatial3knn11SelectKAlgoE" title="raft::spatial::knn::SelectKAlgo"><span class="n"><span class="pre">SelectKAlgo</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">algo</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N4raft7spatial3knn11SelectKAlgoE" title="raft::spatial::knn::SelectKAlgo"><span class="n"><span class="pre">SelectKAlgo</span></span></a><span class="p"><span class="pre">::</span></span><a class="reference internal" href="#_CPPv4N4raft7spatial3knn11SelectKAlgo5FAISSE" title="raft::spatial::knn::SelectKAlgo::FAISS"><span class="n"><span class="pre">FAISS</span></span></a><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I00EN4raft7spatial3knn8select_kEvPK7value_tPK5idx_t6size_t6size_tP7value_tP5idx_tbi12cudaStream_t11SelectKAlgo" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Select k smallest or largest key/values from each row in the input data.</p>
<p>If you think of the input data <code class="docutils literal notranslate"><span class="pre">in_keys</span></code> as a row-major matrix with input_len columns and n_inputs rows, then this function selects k smallest/largest values in each row and fills in the row-major matrix <code class="docutils literal notranslate"><span class="pre">out_keys</span></code> of size (n_inputs, k).</p>
<p>Note, depending on the selected algorithm, the values within rows of <code class="docutils literal notranslate"><span class="pre">out_keys</span></code> are not necessarily sorted. See the <code class="docutils literal notranslate"><span class="pre">SelectKAlgo</span></code> enumeration for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>idx_t</strong> &ndash; the payload type (what is being selected together with the keys). </p></li>
<li><p><strong>value_t</strong> &ndash; the type of the keys (what is being compared).</p></li>
</ul>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>in_keys</strong> &ndash; <strong>[in]</strong> contiguous device array of inputs of size (input_len * n_inputs); these are compared and selected. </p></li>
<li><p><strong>in_values</strong> &ndash; <strong>[in]</strong> contiguous device array of inputs of size (input_len * n_inputs); typically, these are indices of the corresponding in_keys. You can pass <code class="docutils literal notranslate"><span class="pre">NULL</span></code> as an argument here; this would imply <code class="docutils literal notranslate"><span class="pre">in_values</span></code> is a homogeneous array of indices from <code class="docutils literal notranslate"><span class="pre">0</span></code> to <code class="docutils literal notranslate"><span class="pre">input_len</span> <span class="pre">-</span> <span class="pre">1</span></code> for every input and reduce the usage of memory bandwidth. </p></li>
<li><p><strong>n_inputs</strong> &ndash; <strong>[in]</strong> number of input rows, i.e. the batch size. </p></li>
<li><p><strong>input_len</strong> &ndash; <strong>[in]</strong> length of a single input array (row); also sometimes referred as n_cols. Invariant: input_len &gt;= k. </p></li>
<li><p><strong>out_keys</strong> &ndash; <strong>[out]</strong> contiguous device array of outputs of size (k * n_inputs); the k smallest/largest values from each row of the <code class="docutils literal notranslate"><span class="pre">in_keys</span></code>. </p></li>
<li><p><strong>out_values</strong> &ndash; <strong>[out]</strong> contiguous device array of outputs of size (k * n_inputs); the payload selected together with <code class="docutils literal notranslate"><span class="pre">out_keys</span></code>. </p></li>
<li><p><strong>select_min</strong> &ndash; <strong>[in]</strong> whether to select k smallest (true) or largest (false) keys. </p></li>
<li><p><strong>k</strong> &ndash; <strong>[in]</strong> the number of outputs to select in each input row. </p></li>
<li><p><strong>stream</strong> &ndash; <strong>[in]</strong> </p></li>
<li><p><strong>algo</strong> &ndash; <strong>[in]</strong> the implementation of the algorithm </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I000EN4raft7spatial3knn15brute_force_knnEvRKN4raft8handle_tERNSt6vectorIP7value_tEERNSt6vectorI9value_intEE9value_intP7value_t9value_intP5idx_tP7value_t9value_intbbPNSt6vectorI5idx_tEEN8distance12DistanceTypeEf">
<span id="_CPPv3I000EN4raft7spatial3knn15brute_force_knnERKN4raft8handle_tERNSt6vectorIP7value_tEERNSt6vectorI9value_intEE9value_intP7value_t9value_intP5idx_tP7value_t9value_intbbPNSt6vectorI5idx_tEEN8distance12DistanceTypeEf"></span><span id="_CPPv2I000EN4raft7spatial3knn15brute_force_knnERKN4raft8handle_tERNSt6vectorIP7value_tEERNSt6vectorI9value_intEE9value_intP7value_t9value_intP5idx_tP7value_t9value_intbbPNSt6vectorI5idx_tEEN8distance12DistanceTypeEf"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">idx_t</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int64_t</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">value_t</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="kt"><span class="pre">float</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">value_int</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="namespaceraft_1_1spatial_1_1knn_1a6a98926f34e22230d813e57040d75b5a"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">brute_force_knn</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="core.html#_CPPv4N4raft8handle_tE" title="raft::handle_t"><span class="n"><span class="pre">handle_t</span></span></a><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">handle</span></span>, <span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I000EN4raft7spatial3knn15brute_force_knnEvRKN4raft8handle_tERNSt6vectorIP7value_tEERNSt6vectorI9value_intEE9value_intP7value_t9value_intP5idx_tP7value_t9value_intbbPNSt6vectorI5idx_tEEN8distance12DistanceTypeEf" title="raft::spatial::knn::brute_force_knn::value_t"><span class="n"><span class="pre">value_t</span></span></a><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">input</span></span>, <span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I000EN4raft7spatial3knn15brute_force_knnEvRKN4raft8handle_tERNSt6vectorIP7value_tEERNSt6vectorI9value_intEE9value_intP7value_t9value_intP5idx_tP7value_t9value_intbbPNSt6vectorI5idx_tEEN8distance12DistanceTypeEf" title="raft::spatial::knn::brute_force_knn::value_int"><span class="n"><span class="pre">value_int</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">sizes</span></span>, <a class="reference internal" href="#_CPPv4I000EN4raft7spatial3knn15brute_force_knnEvRKN4raft8handle_tERNSt6vectorIP7value_tEERNSt6vectorI9value_intEE9value_intP7value_t9value_intP5idx_tP7value_t9value_intbbPNSt6vectorI5idx_tEEN8distance12DistanceTypeEf" title="raft::spatial::knn::brute_force_knn::value_int"><span class="n"><span class="pre">value_int</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">D</span></span>, <a class="reference internal" href="#_CPPv4I000EN4raft7spatial3knn15brute_force_knnEvRKN4raft8handle_tERNSt6vectorIP7value_tEERNSt6vectorI9value_intEE9value_intP7value_t9value_intP5idx_tP7value_t9value_intbbPNSt6vectorI5idx_tEEN8distance12DistanceTypeEf" title="raft::spatial::knn::brute_force_knn::value_t"><span class="n"><span class="pre">value_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">search_items</span></span>, <a class="reference internal" href="#_CPPv4I000EN4raft7spatial3knn15brute_force_knnEvRKN4raft8handle_tERNSt6vectorIP7value_tEERNSt6vectorI9value_intEE9value_intP7value_t9value_intP5idx_tP7value_t9value_intbbPNSt6vectorI5idx_tEEN8distance12DistanceTypeEf" title="raft::spatial::knn::brute_force_knn::value_int"><span class="n"><span class="pre">value_int</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">n</span></span>, <a class="reference internal" href="#_CPPv4I000EN4raft7spatial3knn15brute_force_knnEvRKN4raft8handle_tERNSt6vectorIP7value_tEERNSt6vectorI9value_intEE9value_intP7value_t9value_intP5idx_tP7value_t9value_intbbPNSt6vectorI5idx_tEEN8distance12DistanceTypeEf" title="raft::spatial::knn::brute_force_knn::idx_t"><span class="n"><span class="pre">idx_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">res_I</span></span>, <a class="reference internal" href="#_CPPv4I000EN4raft7spatial3knn15brute_force_knnEvRKN4raft8handle_tERNSt6vectorIP7value_tEERNSt6vectorI9value_intEE9value_intP7value_t9value_intP5idx_tP7value_t9value_intbbPNSt6vectorI5idx_tEEN8distance12DistanceTypeEf" title="raft::spatial::knn::brute_force_knn::value_t"><span class="n"><span class="pre">value_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">res_D</span></span>, <a class="reference internal" href="#_CPPv4I000EN4raft7spatial3knn15brute_force_knnEvRKN4raft8handle_tERNSt6vectorIP7value_tEERNSt6vectorI9value_intEE9value_intP7value_t9value_intP5idx_tP7value_t9value_intbbPNSt6vectorI5idx_tEEN8distance12DistanceTypeEf" title="raft::spatial::knn::brute_force_knn::value_int"><span class="n"><span class="pre">value_int</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">k</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">rowMajorIndex</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">true</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">rowMajorQuery</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">true</span></span>, <span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I000EN4raft7spatial3knn15brute_force_knnEvRKN4raft8handle_tERNSt6vectorIP7value_tEERNSt6vectorI9value_intEE9value_intP7value_t9value_intP5idx_tP7value_t9value_intbbPNSt6vectorI5idx_tEEN8distance12DistanceTypeEf" title="raft::spatial::knn::brute_force_knn::idx_t"><span class="n"><span class="pre">idx_t</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">translations</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">nullptr</span></span>, <a class="reference internal" href="#_CPPv4N4raft8distanceE" title="raft::distance"><span class="n"><span class="pre">distance</span></span></a><span class="p"><span class="pre">::</span></span><a class="reference internal" href="#_CPPv4N4raft8distance12DistanceTypeE" title="raft::distance::DistanceType"><span class="n"><span class="pre">DistanceType</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">metric</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N4raft8distanceE" title="raft::distance"><span class="n"><span class="pre">distance</span></span></a><span class="p"><span class="pre">::</span></span><a class="reference internal" href="#_CPPv4N4raft8distance12DistanceTypeE" title="raft::distance::DistanceType"><span class="n"><span class="pre">DistanceType</span></span></a><span class="p"><span class="pre">::</span></span><a class="reference internal" href="#_CPPv4N4raft8distance12DistanceType12L2UnexpandedE" title="raft::distance::DistanceType::L2Unexpanded"><span class="n"><span class="pre">L2Unexpanded</span></span></a>, <span class="kt"><span class="pre">float</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">metric_arg</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">2.0f</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I000EN4raft7spatial3knn15brute_force_knnEvRKN4raft8handle_tERNSt6vectorIP7value_tEERNSt6vectorI9value_intEE9value_intP7value_t9value_intP5idx_tP7value_t9value_intbbPNSt6vectorI5idx_tEEN8distance12DistanceTypeEf" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Flat C++ API function to perform a brute force knn on a series of input arrays and combine the results into a single output array for indexes and distances. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>handle</strong> &ndash; <strong>[in]</strong> the cuml handle to use </p></li>
<li><p><strong>input</strong> &ndash; <strong>[in]</strong> vector of pointers to the input arrays </p></li>
<li><p><strong>sizes</strong> &ndash; <strong>[in]</strong> vector of sizes of input arrays </p></li>
<li><p><strong>D</strong> &ndash; <strong>[in]</strong> the dimensionality of the arrays </p></li>
<li><p><strong>search_items</strong> &ndash; <strong>[in]</strong> array of items to search of dimensionality D </p></li>
<li><p><strong>n</strong> &ndash; <strong>[in]</strong> number of rows in search_items </p></li>
<li><p><strong>res_I</strong> &ndash; <strong>[out]</strong> the resulting index array of size n * k </p></li>
<li><p><strong>res_D</strong> &ndash; <strong>[out]</strong> the resulting distance array of size n * k </p></li>
<li><p><strong>k</strong> &ndash; <strong>[in]</strong> the number of nearest neighbors to return </p></li>
<li><p><strong>rowMajorIndex</strong> &ndash; <strong>[in]</strong> are the index arrays in row-major order? </p></li>
<li><p><strong>rowMajorQuery</strong> &ndash; <strong>[in]</strong> are the query arrays in row-major order? </p></li>
<li><p><strong>metric</strong> &ndash; <strong>[in]</strong> distance metric to use. Euclidean (L2) is used by default </p></li>
<li><p><strong>metric_arg</strong> &ndash; <strong>[in]</strong> the value of <code class="docutils literal notranslate"><span class="pre">p</span></code> for Minkowski (l-p) distances. This is ignored if the metric_type is not Minkowski. </p></li>
<li><p><strong>translations</strong> &ndash; <strong>[in]</strong> starting offsets for partitions. should be the same size as input vector. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv4N4raft7spatial3knn5indexE">
<span id="_CPPv3N4raft7spatial3knn5indexE"></span><span id="_CPPv2N4raft7spatial3knn5indexE"></span><span id="raft::spatial::knn::index"></span><span class="target" id="structraft_1_1spatial_1_1knn_1_1index"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">index</span></span></span><a class="headerlink" href="#_CPPv4N4raft7spatial3knn5indexE" title="Permalink to this definition">&para;</a><br></dt>
<dd><div class="docutils container">
<em>#include &lt;common.hpp&gt;</em></div>
<p>The base for approximate KNN index structures. </p>
<p>Subclassed by raft::spatial::knn::ivf_flat::index&lt; T, IdxT &gt;</p>
</dd></dl>

<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv4N4raft7spatial3knn12index_paramsE">
<span id="_CPPv3N4raft7spatial3knn12index_paramsE"></span><span id="_CPPv2N4raft7spatial3knn12index_paramsE"></span><span id="raft::spatial::knn::index_params"></span><span class="target" id="structraft_1_1spatial_1_1knn_1_1index__params"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">index_params</span></span></span><a class="headerlink" href="#_CPPv4N4raft7spatial3knn12index_paramsE" title="Permalink to this definition">&para;</a><br></dt>
<dd><div class="docutils container">
<em>#include &lt;common.hpp&gt;</em></div>
<p>The base for KNN index parameters. </p>
<p>Subclassed by raft::spatial::knn::ivf_flat::index_params</p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4raft7spatial3knn12index_params6metricE">
<span id="_CPPv3N4raft7spatial3knn12index_params6metricE"></span><span id="_CPPv2N4raft7spatial3knn12index_params6metricE"></span><span id="raft::spatial::knn::index_params::metric__raft::distance::DistanceType"></span><span class="target" id="structraft_1_1spatial_1_1knn_1_1index__params_1a634cdb6250936e775bf9536a999607ba"></span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="#_CPPv4N4raft8distanceE" title="raft::distance"><span class="n"><span class="pre">distance</span></span></a><span class="p"><span class="pre">::</span></span><a class="reference internal" href="#_CPPv4N4raft8distance12DistanceTypeE" title="raft::distance::DistanceType"><span class="n"><span class="pre">DistanceType</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">metric</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N4raft8distanceE" title="raft::distance"><span class="n"><span class="pre">distance</span></span></a><span class="p"><span class="pre">::</span></span><a class="reference internal" href="#_CPPv4N4raft8distance12DistanceTypeE" title="raft::distance::DistanceType"><span class="n"><span class="pre">DistanceType</span></span></a><span class="p"><span class="pre">::</span></span><a class="reference internal" href="#_CPPv4N4raft8distance12DistanceType10L2ExpandedE" title="raft::distance::DistanceType::L2Expanded"><span class="n"><span class="pre">L2Expanded</span></span></a><a class="headerlink" href="#_CPPv4N4raft7spatial3knn12index_params6metricE" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Distance type. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4raft7spatial3knn12index_params10metric_argE">
<span id="_CPPv3N4raft7spatial3knn12index_params10metric_argE"></span><span id="_CPPv2N4raft7spatial3knn12index_params10metric_argE"></span><span id="raft::spatial::knn::index_params::metric_arg__float"></span><span class="target" id="structraft_1_1spatial_1_1knn_1_1index__params_1a9fe945a9e12de2b44c96298102cec554"></span><span class="kt"><span class="pre">float</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">metric_arg</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">2.0f</span></span><a class="headerlink" href="#_CPPv4N4raft7spatial3knn12index_params10metric_argE" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>The argument used by some distance metrics. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4raft7spatial3knn12index_params17add_data_on_buildE">
<span id="_CPPv3N4raft7spatial3knn12index_params17add_data_on_buildE"></span><span id="_CPPv2N4raft7spatial3knn12index_params17add_data_on_buildE"></span><span id="raft::spatial::knn::index_params::add_data_on_build__b"></span><span class="target" id="structraft_1_1spatial_1_1knn_1_1index__params_1aaf5ce7363ac5194c6677db7a63143d79"></span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">add_data_on_build</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">true</span></span><a class="headerlink" href="#_CPPv4N4raft7spatial3knn12index_params17add_data_on_buildE" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Whether to add the dataset content to the index, i.e.:</p>
<p></p><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">true</span></code> means the index is filled with the dataset vectors and ready to search after calling <code class="docutils literal notranslate"><span class="pre">build</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">false</span></code> means <code class="docutils literal notranslate"><span class="pre">build</span></code> only trains the underlying model (e.g. quantizer or clustering), but the index is left empty; you&rsquo;d need to call <code class="docutils literal notranslate"><span class="pre">extend</span></code> on the index afterwards to populate it. </p></li>
</ul>
<p></p>
</dd></dl>

</div>
</dd></dl>

<dl class="cpp class">
<dt class="sig sig-object cpp" id="_CPPv4N4raft7spatial3knn15RmmGpuResourcesE">
<span id="_CPPv3N4raft7spatial3knn15RmmGpuResourcesE"></span><span id="_CPPv2N4raft7spatial3knn15RmmGpuResourcesE"></span><span id="raft::spatial::knn::RmmGpuResources"></span><span class="target" id="classraft_1_1spatial_1_1knn_1_1RmmGpuResources"></span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">RmmGpuResources</span></span></span><span class="w"> </span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="k"><span class="pre">public</span></span><span class="w"> </span><span class="n"><span class="pre">GpuResourcesProvider</span></span><a class="headerlink" href="#_CPPv4N4raft7spatial3knn15RmmGpuResourcesE" title="Permalink to this definition">&para;</a><br></dt>
<dd><div class="docutils container">
<em>#include &lt;faiss_mr.hpp&gt;</em></div>
<p>Default implementation of GpuResources that allocates a cuBLAS stream and 2 streams for use, as well as temporary memory. Internally, the Faiss GPU code uses the instance managed by getResources, but this is the user-facing object that is internally reference counted. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-functions">Public Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4raft7spatial3knn15RmmGpuResources12noTempMemoryEv">
<span id="_CPPv3N4raft7spatial3knn15RmmGpuResources12noTempMemoryEv"></span><span id="_CPPv2N4raft7spatial3knn15RmmGpuResources12noTempMemoryEv"></span><span id="raft::spatial::knn::RmmGpuResources::noTempMemory"></span><span class="target" id="classraft_1_1spatial_1_1knn_1_1RmmGpuResources_1a7cbfb555db391c57f46c2d1b399949ee"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">noTempMemory</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4raft7spatial3knn15RmmGpuResources12noTempMemoryEv" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Disable allocation of temporary memory; all temporary memory requests will call cudaMalloc / cudaFree at the point of use </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4raft7spatial3knn15RmmGpuResources13setTempMemoryE6size_t">
<span id="_CPPv3N4raft7spatial3knn15RmmGpuResources13setTempMemoryE6size_t"></span><span id="_CPPv2N4raft7spatial3knn15RmmGpuResources13setTempMemoryE6size_t"></span><span id="raft::spatial::knn::RmmGpuResources::setTempMemory__s"></span><span class="target" id="classraft_1_1spatial_1_1knn_1_1RmmGpuResources_1a97076eed7e180f544c9a1825aba0b39a"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">setTempMemory</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">size</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4raft7spatial3knn15RmmGpuResources13setTempMemoryE6size_t" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Specify that we wish to use a certain fixed size of memory on all devices as temporary memory. This is the upper bound for the GPU memory that we will reserve. We will never go above 1.5 GiB on any GPU; smaller GPUs (with &lt;= 4 GiB or &lt;= 8 GiB) will use less memory than that. To avoid any temporary memory allocation, pass 0. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4raft7spatial3knn15RmmGpuResources15setPinnedMemoryE6size_t">
<span id="_CPPv3N4raft7spatial3knn15RmmGpuResources15setPinnedMemoryE6size_t"></span><span id="_CPPv2N4raft7spatial3knn15RmmGpuResources15setPinnedMemoryE6size_t"></span><span id="raft::spatial::knn::RmmGpuResources::setPinnedMemory__s"></span><span class="target" id="classraft_1_1spatial_1_1knn_1_1RmmGpuResources_1ae10eda2356461a35dbb5de17715422bf"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">setPinnedMemory</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">size</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4raft7spatial3knn15RmmGpuResources15setPinnedMemoryE6size_t" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Set amount of pinned memory to allocate, for async GPU &lt;-&gt; CPU transfers </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4raft7spatial3knn15RmmGpuResources16setDefaultStreamEi12cudaStream_t">
<span id="_CPPv3N4raft7spatial3knn15RmmGpuResources16setDefaultStreamEi12cudaStream_t"></span><span id="_CPPv2N4raft7spatial3knn15RmmGpuResources16setDefaultStreamEi12cudaStream_t"></span><span id="raft::spatial::knn::RmmGpuResources::setDefaultStream__i.cudaStream_t"></span><span class="target" id="classraft_1_1spatial_1_1knn_1_1RmmGpuResources_1abb201b1c83893b7a5fe1ef33507b3889"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">setDefaultStream</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">device</span></span>, <span class="n"><span class="pre">cudaStream_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">stream</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4raft7spatial3knn15RmmGpuResources16setDefaultStreamEi12cudaStream_t" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Called to change the stream for work ordering. We do not own <code class="docutils literal notranslate"><span class="pre">stream</span></code>; i.e., it will not be destroyed when the GpuResources object gets cleaned up. We are guaranteed that all Faiss GPU work is ordered with respect to this stream upon exit from an index or other Faiss GPU call. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4raft7spatial3knn15RmmGpuResources19revertDefaultStreamEi">
<span id="_CPPv3N4raft7spatial3knn15RmmGpuResources19revertDefaultStreamEi"></span><span id="_CPPv2N4raft7spatial3knn15RmmGpuResources19revertDefaultStreamEi"></span><span id="raft::spatial::knn::RmmGpuResources::revertDefaultStream__i"></span><span class="target" id="classraft_1_1spatial_1_1knn_1_1RmmGpuResources_1ab43f758aa220c4d6f12d1c0e7e48f13e"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">revertDefaultStream</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">device</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4raft7spatial3knn15RmmGpuResources19revertDefaultStreamEi" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Revert the default stream to the original stream managed by this resources object, in case someone called <code class="docutils literal notranslate"><span class="pre">setDefaultStream</span></code>. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4raft7spatial3knn15RmmGpuResources30setDefaultNullStreamAllDevicesEv">
<span id="_CPPv3N4raft7spatial3knn15RmmGpuResources30setDefaultNullStreamAllDevicesEv"></span><span id="_CPPv2N4raft7spatial3knn15RmmGpuResources30setDefaultNullStreamAllDevicesEv"></span><span id="raft::spatial::knn::RmmGpuResources::setDefaultNullStreamAllDevices"></span><span class="target" id="classraft_1_1spatial_1_1knn_1_1RmmGpuResources_1aae9b7fa0414eb8247ba0473936075204"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">setDefaultNullStreamAllDevices</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4raft7spatial3knn15RmmGpuResources30setDefaultNullStreamAllDevicesEv" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Called to change the work ordering streams to the null stream for all devices </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4raft7spatial3knn15RmmGpuResources13getMemoryInfoEv">
<span id="_CPPv3NK4raft7spatial3knn15RmmGpuResources13getMemoryInfoEv"></span><span id="_CPPv2NK4raft7spatial3knn15RmmGpuResources13getMemoryInfoEv"></span><span id="raft::spatial::knn::RmmGpuResources::getMemoryInfoC"></span><span class="target" id="classraft_1_1spatial_1_1knn_1_1RmmGpuResources_1a3d4a3510564d8b2d483d6bbd4148f6d8"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">map</span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">map</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">string</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">pair</span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">size_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">getMemoryInfo</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK4raft7spatial3knn15RmmGpuResources13getMemoryInfoEv" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Export a description of memory used for Python. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4raft7spatial3knn15RmmGpuResources16getDefaultStreamEi">
<span id="_CPPv3N4raft7spatial3knn15RmmGpuResources16getDefaultStreamEi"></span><span id="_CPPv2N4raft7spatial3knn15RmmGpuResources16getDefaultStreamEi"></span><span id="raft::spatial::knn::RmmGpuResources::getDefaultStream__i"></span><span class="target" id="classraft_1_1spatial_1_1knn_1_1RmmGpuResources_1af801ee4b16da3957b14c82c09369ce91"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="n"><span class="pre">cudaStream_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">getDefaultStream</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">device</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4raft7spatial3knn15RmmGpuResources16getDefaultStreamEi" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Returns the current default stream. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4raft7spatial3knn15RmmGpuResources22getTempMemoryAvailableEi">
<span id="_CPPv3NK4raft7spatial3knn15RmmGpuResources22getTempMemoryAvailableEi"></span><span id="_CPPv2NK4raft7spatial3knn15RmmGpuResources22getTempMemoryAvailableEi"></span><span id="raft::spatial::knn::RmmGpuResources::getTempMemoryAvailable__iC"></span><span class="target" id="classraft_1_1spatial_1_1knn_1_1RmmGpuResources_1a938aec571ded668caf7845035082b59f"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">getTempMemoryAvailable</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">device</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK4raft7spatial3knn15RmmGpuResources22getTempMemoryAvailableEi" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Returns the current amount of temp memory available. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4raft7spatial3knn15RmmGpuResources30syncDefaultStreamCurrentDeviceEv">
<span id="_CPPv3N4raft7spatial3knn15RmmGpuResources30syncDefaultStreamCurrentDeviceEv"></span><span id="_CPPv2N4raft7spatial3knn15RmmGpuResources30syncDefaultStreamCurrentDeviceEv"></span><span id="raft::spatial::knn::RmmGpuResources::syncDefaultStreamCurrentDevice"></span><span class="target" id="classraft_1_1spatial_1_1knn_1_1RmmGpuResources_1a71ee462f0742597ef5e08ba78b03be36"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">syncDefaultStreamCurrentDevice</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4raft7spatial3knn15RmmGpuResources30syncDefaultStreamCurrentDeviceEv" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Synchronize our default stream with the CPU. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4raft7spatial3knn15RmmGpuResources23setLogMemoryAllocationsEb">
<span id="_CPPv3N4raft7spatial3knn15RmmGpuResources23setLogMemoryAllocationsEb"></span><span id="_CPPv2N4raft7spatial3knn15RmmGpuResources23setLogMemoryAllocationsEb"></span><span id="raft::spatial::knn::RmmGpuResources::setLogMemoryAllocations__b"></span><span class="target" id="classraft_1_1spatial_1_1knn_1_1RmmGpuResources_1a5b62b82b490539768e861e1520e9e070"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">setLogMemoryAllocations</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">enable</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4raft7spatial3knn15RmmGpuResources23setLogMemoryAllocationsEb" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>If enabled, will print every GPU memory allocation and deallocation to standard output </p>
</dd></dl>

</div>
</dd></dl>

<dl class="cpp class">
<dt class="sig sig-object cpp" id="_CPPv4N4raft7spatial3knn19RmmGpuResourcesImplE">
<span id="_CPPv3N4raft7spatial3knn19RmmGpuResourcesImplE"></span><span id="_CPPv2N4raft7spatial3knn19RmmGpuResourcesImplE"></span><span id="raft::spatial::knn::RmmGpuResourcesImpl"></span><span class="target" id="classraft_1_1spatial_1_1knn_1_1RmmGpuResourcesImpl"></span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">RmmGpuResourcesImpl</span></span></span><span class="w"> </span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="k"><span class="pre">public</span></span><span class="w"> </span><span class="n"><span class="pre">GpuResources</span></span><a class="headerlink" href="#_CPPv4N4raft7spatial3knn19RmmGpuResourcesImplE" title="Permalink to this definition">&para;</a><br></dt>
<dd><div class="docutils container">
<em>#include &lt;faiss_mr.hpp&gt;</em></div>
<p>RMM implementation of the GpuResources object that provides for a temporary memory manager </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-functions">Public Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4raft7spatial3knn19RmmGpuResourcesImpl12noTempMemoryEv">
<span id="_CPPv3N4raft7spatial3knn19RmmGpuResourcesImpl12noTempMemoryEv"></span><span id="_CPPv2N4raft7spatial3knn19RmmGpuResourcesImpl12noTempMemoryEv"></span><span id="raft::spatial::knn::RmmGpuResourcesImpl::noTempMemory"></span><span class="target" id="classraft_1_1spatial_1_1knn_1_1RmmGpuResourcesImpl_1a80f46ba5a38c06530999fd89f11952ff"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">noTempMemory</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4raft7spatial3knn19RmmGpuResourcesImpl12noTempMemoryEv" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Disable allocation of temporary memory; all temporary memory requests will call cudaMalloc / cudaFree at the point of use </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4raft7spatial3knn19RmmGpuResourcesImpl13setTempMemoryE6size_t">
<span id="_CPPv3N4raft7spatial3knn19RmmGpuResourcesImpl13setTempMemoryE6size_t"></span><span id="_CPPv2N4raft7spatial3knn19RmmGpuResourcesImpl13setTempMemoryE6size_t"></span><span id="raft::spatial::knn::RmmGpuResourcesImpl::setTempMemory__s"></span><span class="target" id="classraft_1_1spatial_1_1knn_1_1RmmGpuResourcesImpl_1aba2669c71b467016d63e1620f875387c"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">setTempMemory</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">size</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4raft7spatial3knn19RmmGpuResourcesImpl13setTempMemoryE6size_t" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Specify that we wish to use a certain fixed size of memory on all devices as temporary memory. This is the upper bound for the GPU memory that we will reserve. We will never go above 1.5 GiB on any GPU; smaller GPUs (with &lt;= 4 GiB or &lt;= 8 GiB) will use less memory than that. To avoid any temporary memory allocation, pass 0. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4raft7spatial3knn19RmmGpuResourcesImpl15setPinnedMemoryE6size_t">
<span id="_CPPv3N4raft7spatial3knn19RmmGpuResourcesImpl15setPinnedMemoryE6size_t"></span><span id="_CPPv2N4raft7spatial3knn19RmmGpuResourcesImpl15setPinnedMemoryE6size_t"></span><span id="raft::spatial::knn::RmmGpuResourcesImpl::setPinnedMemory__s"></span><span class="target" id="classraft_1_1spatial_1_1knn_1_1RmmGpuResourcesImpl_1aaca3ae5a8a880242cd1e92daf077c076"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">setPinnedMemory</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">size</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4raft7spatial3knn19RmmGpuResourcesImpl15setPinnedMemoryE6size_t" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Set amount of pinned memory to allocate, for async GPU &lt;-&gt; CPU transfers </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4raft7spatial3knn19RmmGpuResourcesImpl16setDefaultStreamEi12cudaStream_t">
<span id="_CPPv3N4raft7spatial3knn19RmmGpuResourcesImpl16setDefaultStreamEi12cudaStream_t"></span><span id="_CPPv2N4raft7spatial3knn19RmmGpuResourcesImpl16setDefaultStreamEi12cudaStream_t"></span><span id="raft::spatial::knn::RmmGpuResourcesImpl::setDefaultStream__i.cudaStream_t"></span><span class="target" id="classraft_1_1spatial_1_1knn_1_1RmmGpuResourcesImpl_1aa3edfed837047ae313ae5eae0494a541"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">setDefaultStream</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">device</span></span>, <span class="n"><span class="pre">cudaStream_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">stream</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4raft7spatial3knn19RmmGpuResourcesImpl16setDefaultStreamEi12cudaStream_t" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Called to change the stream for work ordering. We do not own <code class="docutils literal notranslate"><span class="pre">stream</span></code>; i.e., it will not be destroyed when the GpuResources object gets cleaned up. We are guaranteed that all Faiss GPU work is ordered with respect to this stream upon exit from an index or other Faiss GPU call. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4raft7spatial3knn19RmmGpuResourcesImpl19revertDefaultStreamEi">
<span id="_CPPv3N4raft7spatial3knn19RmmGpuResourcesImpl19revertDefaultStreamEi"></span><span id="_CPPv2N4raft7spatial3knn19RmmGpuResourcesImpl19revertDefaultStreamEi"></span><span id="raft::spatial::knn::RmmGpuResourcesImpl::revertDefaultStream__i"></span><span class="target" id="classraft_1_1spatial_1_1knn_1_1RmmGpuResourcesImpl_1a3775301d4513d7d4e7c082185530bc88"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">revertDefaultStream</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">device</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4raft7spatial3knn19RmmGpuResourcesImpl19revertDefaultStreamEi" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Revert the default stream to the original stream managed by this resources object, in case someone called <code class="docutils literal notranslate"><span class="pre">setDefaultStream</span></code>. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4raft7spatial3knn19RmmGpuResourcesImpl16getDefaultStreamEi">
<span id="_CPPv3N4raft7spatial3knn19RmmGpuResourcesImpl16getDefaultStreamEi"></span><span id="_CPPv2N4raft7spatial3knn19RmmGpuResourcesImpl16getDefaultStreamEi"></span><span id="raft::spatial::knn::RmmGpuResourcesImpl::getDefaultStream__i"></span><span class="target" id="classraft_1_1spatial_1_1knn_1_1RmmGpuResourcesImpl_1a01c6fc1e98a834887ad9c60053fa77ac"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="n"><span class="pre">cudaStream_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">getDefaultStream</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">device</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4raft7spatial3knn19RmmGpuResourcesImpl16getDefaultStreamEi" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Returns the stream for the given device on which all Faiss GPU work is ordered. We are guaranteed that all Faiss GPU work is ordered with respect to this stream upon exit from an index or other Faiss GPU call. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4raft7spatial3knn19RmmGpuResourcesImpl30setDefaultNullStreamAllDevicesEv">
<span id="_CPPv3N4raft7spatial3knn19RmmGpuResourcesImpl30setDefaultNullStreamAllDevicesEv"></span><span id="_CPPv2N4raft7spatial3knn19RmmGpuResourcesImpl30setDefaultNullStreamAllDevicesEv"></span><span id="raft::spatial::knn::RmmGpuResourcesImpl::setDefaultNullStreamAllDevices"></span><span class="target" id="classraft_1_1spatial_1_1knn_1_1RmmGpuResourcesImpl_1adf07bbe6aee1d8cf816765cd5822378c"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">setDefaultNullStreamAllDevices</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4raft7spatial3knn19RmmGpuResourcesImpl30setDefaultNullStreamAllDevicesEv" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Called to change the work ordering streams to the null stream for all devices </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4raft7spatial3knn19RmmGpuResourcesImpl23setLogMemoryAllocationsEb">
<span id="_CPPv3N4raft7spatial3knn19RmmGpuResourcesImpl23setLogMemoryAllocationsEb"></span><span id="_CPPv2N4raft7spatial3knn19RmmGpuResourcesImpl23setLogMemoryAllocationsEb"></span><span id="raft::spatial::knn::RmmGpuResourcesImpl::setLogMemoryAllocations__b"></span><span class="target" id="classraft_1_1spatial_1_1knn_1_1RmmGpuResourcesImpl_1a993815d21c6a528a0bf2e228601a0dfc"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">setLogMemoryAllocations</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">enable</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4raft7spatial3knn19RmmGpuResourcesImpl23setLogMemoryAllocationsEb" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>If enabled, will print every GPU memory allocation and deallocation to standard output </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4raft7spatial3knn19RmmGpuResourcesImpl19initializeForDeviceEi">
<span id="_CPPv3N4raft7spatial3knn19RmmGpuResourcesImpl19initializeForDeviceEi"></span><span id="_CPPv2N4raft7spatial3knn19RmmGpuResourcesImpl19initializeForDeviceEi"></span><span id="raft::spatial::knn::RmmGpuResourcesImpl::initializeForDevice__i"></span><span class="target" id="classraft_1_1spatial_1_1knn_1_1RmmGpuResourcesImpl_1a2f6813120ea26c1e5ab8b0eb70a79906"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">initializeForDevice</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">device</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4raft7spatial3knn19RmmGpuResourcesImpl19initializeForDeviceEi" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Internal system calls. </p>
<p>Initialize resources for this device </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4raft7spatial3knn19RmmGpuResourcesImpl11allocMemoryERK12AllocRequest">
<span id="_CPPv3N4raft7spatial3knn19RmmGpuResourcesImpl11allocMemoryERK12AllocRequest"></span><span id="_CPPv2N4raft7spatial3knn19RmmGpuResourcesImpl11allocMemoryERK12AllocRequest"></span><span id="raft::spatial::knn::RmmGpuResourcesImpl::allocMemory__AllocRequestCR"></span><span class="target" id="classraft_1_1spatial_1_1knn_1_1RmmGpuResourcesImpl_1ab62d93c7d83dbefedd987aa2e98c4e6c"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">allocMemory</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">AllocRequest</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">req</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4raft7spatial3knn19RmmGpuResourcesImpl11allocMemoryERK12AllocRequest" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Allocate non-temporary GPU memory. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N4raft7spatial3knn19RmmGpuResourcesImpl13deallocMemoryEiPv">
<span id="_CPPv3N4raft7spatial3knn19RmmGpuResourcesImpl13deallocMemoryEiPv"></span><span id="_CPPv2N4raft7spatial3knn19RmmGpuResourcesImpl13deallocMemoryEiPv"></span><span id="raft::spatial::knn::RmmGpuResourcesImpl::deallocMemory__i.voidP"></span><span class="target" id="classraft_1_1spatial_1_1knn_1_1RmmGpuResourcesImpl_1aa9dcd495c32fe3bfb36e40e8e9df6fa8"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">deallocMemory</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">device</span></span>, <span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">p</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N4raft7spatial3knn19RmmGpuResourcesImpl13deallocMemoryEiPv" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Returns a previous allocation. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4raft7spatial3knn19RmmGpuResourcesImpl13getMemoryInfoEv">
<span id="_CPPv3NK4raft7spatial3knn19RmmGpuResourcesImpl13getMemoryInfoEv"></span><span id="_CPPv2NK4raft7spatial3knn19RmmGpuResourcesImpl13getMemoryInfoEv"></span><span id="raft::spatial::knn::RmmGpuResourcesImpl::getMemoryInfoC"></span><span class="target" id="classraft_1_1spatial_1_1knn_1_1RmmGpuResourcesImpl_1a3290e7ece20e97de73bf2a19ceb78181"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">map</span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">map</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">string</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">pair</span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">size_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">getMemoryInfo</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK4raft7spatial3knn19RmmGpuResourcesImpl13getMemoryInfoEv" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Export a description of memory used for Python. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv4N4raft7spatial3knn13search_paramsE">
<span id="_CPPv3N4raft7spatial3knn13search_paramsE"></span><span id="_CPPv2N4raft7spatial3knn13search_paramsE"></span><span id="raft::spatial::knn::search_params"></span><span class="target" id="structraft_1_1spatial_1_1knn_1_1search__params"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">search_params</span></span></span><a class="headerlink" href="#_CPPv4N4raft7spatial3knn13search_paramsE" title="Permalink to this definition">&para;</a><br></dt>
<dd><div class="docutils container">
<em>#include &lt;common.hpp&gt;</em></div>
<p>Subclassed by raft::spatial::knn::ivf_flat::search_params</p>
</dd></dl>

<dl class="cpp type">
<dt class="sig sig-object cpp" id="_CPPv4N4raft7spatial3knn8ivf_flatE">
<span id="_CPPv3N4raft7spatial3knn8ivf_flatE"></span><span id="_CPPv2N4raft7spatial3knn8ivf_flatE"></span><span id="raft::spatial::knn::ivf_flat"></span><span class="target" id="namespaceraft_1_1spatial_1_1knn_1_1ivf__flat"></span><span class="k"><span class="pre">namespace</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ivf_flat</span></span></span><a class="headerlink" href="#_CPPv4N4raft7spatial3knn8ivf_flatE" title="Permalink to this definition">&para;</a><br></dt>
<dd><div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-functions">Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I00EN4raft7spatial3knn8ivf_flat5buildE5indexI1T4IdxTERK8handle_tRK12index_paramsPK1T4IdxT8uint32_t">
<span id="_CPPv3I00EN4raft7spatial3knn8ivf_flat5buildERK8handle_tRK12index_paramsPK1T4IdxT8uint32_t"></span><span id="_CPPv2I00EN4raft7spatial3knn8ivf_flat5buildERK8handle_tRK12index_paramsPK1T4IdxT8uint32_t"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">IdxT</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">uint32_t</span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="namespaceraft_1_1spatial_1_1knn_1_1ivf__flat_1ad50e858132aa3fecc6ddae2b45973090"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">build</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="core.html#_CPPv4N4raft8handle_tE" title="raft::handle_t"><span class="n"><span class="pre">handle_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">handle</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N4raft7spatial3knn8ivf_flat12index_paramsE" title="raft::spatial::knn::ivf_flat::index_params"><span class="n"><span class="pre">index_params</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">params</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat5buildE5indexI1T4IdxTERK8handle_tRK12index_paramsPK1T4IdxT8uint32_t" title="raft::spatial::knn::ivf_flat::build::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">dataset</span></span>, <a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat5buildE5indexI1T4IdxTERK8handle_tRK12index_paramsPK1T4IdxT8uint32_t" title="raft::spatial::knn::ivf_flat::build::IdxT"><span class="n"><span class="pre">IdxT</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">n_rows</span></span>, <span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">dim</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="o"><span class="pre">-&gt;</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat5indexE" title="raft::spatial::knn::ivf_flat::index"><span class="n"><span class="pre">index</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat5buildE5indexI1T4IdxTERK8handle_tRK12index_paramsPK1T4IdxT8uint32_t" title="raft::spatial::knn::ivf_flat::build::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat5buildE5indexI1T4IdxTERK8handle_tRK12index_paramsPK1T4IdxT8uint32_t" title="raft::spatial::knn::ivf_flat::build::IdxT"><span class="n"><span class="pre">IdxT</span></span></a><span class="p"><span class="pre">&gt;</span></span><a class="headerlink" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat5buildE5indexI1T4IdxTERK8handle_tRK12index_paramsPK1T4IdxT8uint32_t" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Build the index from the dataset for efficient search. </p>
<p>NB: Currently, the following distance metrics are supported:</p><ul class="simple">
<li><p>L2Expanded</p></li>
<li><p>L2Unexpanded</p></li>
<li><p>InnerProduct</p></li>
</ul>
<p></p>
<p>Usage example: </p><div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">raft</span><span class="o">::</span><span class="nn">spatial</span><span class="o">::</span><span class="nn">knn</span><span class="p">;</span><span class="w"></span>
<span class="c1">// use default index parameters</span>
<span class="n">ivf_flat</span><span class="o">::</span><span class="n">index_params</span><span class="w"> </span><span class="n">index_params</span><span class="p">;</span><span class="w"></span>
<span class="c1">// create and fill the index from a [N, D] dataset</span>
<span class="k">auto</span><span class="w"> </span><span class="n">index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ivf_flat</span><span class="o">::</span><span class="n">build</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span><span class="w"> </span><span class="n">index_params</span><span class="p">,</span><span class="w"> </span><span class="n">dataset</span><span class="p">,</span><span class="w"> </span><span class="n">N</span><span class="p">,</span><span class="w"> </span><span class="n">D</span><span class="p">);</span><span class="w"></span>
<span class="c1">// use default search parameters</span>
<span class="n">ivf_flat</span><span class="o">::</span><span class="n">search_params</span><span class="w"> </span><span class="n">search_params</span><span class="p">;</span><span class="w"></span>
<span class="c1">// search K nearest neighbours for each of the N queries</span>
<span class="n">ivf_flat</span><span class="o">::</span><span class="n">search</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span><span class="w"> </span><span class="n">search_params</span><span class="p">,</span><span class="w"> </span><span class="n">index</span><span class="p">,</span><span class="w"> </span><span class="n">queries</span><span class="p">,</span><span class="w"> </span><span class="n">N</span><span class="p">,</span><span class="w"> </span><span class="n">K</span><span class="p">,</span><span class="w"> </span><span class="n">out_inds</span><span class="p">,</span><span class="w"> </span><span class="n">out_dists</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p></p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>T</strong> &ndash; data element type </p></li>
<li><p><strong>IdxT</strong> &ndash; type of the indices in the source dataset</p></li>
</ul>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>handle</strong> &ndash; </p></li>
<li><p><strong>params</strong> &ndash; configure the index building </p></li>
<li><p><strong>dataset</strong> &ndash; <strong>[in]</strong> a device pointer to a row-major matrix [n_rows, dim] </p></li>
<li><p><strong>n_rows</strong> &ndash; the number of samples </p></li>
<li><p><strong>dim</strong> &ndash; the dimensionality of the data</p></li>
</ul>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the constructed ivf-flat index </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I00EN4raft7spatial3knn8ivf_flat6extendE5indexI1T4IdxTERK8handle_tRK5indexI1T4IdxTEPK1TPK4IdxT4IdxT">
<span id="_CPPv3I00EN4raft7spatial3knn8ivf_flat6extendERK8handle_tRK5indexI1T4IdxTEPK1TPK4IdxT4IdxT"></span><span id="_CPPv2I00EN4raft7spatial3knn8ivf_flat6extendERK8handle_tRK5indexI1T4IdxTEPK1TPK4IdxT4IdxT"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">IdxT</span></span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="namespaceraft_1_1spatial_1_1knn_1_1ivf__flat_1a424709dd33226264363e5d84f4fead28"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">extend</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="core.html#_CPPv4N4raft8handle_tE" title="raft::handle_t"><span class="n"><span class="pre">handle_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">handle</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat5indexE" title="raft::spatial::knn::ivf_flat::index"><span class="n"><span class="pre">index</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat6extendE5indexI1T4IdxTERK8handle_tRK5indexI1T4IdxTEPK1TPK4IdxT4IdxT" title="raft::spatial::knn::ivf_flat::extend::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat6extendE5indexI1T4IdxTERK8handle_tRK5indexI1T4IdxTEPK1TPK4IdxT4IdxT" title="raft::spatial::knn::ivf_flat::extend::IdxT"><span class="n"><span class="pre">IdxT</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">orig_index</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat6extendE5indexI1T4IdxTERK8handle_tRK5indexI1T4IdxTEPK1TPK4IdxT4IdxT" title="raft::spatial::knn::ivf_flat::extend::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">new_vectors</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat6extendE5indexI1T4IdxTERK8handle_tRK5indexI1T4IdxTEPK1TPK4IdxT4IdxT" title="raft::spatial::knn::ivf_flat::extend::IdxT"><span class="n"><span class="pre">IdxT</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">new_indices</span></span>, <a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat6extendE5indexI1T4IdxTERK8handle_tRK5indexI1T4IdxTEPK1TPK4IdxT4IdxT" title="raft::spatial::knn::ivf_flat::extend::IdxT"><span class="n"><span class="pre">IdxT</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">n_rows</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="o"><span class="pre">-&gt;</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat5indexE" title="raft::spatial::knn::ivf_flat::index"><span class="n"><span class="pre">index</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat6extendE5indexI1T4IdxTERK8handle_tRK5indexI1T4IdxTEPK1TPK4IdxT4IdxT" title="raft::spatial::knn::ivf_flat::extend::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat6extendE5indexI1T4IdxTERK8handle_tRK5indexI1T4IdxTEPK1TPK4IdxT4IdxT" title="raft::spatial::knn::ivf_flat::extend::IdxT"><span class="n"><span class="pre">IdxT</span></span></a><span class="p"><span class="pre">&gt;</span></span><a class="headerlink" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat6extendE5indexI1T4IdxTERK8handle_tRK5indexI1T4IdxTEPK1TPK4IdxT4IdxT" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Build a new index containing the data of the original plus new extra vectors. </p>
<p>Implementation note: The new data is clustered according to existing kmeans clusters, then the cluster centers are adjusted to match the newly labeled data.</p>
<p>Usage example: </p><div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">raft</span><span class="o">::</span><span class="nn">spatial</span><span class="o">::</span><span class="nn">knn</span><span class="p">;</span><span class="w"></span>
<span class="n">ivf_flat</span><span class="o">::</span><span class="n">index_params</span><span class="w"> </span><span class="n">index_params</span><span class="p">;</span><span class="w"></span>
<span class="n">index_params</span><span class="p">.</span><span class="n">add_data_on_build</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span><span class="w">      </span><span class="c1">// don't populate index on build</span>
<span class="n">index_params</span><span class="p">.</span><span class="n">kmeans_trainset_fraction</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0</span><span class="p">;</span><span class="w"> </span><span class="c1">// use whole dataset for kmeans training</span>
<span class="c1">// train the index from a [N, D] dataset</span>
<span class="k">auto</span><span class="w"> </span><span class="n">index_empty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ivf_flat</span><span class="o">::</span><span class="n">build</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span><span class="w"> </span><span class="n">index_params</span><span class="p">,</span><span class="w"> </span><span class="n">dataset</span><span class="p">,</span><span class="w"> </span><span class="n">N</span><span class="p">,</span><span class="w"> </span><span class="n">D</span><span class="p">);</span><span class="w"></span>
<span class="c1">// fill the index with the data</span>
<span class="k">auto</span><span class="w"> </span><span class="n">index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ivf_flat</span><span class="o">::</span><span class="n">extend</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span><span class="w"> </span><span class="n">index_empty</span><span class="p">,</span><span class="w"> </span><span class="n">dataset</span><span class="p">,</span><span class="w"> </span><span class="k">nullptr</span><span class="p">,</span><span class="w"> </span><span class="n">N</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p></p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>T</strong> &ndash; data element type </p></li>
<li><p><strong>IdxT</strong> &ndash; type of the indices in the source dataset</p></li>
</ul>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>handle</strong> &ndash; </p></li>
<li><p><strong>orig_index</strong> &ndash; original index </p></li>
<li><p><strong>new_vectors</strong> &ndash; <strong>[in]</strong> a device pointer to a row-major matrix [n_rows, index.dim()] </p></li>
<li><p><strong>new_indices</strong> &ndash; <strong>[in]</strong> a device pointer to a vector of indices [n_rows]. If the original index is empty (<code class="docutils literal notranslate"><span class="pre">orig_index.size()</span> <span class="pre">==</span> <span class="pre">0</span></code>), you can pass <code class="docutils literal notranslate"><span class="pre">nullptr</span></code> here to imply a continuous range <code class="docutils literal notranslate"><span class="pre">[0...n_rows)</span></code>. </p></li>
<li><p><strong>n_rows</strong> &ndash; the number of samples</p></li>
</ul>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the constructed extended ivf-flat index </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I00EN4raft7spatial3knn8ivf_flat6searchEvRK8handle_tRK13search_paramsRK5indexI1T4IdxTEPK1T8uint32_t8uint32_tP4IdxTPfPN3rmm2mr22device_memory_resourceE">
<span id="_CPPv3I00EN4raft7spatial3knn8ivf_flat6searchERK8handle_tRK13search_paramsRK5indexI1T4IdxTEPK1T8uint32_t8uint32_tP4IdxTPfPN3rmm2mr22device_memory_resourceE"></span><span id="_CPPv2I00EN4raft7spatial3knn8ivf_flat6searchERK8handle_tRK13search_paramsRK5indexI1T4IdxTEPK1T8uint32_t8uint32_tP4IdxTPfPN3rmm2mr22device_memory_resourceE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">IdxT</span></span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="namespaceraft_1_1spatial_1_1knn_1_1ivf__flat_1a8581684992f1669e42ec02c09c8347ee"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">search</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="core.html#_CPPv4N4raft8handle_tE" title="raft::handle_t"><span class="n"><span class="pre">handle_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">handle</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N4raft7spatial3knn8ivf_flat13search_paramsE" title="raft::spatial::knn::ivf_flat::search_params"><span class="n"><span class="pre">search_params</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">params</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat6searchEvRK8handle_tRK13search_paramsRK5indexI1T4IdxTEPK1T8uint32_t8uint32_tP4IdxTPfPN3rmm2mr22device_memory_resourceE" title="raft::spatial::knn::ivf_flat::search::index"><span class="n"><span class="pre">index</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat6searchEvRK8handle_tRK13search_paramsRK5indexI1T4IdxTEPK1T8uint32_t8uint32_tP4IdxTPfPN3rmm2mr22device_memory_resourceE" title="raft::spatial::knn::ivf_flat::search::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat6searchEvRK8handle_tRK13search_paramsRK5indexI1T4IdxTEPK1T8uint32_t8uint32_tP4IdxTPfPN3rmm2mr22device_memory_resourceE" title="raft::spatial::knn::ivf_flat::search::IdxT"><span class="n"><span class="pre">IdxT</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">index</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat6searchEvRK8handle_tRK13search_paramsRK5indexI1T4IdxTEPK1T8uint32_t8uint32_tP4IdxTPfPN3rmm2mr22device_memory_resourceE" title="raft::spatial::knn::ivf_flat::search::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">queries</span></span>, <span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">n_queries</span></span>, <span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">k</span></span>, <a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat6searchEvRK8handle_tRK13search_paramsRK5indexI1T4IdxTEPK1T8uint32_t8uint32_tP4IdxTPfPN3rmm2mr22device_memory_resourceE" title="raft::spatial::knn::ivf_flat::search::IdxT"><span class="n"><span class="pre">IdxT</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">neighbors</span></span>, <span class="kt"><span class="pre">float</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">distances</span></span>, <span class="n"><span class="pre">rmm</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">mr</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">device_memory_resource</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">mr</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">nullptr</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat6searchEvRK8handle_tRK13search_paramsRK5indexI1T4IdxTEPK1T8uint32_t8uint32_tP4IdxTPfPN3rmm2mr22device_memory_resourceE" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Search ANN using the constructed index. </p>
<p>See the <a class="reference external" href="#ivf_flat::build">ivf_flat::build</a> documentation for a usage example.</p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>T</strong> &ndash; data element type </p></li>
<li><p><strong>IdxT</strong> &ndash; type of the indices</p></li>
</ul>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>handle</strong> &ndash; </p></li>
<li><p><strong>params</strong> &ndash; configure the search </p></li>
<li><p><strong>index</strong> &ndash; ivf-flat constructed index </p></li>
<li><p><strong>queries</strong> &ndash; <strong>[in]</strong> a device pointer to a row-major matrix [n_queries, index-&gt;dim()] </p></li>
<li><p><strong>n_queries</strong> &ndash; the batch size </p></li>
<li><p><strong>k</strong> &ndash; the number of neighbors to find for each query. </p></li>
<li><p><strong>neighbors</strong> &ndash; <strong>[out]</strong> a device pointer to the indices of the neighbors in the source dataset [n_queries, k] </p></li>
<li><p><strong>distances</strong> &ndash; <strong>[out]</strong> a device pointer to the distances to the selected neighbors [n_queries, k] </p></li>
<li><p><strong>mr</strong> &ndash; an optional memory resource to use across the searches (you can provide a large enough memory pool here to avoid memory allocations within search). </p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-variables">Variables</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4raft7spatial3knn8ivf_flat15kIndexGroupSizeE">
<span id="_CPPv3N4raft7spatial3knn8ivf_flat15kIndexGroupSizeE"></span><span id="_CPPv2N4raft7spatial3knn8ivf_flat15kIndexGroupSizeE"></span><span id="raft::spatial::knn::ivf_flat::kIndexGroupSize__uint32_t"></span><span class="target" id="namespaceraft_1_1spatial_1_1knn_1_1ivf__flat_1a6319667e75c70a4ad40b77aee54a0c62"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">kIndexGroupSize</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">32</span></span><a class="headerlink" href="#_CPPv4N4raft7spatial3knn8ivf_flat15kIndexGroupSizeE" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Size of the interleaved group (see <code class="docutils literal notranslate"><span class="pre">index::data</span></code> description). </p>
</dd></dl>

</div>
<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv4I00EN4raft7spatial3knn8ivf_flat5indexE">
<span id="_CPPv3I00EN4raft7spatial3knn8ivf_flat5indexE"></span><span id="_CPPv2I00EN4raft7spatial3knn8ivf_flat5indexE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">IdxT</span></span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="structraft_1_1spatial_1_1knn_1_1ivf__flat_1_1index"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">index</span></span></span><span class="w"> </span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="k"><span class="pre">public</span></span><span class="w"> </span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">spatial</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="#_CPPv4N4raft7spatial3knnE" title="raft::spatial::knn"><span class="n"><span class="pre">knn</span></span></a><span class="p"><span class="pre">::</span></span><a class="reference internal" href="#_CPPv4N4raft7spatial3knn5indexE" title="raft::spatial::knn::index"><span class="n"><span class="pre">index</span></span></a><a class="headerlink" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat5indexE" title="Permalink to this definition">&para;</a><br></dt>
<dd><div class="docutils container">
<em>#include &lt;ivf_flat_types.hpp&gt;</em></div>
<p>IVF-flat index. </p>
<p>This structure is supposed to be immutable: it&rsquo;s only constructed using <code class="docutils literal notranslate"><span class="pre">ivf_flat::build</span></code>, and should never be modified. At the same time, we expose all its members and allow the aggregate construction, so that third-party users can implement custom serialization/deserialization routines or modify the index building process.</p>
<p>It would seem logical to make all the type&rsquo;s members constant. However, we can&rsquo;t do that because it would imply copying data when the index is moved. And we also cannot return <code class="docutils literal notranslate"><span class="pre">const</span> <span class="pre">index</span></code> in our factory functions, such as <code class="docutils literal notranslate"><span class="pre">ivf_flat::build</span></code>, because then the result couldn&rsquo;t be moved. Therefore, we return <code class="docutils literal notranslate"><span class="pre">index</span></code> mutable as-is, with a warning to the users that there are no protection mechanisms against manipulating the data.</p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>T</strong> &ndash; data element type </p></li>
<li><p><strong>IdxT</strong> &ndash; type of the indices in the source dataset </p></li>
</ul>
</dd>
</dl>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-functions">Public Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK4raft7spatial3knn8ivf_flat5index17check_consistencyEv">
<span id="_CPPv3NK4raft7spatial3knn8ivf_flat5index17check_consistencyEv"></span><span id="_CPPv2NK4raft7spatial3knn8ivf_flat5index17check_consistencyEv"></span><span id="raft::spatial::knn::ivf_flat::index::check_consistencyC"></span><span class="target" id="structraft_1_1spatial_1_1knn_1_1ivf__flat_1_1index_1a9a3db3deca4dead48984c6515048c245"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">check_consistency</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK4raft7spatial3knn8ivf_flat5index17check_consistencyEv" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Throw an error if the index content is inconsistent. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4raft7spatial3knn8ivf_flat5index6veclenE">
<span id="_CPPv3N4raft7spatial3knn8ivf_flat5index6veclenE"></span><span id="_CPPv2N4raft7spatial3knn8ivf_flat5index6veclenE"></span><span id="raft::spatial::knn::ivf_flat::index::veclen__uint32_tC"></span><span class="target" id="structraft_1_1spatial_1_1knn_1_1ivf__flat_1_1index_1a170b60c5009bb55ed0d3b872efc0a158"></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">veclen</span></span></span><a class="headerlink" href="#_CPPv4N4raft7spatial3knn8ivf_flat5index6veclenE" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Vectorized load/store size in elements, determines the size of interleaved data chunks.</p>
<p>TODO: in theory, we can lift this to the template parameter and keep it at hardware maximum possible value by padding the <code class="docutils literal notranslate"><span class="pre">dim</span></code> of the data <a class="reference external" href="https://github.com/rapidsai/raft/issues/711">https://github.com/rapidsai/raft/issues/711</a> </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4raft7spatial3knn8ivf_flat5index6metricE">
<span id="_CPPv3N4raft7spatial3knn8ivf_flat5index6metricE"></span><span id="_CPPv2N4raft7spatial3knn8ivf_flat5index6metricE"></span><span id="raft::spatial::knn::ivf_flat::index::metric__raft::distance::DistanceTypeC"></span><span class="target" id="structraft_1_1spatial_1_1knn_1_1ivf__flat_1_1index_1a5cbcf726cfc1c5e673b1cf203d3c002a"></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="#_CPPv4N4raft8distanceE" title="raft::distance"><span class="n"><span class="pre">distance</span></span></a><span class="p"><span class="pre">::</span></span><a class="reference internal" href="#_CPPv4N4raft8distance12DistanceTypeE" title="raft::distance::DistanceType"><span class="n"><span class="pre">DistanceType</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">metric</span></span></span><a class="headerlink" href="#_CPPv4N4raft7spatial3knn8ivf_flat5index6metricE" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Distance metric used for clustering. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4raft7spatial3knn8ivf_flat5index4sizeE">
<span id="_CPPv3N4raft7spatial3knn8ivf_flat5index4sizeE"></span><span id="_CPPv2N4raft7spatial3knn8ivf_flat5index4sizeE"></span><span id="raft::spatial::knn::ivf_flat::index::size__IdxTC"></span><span class="target" id="structraft_1_1spatial_1_1knn_1_1ivf__flat_1_1index_1a1e06621a1b7c324c39178ec7e07e4be8"></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat5indexE" title="raft::spatial::knn::ivf_flat::index::IdxT"><span class="n"><span class="pre">IdxT</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">size</span></span></span><a class="headerlink" href="#_CPPv4N4raft7spatial3knn8ivf_flat5index4sizeE" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Total length of the index. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4raft7spatial3knn8ivf_flat5index3dimE">
<span id="_CPPv3N4raft7spatial3knn8ivf_flat5index3dimE"></span><span id="_CPPv2N4raft7spatial3knn8ivf_flat5index3dimE"></span><span id="raft::spatial::knn::ivf_flat::index::dim__uint32_tC"></span><span class="target" id="structraft_1_1spatial_1_1knn_1_1ivf__flat_1_1index_1aa7c03ce1fbb2c6e65c229a48bf943009"></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">dim</span></span></span><a class="headerlink" href="#_CPPv4N4raft7spatial3knn8ivf_flat5index3dimE" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Dimensionality of the data. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4raft7spatial3knn8ivf_flat5index7n_listsE">
<span id="_CPPv3N4raft7spatial3knn8ivf_flat5index7n_listsE"></span><span id="_CPPv2N4raft7spatial3knn8ivf_flat5index7n_listsE"></span><span id="raft::spatial::knn::ivf_flat::index::n_lists__uint32_tC"></span><span class="target" id="structraft_1_1spatial_1_1knn_1_1ivf__flat_1_1index_1a604b5164d6edb4c97055b9ee2f4fb193"></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">n_lists</span></span></span><a class="headerlink" href="#_CPPv4N4raft7spatial3knn8ivf_flat5index7n_listsE" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Number of clusters/inverted lists. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4raft7spatial3knn8ivf_flat5index4dataE">
<span id="_CPPv3N4raft7spatial3knn8ivf_flat5index4dataE"></span><span id="_CPPv2N4raft7spatial3knn8ivf_flat5index4dataE"></span><span id="raft::spatial::knn::ivf_flat::index::data__rmm::device_uvector:T:"></span><span class="target" id="structraft_1_1spatial_1_1knn_1_1ivf__flat_1_1index_1a755726d8a902478a023e77b8d8c9e658"></span><span class="n"><span class="pre">rmm</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">device_uvector</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat5indexE" title="raft::spatial::knn::ivf_flat::index::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">data</span></span></span><a class="headerlink" href="#_CPPv4N4raft7spatial3knn8ivf_flat5index4dataE" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Inverted list data [size, dim].</p>
<p>The data consists of the dataset rows, grouped by their labels (into clusters/lists). Within each list (cluster), the data is grouped into blocks of <code class="docutils literal notranslate"><span class="pre">kGroupSize</span></code> interleaved vectors. Note, the total index length is slightly larger than the source dataset length, because each cluster is padded by <code class="docutils literal notranslate"><span class="pre">kGroupSize</span></code> elements.</p>
<p>Interleaving pattern: within groups of <code class="docutils literal notranslate"><span class="pre">kGroupSize</span></code> rows, the data is interleaved with the block size equal to <code class="docutils literal notranslate"><span class="pre">veclen</span> <span class="pre">*</span> <span class="pre">sizeof(T)</span></code>. That is, a chunk of <code class="docutils literal notranslate"><span class="pre">veclen</span></code> consecutive components of one row is followed by a chunk of the same size of the next row, and so on.</p>
<p><strong>Example</strong>: veclen = 2, dim = 6, kGroupSize = 32, list_size = 31 </p><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="o">...</span> <span class="n">x</span><span class="p">[</span><span class="mi">14</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">14</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">15</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">15</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="n">x</span><span class="p">[</span><span class="mi">16</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">16</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">17</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">17</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="o">...</span> <span class="n">x</span><span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>    <span class="o">-</span>    <span class="p">,</span>    <span class="o">-</span>    <span class="p">,</span>
<span class="n">x</span><span class="p">[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="o">...</span> <span class="n">x</span><span class="p">[</span><span class="mi">14</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">14</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">15</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">15</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
<span class="n">x</span><span class="p">[</span><span class="mi">16</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">16</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">17</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">17</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="o">...</span> <span class="n">x</span><span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>    <span class="o">-</span>    <span class="p">,</span>    <span class="o">-</span>    <span class="p">,</span>
<span class="n">x</span><span class="p">[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="o">...</span> <span class="n">x</span><span class="p">[</span><span class="mi">14</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">14</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">15</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
<span class="n">x</span><span class="p">[</span><span class="mi">16</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">16</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">17</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">17</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="o">...</span> <span class="n">x</span><span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>    <span class="o">-</span>    <span class="p">,</span>    <span class="o">-</span>    <span class="p">,</span>
</pre></div>
</div>
 <p></p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4raft7spatial3knn8ivf_flat5index7indicesE">
<span id="_CPPv3N4raft7spatial3knn8ivf_flat5index7indicesE"></span><span id="_CPPv2N4raft7spatial3knn8ivf_flat5index7indicesE"></span><span id="raft::spatial::knn::ivf_flat::index::indices__rmm::device_uvector:IdxT:"></span><span class="target" id="structraft_1_1spatial_1_1knn_1_1ivf__flat_1_1index_1a9569cc34e34a6d21582c3e4f5a7389e7"></span><span class="n"><span class="pre">rmm</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">device_uvector</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat5indexE" title="raft::spatial::knn::ivf_flat::index::IdxT"><span class="n"><span class="pre">IdxT</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">indices</span></span></span><a class="headerlink" href="#_CPPv4N4raft7spatial3knn8ivf_flat5index7indicesE" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Inverted list indices: ids of items in the source data [size] </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4raft7spatial3knn8ivf_flat5index10list_sizesE">
<span id="_CPPv3N4raft7spatial3knn8ivf_flat5index10list_sizesE"></span><span id="_CPPv2N4raft7spatial3knn8ivf_flat5index10list_sizesE"></span><span id="raft::spatial::knn::ivf_flat::index::list_sizes__rmm::device_uvector:uint32_t:"></span><span class="target" id="structraft_1_1spatial_1_1knn_1_1ivf__flat_1_1index_1ae4ab2990f0cc0c32a35e4e3198a4a473"></span><span class="n"><span class="pre">rmm</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">device_uvector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">uint32_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">list_sizes</span></span></span><a class="headerlink" href="#_CPPv4N4raft7spatial3knn8ivf_flat5index10list_sizesE" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Sizes of the lists (clusters) [n_lists] </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4raft7spatial3knn8ivf_flat5index12list_offsetsE">
<span id="_CPPv3N4raft7spatial3knn8ivf_flat5index12list_offsetsE"></span><span id="_CPPv2N4raft7spatial3knn8ivf_flat5index12list_offsetsE"></span><span id="raft::spatial::knn::ivf_flat::index::list_offsets__rmm::device_uvector:IdxT:"></span><span class="target" id="structraft_1_1spatial_1_1knn_1_1ivf__flat_1_1index_1af8ee79f32196c89b8b0649752ab5c1cc"></span><span class="n"><span class="pre">rmm</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">device_uvector</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat5indexE" title="raft::spatial::knn::ivf_flat::index::IdxT"><span class="n"><span class="pre">IdxT</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">list_offsets</span></span></span><a class="headerlink" href="#_CPPv4N4raft7spatial3knn8ivf_flat5index12list_offsetsE" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>Offsets into the lists [n_lists + 1]. The last value contains the total length of the index. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4raft7spatial3knn8ivf_flat5index7centersE">
<span id="_CPPv3N4raft7spatial3knn8ivf_flat5index7centersE"></span><span id="_CPPv2N4raft7spatial3knn8ivf_flat5index7centersE"></span><span id="raft::spatial::knn::ivf_flat::index::centers__rmm::device_uvector:float:"></span><span class="target" id="structraft_1_1spatial_1_1knn_1_1ivf__flat_1_1index_1a58d96077e409b60dd5dd54d125255188"></span><span class="n"><span class="pre">rmm</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">device_uvector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">float</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">centers</span></span></span><a class="headerlink" href="#_CPPv4N4raft7spatial3knn8ivf_flat5index7centersE" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>k-means cluster centers corresponding to the lists [n_lists, dim] </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4raft7spatial3knn8ivf_flat5index12center_normsE">
<span id="_CPPv3N4raft7spatial3knn8ivf_flat5index12center_normsE"></span><span id="_CPPv2N4raft7spatial3knn8ivf_flat5index12center_normsE"></span><span id="raft::spatial::knn::ivf_flat::index::center_norms__std::optional:rmm::device_uvector:float::"></span><span class="target" id="structraft_1_1spatial_1_1knn_1_1ivf__flat_1_1index_1a5cd46caf0630eee563fb540a3c7552e7"></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">optional</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">rmm</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">device_uvector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">float</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">center_norms</span></span></span><a class="headerlink" href="#_CPPv4N4raft7spatial3knn8ivf_flat5index12center_normsE" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>(Optional) Precomputed norms of the <code class="docutils literal notranslate"><span class="pre">centers</span></code> w.r.t. the chosen distance metric [n_lists] </p>
</dd></dl>

</div>
</dd></dl>

<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv4N4raft7spatial3knn8ivf_flat12index_paramsE">
<span id="_CPPv3N4raft7spatial3knn8ivf_flat12index_paramsE"></span><span id="_CPPv2N4raft7spatial3knn8ivf_flat12index_paramsE"></span><span id="raft::spatial::knn::ivf_flat::index_params"></span><span class="target" id="structraft_1_1spatial_1_1knn_1_1ivf__flat_1_1index__params"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">index_params</span></span></span><span class="w"> </span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="k"><span class="pre">public</span></span><span class="w"> </span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">spatial</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="#_CPPv4N4raft7spatial3knnE" title="raft::spatial::knn"><span class="n"><span class="pre">knn</span></span></a><span class="p"><span class="pre">::</span></span><a class="reference internal" href="#_CPPv4N4raft7spatial3knn12index_paramsE" title="raft::spatial::knn::index_params"><span class="n"><span class="pre">index_params</span></span></a><a class="headerlink" href="#_CPPv4N4raft7spatial3knn8ivf_flat12index_paramsE" title="Permalink to this definition">&para;</a><br></dt>
<dd><div class="docutils container">
<em>#include &lt;ivf_flat_types.hpp&gt;</em></div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4raft7spatial3knn8ivf_flat12index_params7n_listsE">
<span id="_CPPv3N4raft7spatial3knn8ivf_flat12index_params7n_listsE"></span><span id="_CPPv2N4raft7spatial3knn8ivf_flat12index_params7n_listsE"></span><span id="raft::spatial::knn::ivf_flat::index_params::n_lists__uint32_t"></span><span class="target" id="structraft_1_1spatial_1_1knn_1_1ivf__flat_1_1index__params_1af8f324b1e79215c4af261a4dc105e085"></span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">n_lists</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">1024</span></span><a class="headerlink" href="#_CPPv4N4raft7spatial3knn8ivf_flat12index_params7n_listsE" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>The number of inverted lists (clusters) </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4raft7spatial3knn8ivf_flat12index_params14kmeans_n_itersE">
<span id="_CPPv3N4raft7spatial3knn8ivf_flat12index_params14kmeans_n_itersE"></span><span id="_CPPv2N4raft7spatial3knn8ivf_flat12index_params14kmeans_n_itersE"></span><span id="raft::spatial::knn::ivf_flat::index_params::kmeans_n_iters__uint32_t"></span><span class="target" id="structraft_1_1spatial_1_1knn_1_1ivf__flat_1_1index__params_1a4d2f2a32ff4a00d9ef2876eae23a6ccf"></span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">kmeans_n_iters</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">20</span></span><a class="headerlink" href="#_CPPv4N4raft7spatial3knn8ivf_flat12index_params14kmeans_n_itersE" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>The number of iterations searching for kmeans centers (index building). </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4raft7spatial3knn8ivf_flat12index_params24kmeans_trainset_fractionE">
<span id="_CPPv3N4raft7spatial3knn8ivf_flat12index_params24kmeans_trainset_fractionE"></span><span id="_CPPv2N4raft7spatial3knn8ivf_flat12index_params24kmeans_trainset_fractionE"></span><span id="raft::spatial::knn::ivf_flat::index_params::kmeans_trainset_fraction__double"></span><span class="target" id="structraft_1_1spatial_1_1knn_1_1ivf__flat_1_1index__params_1a047e8ec857677d8cfead647fda9842a7"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">kmeans_trainset_fraction</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0.5</span></span><a class="headerlink" href="#_CPPv4N4raft7spatial3knn8ivf_flat12index_params24kmeans_trainset_fractionE" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>The fraction of data to use during iterative kmeans building. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv4N4raft7spatial3knn8ivf_flat13search_paramsE">
<span id="_CPPv3N4raft7spatial3knn8ivf_flat13search_paramsE"></span><span id="_CPPv2N4raft7spatial3knn8ivf_flat13search_paramsE"></span><span id="raft::spatial::knn::ivf_flat::search_params"></span><span class="target" id="structraft_1_1spatial_1_1knn_1_1ivf__flat_1_1search__params"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">search_params</span></span></span><span class="w"> </span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="k"><span class="pre">public</span></span><span class="w"> </span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">spatial</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="#_CPPv4N4raft7spatial3knnE" title="raft::spatial::knn"><span class="n"><span class="pre">knn</span></span></a><span class="p"><span class="pre">::</span></span><a class="reference internal" href="#_CPPv4N4raft7spatial3knn13search_paramsE" title="raft::spatial::knn::search_params"><span class="n"><span class="pre">search_params</span></span></a><a class="headerlink" href="#_CPPv4N4raft7spatial3knn8ivf_flat13search_paramsE" title="Permalink to this definition">&para;</a><br></dt>
<dd><div class="docutils container">
<em>#include &lt;ivf_flat_types.hpp&gt;</em></div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N4raft7spatial3knn8ivf_flat13search_params8n_probesE">
<span id="_CPPv3N4raft7spatial3knn8ivf_flat13search_params8n_probesE"></span><span id="_CPPv2N4raft7spatial3knn8ivf_flat13search_params8n_probesE"></span><span id="raft::spatial::knn::ivf_flat::search_params::n_probes__uint32_t"></span><span class="target" id="structraft_1_1spatial_1_1knn_1_1ivf__flat_1_1search__params_1ae11798df7987c1986aee094fb5180dd5"></span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">n_probes</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">20</span></span><a class="headerlink" href="#_CPPv4N4raft7spatial3knn8ivf_flat13search_params8n_probesE" title="Permalink to this definition">&para;</a><br></dt>
<dd><p>The number of clusters to search. </p>
</dd></dl>

</div>
</dd></dl>

</dd></dl>

</dd></dl>

<section id="ivf-flat">
<h3>IVF-Flat<a class="headerlink" href="#ivf-flat" title="Permalink to this heading">&para;</a></h3>
<dl class="cpp type">
<dt class="sig sig-object cpp">
<span class="target" id="namespaceraft_1_1spatial_1_1knn_1_1ivf__flat"></span><span class="k"><span class="pre">namespace</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ivf_flat</span></span></span><br></dt>
<dd><div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-functions">Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp">
<span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">IdxT</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">uint32_t</span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="namespaceraft_1_1spatial_1_1knn_1_1ivf__flat_1ad50e858132aa3fecc6ddae2b45973090"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">build</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="core.html#_CPPv4N4raft8handle_tE" title="raft::handle_t"><span class="n"><span class="pre">handle_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">handle</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N4raft7spatial3knn8ivf_flat12index_paramsE" title="raft::spatial::knn::ivf_flat::index_params"><span class="n"><span class="pre">index_params</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">params</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat5buildE5indexI1T4IdxTERK8handle_tRK12index_paramsPK1T4IdxT8uint32_t" title="raft::spatial::knn::ivf_flat::build::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">dataset</span></span>, <a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat5buildE5indexI1T4IdxTERK8handle_tRK12index_paramsPK1T4IdxT8uint32_t" title="raft::spatial::knn::ivf_flat::build::IdxT"><span class="n"><span class="pre">IdxT</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">n_rows</span></span>, <span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">dim</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="o"><span class="pre">-&gt;</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat5indexE" title="raft::spatial::knn::ivf_flat::index"><span class="n"><span class="pre">index</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat5buildE5indexI1T4IdxTERK8handle_tRK12index_paramsPK1T4IdxT8uint32_t" title="raft::spatial::knn::ivf_flat::build::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat5buildE5indexI1T4IdxTERK8handle_tRK12index_paramsPK1T4IdxT8uint32_t" title="raft::spatial::knn::ivf_flat::build::IdxT"><span class="n"><span class="pre">IdxT</span></span></a><span class="p"><span class="pre">&gt;</span></span><br></dt>
<dd><p>Build the index from the dataset for efficient search. </p>
<p>NB: Currently, the following distance metrics are supported:</p><ul class="simple">
<li><p>L2Expanded</p></li>
<li><p>L2Unexpanded</p></li>
<li><p>InnerProduct</p></li>
</ul>
<p></p>
<p>Usage example: </p><div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">raft</span><span class="o">::</span><span class="nn">spatial</span><span class="o">::</span><span class="nn">knn</span><span class="p">;</span><span class="w"></span>
<span class="c1">// use default index parameters</span>
<span class="n">ivf_flat</span><span class="o">::</span><span class="n">index_params</span><span class="w"> </span><span class="n">index_params</span><span class="p">;</span><span class="w"></span>
<span class="c1">// create and fill the index from a [N, D] dataset</span>
<span class="k">auto</span><span class="w"> </span><span class="n">index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ivf_flat</span><span class="o">::</span><span class="n">build</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span><span class="w"> </span><span class="n">index_params</span><span class="p">,</span><span class="w"> </span><span class="n">dataset</span><span class="p">,</span><span class="w"> </span><span class="n">N</span><span class="p">,</span><span class="w"> </span><span class="n">D</span><span class="p">);</span><span class="w"></span>
<span class="c1">// use default search parameters</span>
<span class="n">ivf_flat</span><span class="o">::</span><span class="n">search_params</span><span class="w"> </span><span class="n">search_params</span><span class="p">;</span><span class="w"></span>
<span class="c1">// search K nearest neighbours for each of the N queries</span>
<span class="n">ivf_flat</span><span class="o">::</span><span class="n">search</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span><span class="w"> </span><span class="n">search_params</span><span class="p">,</span><span class="w"> </span><span class="n">index</span><span class="p">,</span><span class="w"> </span><span class="n">queries</span><span class="p">,</span><span class="w"> </span><span class="n">N</span><span class="p">,</span><span class="w"> </span><span class="n">K</span><span class="p">,</span><span class="w"> </span><span class="n">out_inds</span><span class="p">,</span><span class="w"> </span><span class="n">out_dists</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p></p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>T</strong> &ndash; data element type </p></li>
<li><p><strong>IdxT</strong> &ndash; type of the indices in the source dataset</p></li>
</ul>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>handle</strong> &ndash; </p></li>
<li><p><strong>params</strong> &ndash; configure the index building </p></li>
<li><p><strong>dataset</strong> &ndash; <strong>[in]</strong> a device pointer to a row-major matrix [n_rows, dim] </p></li>
<li><p><strong>n_rows</strong> &ndash; the number of samples </p></li>
<li><p><strong>dim</strong> &ndash; the dimensionality of the data</p></li>
</ul>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the constructed ivf-flat index </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp">
<span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">IdxT</span></span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="namespaceraft_1_1spatial_1_1knn_1_1ivf__flat_1a424709dd33226264363e5d84f4fead28"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">extend</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="core.html#_CPPv4N4raft8handle_tE" title="raft::handle_t"><span class="n"><span class="pre">handle_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">handle</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat5indexE" title="raft::spatial::knn::ivf_flat::index"><span class="n"><span class="pre">index</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat6extendE5indexI1T4IdxTERK8handle_tRK5indexI1T4IdxTEPK1TPK4IdxT4IdxT" title="raft::spatial::knn::ivf_flat::extend::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat6extendE5indexI1T4IdxTERK8handle_tRK5indexI1T4IdxTEPK1TPK4IdxT4IdxT" title="raft::spatial::knn::ivf_flat::extend::IdxT"><span class="n"><span class="pre">IdxT</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">orig_index</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat6extendE5indexI1T4IdxTERK8handle_tRK5indexI1T4IdxTEPK1TPK4IdxT4IdxT" title="raft::spatial::knn::ivf_flat::extend::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">new_vectors</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat6extendE5indexI1T4IdxTERK8handle_tRK5indexI1T4IdxTEPK1TPK4IdxT4IdxT" title="raft::spatial::knn::ivf_flat::extend::IdxT"><span class="n"><span class="pre">IdxT</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">new_indices</span></span>, <a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat6extendE5indexI1T4IdxTERK8handle_tRK5indexI1T4IdxTEPK1TPK4IdxT4IdxT" title="raft::spatial::knn::ivf_flat::extend::IdxT"><span class="n"><span class="pre">IdxT</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">n_rows</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="o"><span class="pre">-&gt;</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat5indexE" title="raft::spatial::knn::ivf_flat::index"><span class="n"><span class="pre">index</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat6extendE5indexI1T4IdxTERK8handle_tRK5indexI1T4IdxTEPK1TPK4IdxT4IdxT" title="raft::spatial::knn::ivf_flat::extend::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat6extendE5indexI1T4IdxTERK8handle_tRK5indexI1T4IdxTEPK1TPK4IdxT4IdxT" title="raft::spatial::knn::ivf_flat::extend::IdxT"><span class="n"><span class="pre">IdxT</span></span></a><span class="p"><span class="pre">&gt;</span></span><br></dt>
<dd><p>Build a new index containing the data of the original plus new extra vectors. </p>
<p>Implementation note: The new data is clustered according to existing kmeans clusters, then the cluster centers are adjusted to match the newly labeled data.</p>
<p>Usage example: </p><div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">raft</span><span class="o">::</span><span class="nn">spatial</span><span class="o">::</span><span class="nn">knn</span><span class="p">;</span><span class="w"></span>
<span class="n">ivf_flat</span><span class="o">::</span><span class="n">index_params</span><span class="w"> </span><span class="n">index_params</span><span class="p">;</span><span class="w"></span>
<span class="n">index_params</span><span class="p">.</span><span class="n">add_data_on_build</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span><span class="w">      </span><span class="c1">// don't populate index on build</span>
<span class="n">index_params</span><span class="p">.</span><span class="n">kmeans_trainset_fraction</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0</span><span class="p">;</span><span class="w"> </span><span class="c1">// use whole dataset for kmeans training</span>
<span class="c1">// train the index from a [N, D] dataset</span>
<span class="k">auto</span><span class="w"> </span><span class="n">index_empty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ivf_flat</span><span class="o">::</span><span class="n">build</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span><span class="w"> </span><span class="n">index_params</span><span class="p">,</span><span class="w"> </span><span class="n">dataset</span><span class="p">,</span><span class="w"> </span><span class="n">N</span><span class="p">,</span><span class="w"> </span><span class="n">D</span><span class="p">);</span><span class="w"></span>
<span class="c1">// fill the index with the data</span>
<span class="k">auto</span><span class="w"> </span><span class="n">index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ivf_flat</span><span class="o">::</span><span class="n">extend</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span><span class="w"> </span><span class="n">index_empty</span><span class="p">,</span><span class="w"> </span><span class="n">dataset</span><span class="p">,</span><span class="w"> </span><span class="k">nullptr</span><span class="p">,</span><span class="w"> </span><span class="n">N</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p></p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>T</strong> &ndash; data element type </p></li>
<li><p><strong>IdxT</strong> &ndash; type of the indices in the source dataset</p></li>
</ul>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>handle</strong> &ndash; </p></li>
<li><p><strong>orig_index</strong> &ndash; original index </p></li>
<li><p><strong>new_vectors</strong> &ndash; <strong>[in]</strong> a device pointer to a row-major matrix [n_rows, index.dim()] </p></li>
<li><p><strong>new_indices</strong> &ndash; <strong>[in]</strong> a device pointer to a vector of indices [n_rows]. If the original index is empty (<code class="docutils literal notranslate"><span class="pre">orig_index.size()</span> <span class="pre">==</span> <span class="pre">0</span></code>), you can pass <code class="docutils literal notranslate"><span class="pre">nullptr</span></code> here to imply a continuous range <code class="docutils literal notranslate"><span class="pre">[0...n_rows)</span></code>. </p></li>
<li><p><strong>n_rows</strong> &ndash; the number of samples</p></li>
</ul>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the constructed extended ivf-flat index </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp">
<span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">IdxT</span></span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="namespaceraft_1_1spatial_1_1knn_1_1ivf__flat_1a8581684992f1669e42ec02c09c8347ee"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">search</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="core.html#_CPPv4N4raft8handle_tE" title="raft::handle_t"><span class="n"><span class="pre">handle_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">handle</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N4raft7spatial3knn8ivf_flat13search_paramsE" title="raft::spatial::knn::ivf_flat::search_params"><span class="n"><span class="pre">search_params</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">params</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat6searchEvRK8handle_tRK13search_paramsRK5indexI1T4IdxTEPK1T8uint32_t8uint32_tP4IdxTPfPN3rmm2mr22device_memory_resourceE" title="raft::spatial::knn::ivf_flat::search::index"><span class="n"><span class="pre">index</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat6searchEvRK8handle_tRK13search_paramsRK5indexI1T4IdxTEPK1T8uint32_t8uint32_tP4IdxTPfPN3rmm2mr22device_memory_resourceE" title="raft::spatial::knn::ivf_flat::search::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat6searchEvRK8handle_tRK13search_paramsRK5indexI1T4IdxTEPK1T8uint32_t8uint32_tP4IdxTPfPN3rmm2mr22device_memory_resourceE" title="raft::spatial::knn::ivf_flat::search::IdxT"><span class="n"><span class="pre">IdxT</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">index</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat6searchEvRK8handle_tRK13search_paramsRK5indexI1T4IdxTEPK1T8uint32_t8uint32_tP4IdxTPfPN3rmm2mr22device_memory_resourceE" title="raft::spatial::knn::ivf_flat::search::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">queries</span></span>, <span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">n_queries</span></span>, <span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">k</span></span>, <a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat6searchEvRK8handle_tRK13search_paramsRK5indexI1T4IdxTEPK1T8uint32_t8uint32_tP4IdxTPfPN3rmm2mr22device_memory_resourceE" title="raft::spatial::knn::ivf_flat::search::IdxT"><span class="n"><span class="pre">IdxT</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">neighbors</span></span>, <span class="kt"><span class="pre">float</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">distances</span></span>, <span class="n"><span class="pre">rmm</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">mr</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">device_memory_resource</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">mr</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">nullptr</span></span><span class="sig-paren">)</span><br></dt>
<dd><p>Search ANN using the constructed index. </p>
<p>See the <a class="reference external" href="#ivf_flat::build">ivf_flat::build</a> documentation for a usage example.</p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>T</strong> &ndash; data element type </p></li>
<li><p><strong>IdxT</strong> &ndash; type of the indices</p></li>
</ul>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>handle</strong> &ndash; </p></li>
<li><p><strong>params</strong> &ndash; configure the search </p></li>
<li><p><strong>index</strong> &ndash; ivf-flat constructed index </p></li>
<li><p><strong>queries</strong> &ndash; <strong>[in]</strong> a device pointer to a row-major matrix [n_queries, index-&gt;dim()] </p></li>
<li><p><strong>n_queries</strong> &ndash; the batch size </p></li>
<li><p><strong>k</strong> &ndash; the number of neighbors to find for each query. </p></li>
<li><p><strong>neighbors</strong> &ndash; <strong>[out]</strong> a device pointer to the indices of the neighbors in the source dataset [n_queries, k] </p></li>
<li><p><strong>distances</strong> &ndash; <strong>[out]</strong> a device pointer to the distances to the selected neighbors [n_queries, k] </p></li>
<li><p><strong>mr</strong> &ndash; an optional memory resource to use across the searches (you can provide a large enough memory pool here to avoid memory allocations within search). </p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-variables">Variables</p>
<dl class="cpp var">
<dt class="sig sig-object cpp">
<span class="target" id="namespaceraft_1_1spatial_1_1knn_1_1ivf__flat_1a6319667e75c70a4ad40b77aee54a0c62"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">kIndexGroupSize</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">32</span></span><br></dt>
<dd><p>Size of the interleaved group (see <code class="docutils literal notranslate"><span class="pre">index::data</span></code> description). </p>
</dd></dl>

</div>
<dl class="cpp struct">
<dt class="sig sig-object cpp">
<span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">IdxT</span></span></span><span class="p"><span class="pre">&gt;</span></span><br><span class="target" id="structraft_1_1spatial_1_1knn_1_1ivf__flat_1_1index"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">index</span></span></span><span class="w"> </span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="k"><span class="pre">public</span></span><span class="w"> </span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">spatial</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="#_CPPv4N4raft7spatial3knnE" title="raft::spatial::knn"><span class="n"><span class="pre">knn</span></span></a><span class="p"><span class="pre">::</span></span><a class="reference internal" href="#_CPPv4N4raft7spatial3knn5indexE" title="raft::spatial::knn::index"><span class="n"><span class="pre">index</span></span></a><br></dt>
<dd><div class="docutils container">
<em>#include &lt;ivf_flat_types.hpp&gt;</em></div>
<p>IVF-flat index. </p>
<p>This structure is supposed to be immutable: it&rsquo;s only constructed using <code class="docutils literal notranslate"><span class="pre">ivf_flat::build</span></code>, and should never be modified. At the same time, we expose all its members and allow the aggregate construction, so that third-party users can implement custom serialization/deserialization routines or modify the index building process.</p>
<p>It would seem logical to make all the type&rsquo;s members constant. However, we can&rsquo;t do that because it would imply copying data when the index is moved. And we also cannot return <code class="docutils literal notranslate"><span class="pre">const</span> <span class="pre">index</span></code> in our factory functions, such as <code class="docutils literal notranslate"><span class="pre">ivf_flat::build</span></code>, because then the result couldn&rsquo;t be moved. Therefore, we return <code class="docutils literal notranslate"><span class="pre">index</span></code> mutable as-is, with a warning to the users that there are no protection mechanisms against manipulating the data.</p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>T</strong> &ndash; data element type </p></li>
<li><p><strong>IdxT</strong> &ndash; type of the indices in the source dataset </p></li>
</ul>
</dd>
</dl>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-functions">Public Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp">
<span class="target" id="structraft_1_1spatial_1_1knn_1_1ivf__flat_1_1index_1a9a3db3deca4dead48984c6515048c245"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">check_consistency</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><br></dt>
<dd><p>Throw an error if the index content is inconsistent. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp">
<span class="target" id="structraft_1_1spatial_1_1knn_1_1ivf__flat_1_1index_1a170b60c5009bb55ed0d3b872efc0a158"></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">veclen</span></span></span><br></dt>
<dd><p>Vectorized load/store size in elements, determines the size of interleaved data chunks.</p>
<p>TODO: in theory, we can lift this to the template parameter and keep it at hardware maximum possible value by padding the <code class="docutils literal notranslate"><span class="pre">dim</span></code> of the data <a class="reference external" href="https://github.com/rapidsai/raft/issues/711">https://github.com/rapidsai/raft/issues/711</a> </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp">
<span class="target" id="structraft_1_1spatial_1_1knn_1_1ivf__flat_1_1index_1a5cbcf726cfc1c5e673b1cf203d3c002a"></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="#_CPPv4N4raft8distanceE" title="raft::distance"><span class="n"><span class="pre">distance</span></span></a><span class="p"><span class="pre">::</span></span><a class="reference internal" href="#_CPPv4N4raft8distance12DistanceTypeE" title="raft::distance::DistanceType"><span class="n"><span class="pre">DistanceType</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">metric</span></span></span><br></dt>
<dd><p>Distance metric used for clustering. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp">
<span class="target" id="structraft_1_1spatial_1_1knn_1_1ivf__flat_1_1index_1a1e06621a1b7c324c39178ec7e07e4be8"></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat5indexE" title="raft::spatial::knn::ivf_flat::index::IdxT"><span class="n"><span class="pre">IdxT</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">size</span></span></span><br></dt>
<dd><p>Total length of the index. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp">
<span class="target" id="structraft_1_1spatial_1_1knn_1_1ivf__flat_1_1index_1aa7c03ce1fbb2c6e65c229a48bf943009"></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">dim</span></span></span><br></dt>
<dd><p>Dimensionality of the data. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp">
<span class="target" id="structraft_1_1spatial_1_1knn_1_1ivf__flat_1_1index_1a604b5164d6edb4c97055b9ee2f4fb193"></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">n_lists</span></span></span><br></dt>
<dd><p>Number of clusters/inverted lists. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp">
<span class="target" id="structraft_1_1spatial_1_1knn_1_1ivf__flat_1_1index_1a755726d8a902478a023e77b8d8c9e658"></span><span class="n"><span class="pre">rmm</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">device_uvector</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat5indexE" title="raft::spatial::knn::ivf_flat::index::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">data</span></span></span><br></dt>
<dd><p>Inverted list data [size, dim].</p>
<p>The data consists of the dataset rows, grouped by their labels (into clusters/lists). Within each list (cluster), the data is grouped into blocks of <code class="docutils literal notranslate"><span class="pre">kGroupSize</span></code> interleaved vectors. Note, the total index length is slightly larger than the source dataset length, because each cluster is padded by <code class="docutils literal notranslate"><span class="pre">kGroupSize</span></code> elements.</p>
<p>Interleaving pattern: within groups of <code class="docutils literal notranslate"><span class="pre">kGroupSize</span></code> rows, the data is interleaved with the block size equal to <code class="docutils literal notranslate"><span class="pre">veclen</span> <span class="pre">*</span> <span class="pre">sizeof(T)</span></code>. That is, a chunk of <code class="docutils literal notranslate"><span class="pre">veclen</span></code> consecutive components of one row is followed by a chunk of the same size of the next row, and so on.</p>
<p><strong>Example</strong>: veclen = 2, dim = 6, kGroupSize = 32, list_size = 31 </p><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="o">...</span> <span class="n">x</span><span class="p">[</span><span class="mi">14</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">14</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">15</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">15</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="n">x</span><span class="p">[</span><span class="mi">16</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">16</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">17</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">17</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="o">...</span> <span class="n">x</span><span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>    <span class="o">-</span>    <span class="p">,</span>    <span class="o">-</span>    <span class="p">,</span>
<span class="n">x</span><span class="p">[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="o">...</span> <span class="n">x</span><span class="p">[</span><span class="mi">14</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">14</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">15</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">15</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
<span class="n">x</span><span class="p">[</span><span class="mi">16</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">16</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">17</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">17</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="o">...</span> <span class="n">x</span><span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>    <span class="o">-</span>    <span class="p">,</span>    <span class="o">-</span>    <span class="p">,</span>
<span class="n">x</span><span class="p">[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="o">...</span> <span class="n">x</span><span class="p">[</span><span class="mi">14</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">14</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">15</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
<span class="n">x</span><span class="p">[</span><span class="mi">16</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">16</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">17</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">17</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="o">...</span> <span class="n">x</span><span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>    <span class="o">-</span>    <span class="p">,</span>    <span class="o">-</span>    <span class="p">,</span>
</pre></div>
</div>
 <p></p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp">
<span class="target" id="structraft_1_1spatial_1_1knn_1_1ivf__flat_1_1index_1a9569cc34e34a6d21582c3e4f5a7389e7"></span><span class="n"><span class="pre">rmm</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">device_uvector</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat5indexE" title="raft::spatial::knn::ivf_flat::index::IdxT"><span class="n"><span class="pre">IdxT</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">indices</span></span></span><br></dt>
<dd><p>Inverted list indices: ids of items in the source data [size] </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp">
<span class="target" id="structraft_1_1spatial_1_1knn_1_1ivf__flat_1_1index_1ae4ab2990f0cc0c32a35e4e3198a4a473"></span><span class="n"><span class="pre">rmm</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">device_uvector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">uint32_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">list_sizes</span></span></span><br></dt>
<dd><p>Sizes of the lists (clusters) [n_lists] </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp">
<span class="target" id="structraft_1_1spatial_1_1knn_1_1ivf__flat_1_1index_1af8ee79f32196c89b8b0649752ab5c1cc"></span><span class="n"><span class="pre">rmm</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">device_uvector</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I00EN4raft7spatial3knn8ivf_flat5indexE" title="raft::spatial::knn::ivf_flat::index::IdxT"><span class="n"><span class="pre">IdxT</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">list_offsets</span></span></span><br></dt>
<dd><p>Offsets into the lists [n_lists + 1]. The last value contains the total length of the index. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp">
<span class="target" id="structraft_1_1spatial_1_1knn_1_1ivf__flat_1_1index_1a58d96077e409b60dd5dd54d125255188"></span><span class="n"><span class="pre">rmm</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">device_uvector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">float</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">centers</span></span></span><br></dt>
<dd><p>k-means cluster centers corresponding to the lists [n_lists, dim] </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp">
<span class="target" id="structraft_1_1spatial_1_1knn_1_1ivf__flat_1_1index_1a5cd46caf0630eee563fb540a3c7552e7"></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">optional</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">rmm</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">device_uvector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">float</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">center_norms</span></span></span><br></dt>
<dd><p>(Optional) Precomputed norms of the <code class="docutils literal notranslate"><span class="pre">centers</span></code> w.r.t. the chosen distance metric [n_lists] </p>
</dd></dl>

</div>
</dd></dl>

<dl class="cpp struct">
<dt class="sig sig-object cpp">
<span class="target" id="structraft_1_1spatial_1_1knn_1_1ivf__flat_1_1index__params"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">index_params</span></span></span><span class="w"> </span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="k"><span class="pre">public</span></span><span class="w"> </span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">spatial</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="#_CPPv4N4raft7spatial3knnE" title="raft::spatial::knn"><span class="n"><span class="pre">knn</span></span></a><span class="p"><span class="pre">::</span></span><a class="reference internal" href="#_CPPv4N4raft7spatial3knn12index_paramsE" title="raft::spatial::knn::index_params"><span class="n"><span class="pre">index_params</span></span></a><br></dt>
<dd><div class="docutils container">
<em>#include &lt;ivf_flat_types.hpp&gt;</em></div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp">
<span class="target" id="structraft_1_1spatial_1_1knn_1_1ivf__flat_1_1index__params_1af8f324b1e79215c4af261a4dc105e085"></span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">n_lists</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">1024</span></span><br></dt>
<dd><p>The number of inverted lists (clusters) </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp">
<span class="target" id="structraft_1_1spatial_1_1knn_1_1ivf__flat_1_1index__params_1a4d2f2a32ff4a00d9ef2876eae23a6ccf"></span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">kmeans_n_iters</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">20</span></span><br></dt>
<dd><p>The number of iterations searching for kmeans centers (index building). </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp">
<span class="target" id="structraft_1_1spatial_1_1knn_1_1ivf__flat_1_1index__params_1a047e8ec857677d8cfead647fda9842a7"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">kmeans_trainset_fraction</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0.5</span></span><br></dt>
<dd><p>The fraction of data to use during iterative kmeans building. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="cpp struct">
<dt class="sig sig-object cpp">
<span class="target" id="structraft_1_1spatial_1_1knn_1_1ivf__flat_1_1search__params"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">search_params</span></span></span><span class="w"> </span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="k"><span class="pre">public</span></span><span class="w"> </span><span class="n"><span class="pre">raft</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">spatial</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="#_CPPv4N4raft7spatial3knnE" title="raft::spatial::knn"><span class="n"><span class="pre">knn</span></span></a><span class="p"><span class="pre">::</span></span><a class="reference internal" href="#_CPPv4N4raft7spatial3knn13search_paramsE" title="raft::spatial::knn::search_params"><span class="n"><span class="pre">search_params</span></span></a><br></dt>
<dd><div class="docutils container">
<em>#include &lt;ivf_flat_types.hpp&gt;</em></div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp">
<span class="target" id="structraft_1_1spatial_1_1knn_1_1ivf__flat_1_1search__params_1ae11798df7987c1986aee094fb5180dd5"></span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">n_probes</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">20</span></span><br></dt>
<dd><p>The number of clusters to search. </p>
</dd></dl>

</div>
</dd></dl>

</dd></dl>

</section>
</section>
</section>


           </div>
          </div>
          <footer><div aria-label="Footer" class="rst-footer-buttons" role="navigation">
        <a accesskey="p" class="btn btn-neutral float-left" href="random.html" rel="prev" title="Random"><span aria-hidden="true" class="fa fa-arrow-circle-left"></span> Previous</a>
        <a accesskey="n" class="btn btn-neutral float-right" href="sparse.html" rel="next" title="Sparse">Next <span aria-hidden="true" class="fa fa-arrow-circle-right"></span></a>
    </div>

  <hr>

  <div role="contentinfo">
    <p>&copy; Copyright 2022, nvidia.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 


<script defer id="rapids-selector-js" src="/assets/js/custom.js"></script><script id="rapids-selector-pixel-invocation" type="text/javascript">_satellite.pageBottom();</script></body></html>