
<!DOCTYPE html>

<html class="writer-html5" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Getting Started with CLX and Streamz — clx 0.16.0 documentation</title>
<link href="_static/css/theme.css" rel="stylesheet" type="text/css"/>
<link href="_static/pygments.css" rel="stylesheet" type="text/css"/>
<link href="_static/params.css" rel="stylesheet" type="text/css"/>
<!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
<script data-url_root="./" id="documentation_options" src="_static/documentation_options.js" type="text/javascript"></script>
<script src="_static/jquery.js"></script>
<script src="_static/underscore.js"></script>
<script src="_static/doctools.js"></script>
<script src="_static/language_data.js"></script>
<script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
<script src="_static/js/theme.js" type="text/javascript"></script>
<link href="genindex.html" rel="index" title="Index"/>
<link href="search.html" rel="search" title="Search"/>
<link href="intro-clx-dga.html" rel="prev" title="CLX DGA Detection"/>
<link href="/assets/css/custom.css" id="rapids-selector-css" rel="stylesheet"/></head>
<body class="wy-body-for-nav">
<div class="wy-grid-for-nav">
<nav class="wy-nav-side" data-toggle="wy-nav-shift">
<div class="wy-side-scroll">
<div class="wy-side-nav-search"><div id="rapids-sphinx-container"><div class="rapids-home-container"><a class="rapids-home-container__home-btn" href="/api">Home</a></div><div class="rapids-selector__container rapids-selector--hidden"><div class="rapids-selector__selected">clx</div><div class="rapids-selector__menu"><a class="rapids-selector__menu-item rapids-selector__menu-item--selected" href="/api/clx/stable/api.html">clx</a><a class="rapids-selector__menu-item" href="/api/cudf/stable/api.html">cudf</a><a class="rapids-selector__menu-item" href="/api/cudf-java/stable">cudf-java</a><a class="rapids-selector__menu-item" href="/api/cugraph/stable/api.html">cugraph</a><a class="rapids-selector__menu-item" href="/api/cuml/stable/api.html">cuml</a><a class="rapids-selector__menu-item" href="/api/cusignal/stable/api.html">cusignal</a><a class="rapids-selector__menu-item" href="/api/cuspatial/stable/api.html">cuspatial</a><a class="rapids-selector__menu-item" href="/api/cuxfilter/stable">cuxfilter</a><a class="rapids-selector__menu-item" href="/api/libcudf/stable/namespacecudf.html">libcudf</a><a class="rapids-selector__menu-item" href="/api/libcugraph/stable">libcugraph</a><a class="rapids-selector__menu-item" href="/api/libcuml/stable">libcuml</a><a class="rapids-selector__menu-item" href="/api/librmm/stable/annotated.html">librmm</a><a class="rapids-selector__menu-item" href="/api/rmm/stable/api.html">rmm</a></div></div><div class="rapids-selector__container rapids-selector--hidden"><div class="rapids-selector__selected">legacy (0.16)</div><div class="rapids-selector__menu"><a class="rapids-selector__menu-item" href="/api/clx/nightly/api.html">nightly (0.18)</a><a class="rapids-selector__menu-item" href="/api/clx/stable/api.html">stable (0.17)</a><a class="rapids-selector__menu-item rapids-selector__menu-item--selected" href="/api/clx/legacy/api.html">legacy (0.16)</a></div></div></div>
<div role="search">
<form action="search.html" class="wy-form" id="rtd-search-form" method="get">
<input name="q" placeholder="Search docs" type="text"/>
<input name="check_keywords" type="hidden" value="yes"/>
<input name="area" type="hidden" value="default"/>
</form>
</div>
</div>
<div aria-label="main navigation" class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation">
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="api.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="10min-clx.html">10 minutes to CLX</a></li>
<li class="toctree-l1"><a class="reference internal" href="intro-clx-workflow.html">CLX Workflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="intro-clx-dga.html">CLX DGA Detection</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Getting Started with CLX and Streamz</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Build-Quickstart-Docker-Image">Build Quickstart Docker Image</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Running-cyBERT-Inference-Pipeline">Running cyBERT Inference Pipeline</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Capturing-Benchmarks">Capturing Benchmarks</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Run-cyBERT-Streamz-Example-on-Apache-Logs">Run cyBERT Streamz Example on Apache Logs</a></li>
</ul>
</li>
</ul>
</div>
</div>
</nav>
<section class="wy-nav-content-wrap" data-toggle="wy-nav-shift">
<nav aria-label="top navigation" class="wy-nav-top">
<i class="fa fa-bars" data-toggle="wy-nav-top"></i>
<a href="index.html">clx</a>
</nav>
<div class="wy-nav-content">
<div class="rst-content">
<div aria-label="breadcrumbs navigation" role="navigation">
<ul class="wy-breadcrumbs">
<li><a class="icon icon-home" href="index.html"></a> »</li>
<li>Getting Started with CLX and Streamz</li>
<li class="wy-breadcrumbs-aside">
<a href="_sources/intro-clx-streamz.ipynb.txt" rel="nofollow"> View page source</a>
</li>
</ul>
<hr/>
</div>
<div class="document" itemscope="itemscope" itemtype="http://schema.org/Article" role="main">
<div itemprop="articleBody">
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container,
div.nbinput.container div.prompt,
div.nbinput.container div.input_area,
div.nbinput.container div[class*=highlight],
div.nbinput.container div[class*=highlight] pre,
div.nboutput.container,
div.nboutput.container div.prompt,
div.nboutput.container div.output_area,
div.nboutput.container div[class*=highlight],
div.nboutput.container div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="Getting-Started-with-CLX-and-Streamz">
<h1>Getting Started with CLX and Streamz<a class="headerlink" href="#Getting-Started-with-CLX-and-Streamz" title="Permalink to this headline">¶</a></h1>
<p>This is a guide on how <a class="reference external" href="https://github.com/rapidsai/clx">CLX</a> and <a class="reference external" href="https://streamz.readthedocs.io/en/latest/">Streamz</a> can be used to build a streaming inference pipeline. We will use CLX’s cyBERT for inference.</p>
<p>Streamz has the ability to read from <a class="reference external" href="https://kafka.apache.org/">Kafka</a> directly into <a class="reference external" href="https://dask.org/">Dask</a> allowing for computation on a multi-core or cluster environment. This approach is best used for instances in which you hope to increase processing speeds with streaming data.</p>
<p>Here we share an example in which we demonstrate how to read Apache log data from Kafka, perform log parsing using CLX cyBERT and publish result data back to Kafka.</p>
<div class="section" id="Build-Quickstart-Docker-Image">
<h2>Build Quickstart Docker Image<a class="headerlink" href="#Build-Quickstart-Docker-Image" title="Permalink to this headline">¶</a></h2>
<p>For convenience, you can build a Docker image that will include a working environment that’s ready for running your pipeline. This image will contain all needed components including <a class="reference external" href="https://kafka.apache.org/">Kafka</a> and <a class="reference external" href="https://zookeeper.apache.org/">Zookeeper</a>. An example pipeline is also included on the container to demonstrate using cyBERT and Streamz to parse a sample of Apache logs.</p>
<p>Prerequisites: * NVIDIA Pascal™ GPU architecture or better * CUDA 10.1+ compatible NVIDIA driver * Ubuntu 16.04/18.04 or CentOS 7 * Docker CE v18+ * nvidia-docker v2+</p>
<p>Run the following to build the image:</p>
<p><code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">build</span> <span class="pre">-f</span> <span class="pre">examples/streamz/Dockerfile</span> <span class="pre">-t</span> <span class="pre">clx-streamz:latest</span> <span class="pre">.</span></code></p>
</div>
<div class="section" id="Running-cyBERT-Inference-Pipeline">
<h2>Running cyBERT Inference Pipeline<a class="headerlink" href="#Running-cyBERT-Inference-Pipeline" title="Permalink to this headline">¶</a></h2>
<p>For simplicity, our inference pipeline is started when the Docker container is created using the above image. The following shows the format of the <code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">run</span></code> to create your container.</p>
<p><strong>Preferred - Docker CE v19+ and nvidia-container-toolkit</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">docker</span> <span class="n">run</span> <span class="o">-</span><span class="n">it</span>
<span class="o">--</span><span class="n">gpus</span> <span class="s1">'"device=0,1,2"'</span> \
<span class="o">-</span><span class="n">p</span> <span class="mi">8787</span><span class="p">:</span><span class="mi">8787</span> \
<span class="o">--</span><span class="n">name</span> <span class="n">cybert</span><span class="o">-</span><span class="n">streamz</span>
<span class="o">-</span><span class="n">d</span> <span class="n">cybert</span><span class="o">-</span><span class="n">streamz</span><span class="p">:</span><span class="n">latest</span> \
<span class="o">--</span><span class="n">broker</span> <span class="n">localhost</span><span class="p">:</span><span class="mi">9092</span> \
<span class="o">--</span><span class="n">group_id</span> <span class="n">streamz</span> \
<span class="o">--</span><span class="n">input_topic</span> <span class="nb">input</span> \
<span class="o">--</span><span class="n">output_topic</span> <span class="n">output</span> \
<span class="o">--</span><span class="n">model_file</span> <span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">model</span><span class="o">.</span><span class="n">pth</span> \
<span class="o">--</span><span class="n">label_file</span> <span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">label</span><span class="o">.</span><span class="n">json</span> \
<span class="o">--</span><span class="n">poll_interval</span> <span class="mi">1</span><span class="n">s</span> \
<span class="o">--</span><span class="n">max_batch_size</span> <span class="mi">1000</span> \
<span class="o">--</span><span class="n">data</span> <span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">dataset</span>
</pre></div>
</div>
<p><strong>Legacy - Docker CE v18 and nvidia-docker2</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">docker</span> <span class="n">run</span> <span class="o">-</span><span class="n">it</span> \
<span class="o">--</span><span class="n">runtime</span><span class="o">=</span><span class="n">nvidia</span> \
<span class="o">-</span><span class="n">p</span> <span class="mi">8787</span><span class="p">:</span><span class="mi">8787</span> \
<span class="o">--</span><span class="n">name</span> <span class="n">cybert</span><span class="o">-</span><span class="n">streamz</span>
<span class="o">-</span><span class="n">d</span> <span class="n">cybert</span><span class="o">-</span><span class="n">streamz</span><span class="p">:</span><span class="n">latest</span> \
<span class="o">--</span><span class="n">broker</span> <span class="n">localhost</span><span class="p">:</span><span class="mi">9092</span> \
<span class="o">--</span><span class="n">group_id</span> <span class="n">streamz</span> \
<span class="o">--</span><span class="n">input_topic</span> <span class="nb">input</span> \
<span class="o">--</span><span class="n">output_topic</span> <span class="n">output</span> \
<span class="o">--</span><span class="n">model_file</span> <span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">model</span><span class="o">.</span><span class="n">pth</span> \
<span class="o">--</span><span class="n">label_file</span> <span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">label</span><span class="o">.</span><span class="n">json</span> \
<span class="o">--</span><span class="n">poll_interval</span> <span class="mi">1</span><span class="n">s</span> \
<span class="o">--</span><span class="n">max_batch_size</span> <span class="mi">1000</span> \
<span class="o">--</span><span class="n">data</span> <span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">dataset</span>
</pre></div>
</div>
<p><strong>Parameters:</strong> - <code class="docutils literal notranslate"><span class="pre">broker</span></code>* - Host and port where kafka broker is running - <code class="docutils literal notranslate"><span class="pre">group_id</span></code>* - Kafka <a class="reference external" href="https://docs.confluent.io/current/installation/configuration/consumer-configs.html#group.id">group id</a> that uniquely identifies the streamz data consumer. - <code class="docutils literal notranslate"><span class="pre">input_topic</span></code> - The name for the input topic to send the input dataset. Any name can be indicated here. - <code class="docutils literal notranslate"><span class="pre">output_topic</span></code> - The name for the output topic to send the output data. Any name can be indicated here. - <code class="docutils literal notranslate"><span class="pre">model_file</span></code> -
The path to your model file - <code class="docutils literal notranslate"><span class="pre">label_file</span></code> - The path to your label file - <code class="docutils literal notranslate"><span class="pre">poll_interval</span></code>* - Interval (in seconds) to poll the Kafka input topic for data - <code class="docutils literal notranslate"><span class="pre">max_batch_size</span></code>* - Max batch size of data (max number of logs) to ingest into streamz with each <code class="docutils literal notranslate"><span class="pre">poll_interval</span></code> - <code class="docutils literal notranslate"><span class="pre">data</span></code> - The input dataset to use for this streamz example. This is a filepath to text file containing lines of text to be processed for inference (i.e. log file)</p>
<p><code class="docutils literal notranslate"><span class="pre">*</span></code> = More information on these parameters can be found in the streamz <a class="reference external" href="https://streamz.readthedocs.io/en/latest/api.html#streamz.from_kafka_batched">documentation</a>.</p>
<p>The Dockerfile contains an ENTRYPOINT which calls <a class="reference external" href="https://github.com/rapidsai/clx/blob/branch-0.16/examples/streamz/scripts/entry.sh">entry.sh</a> to: 1. Download, install and configure Kafka 2. Run Kafka and Zookeeper 3. Create input and output Kafka topics 4. Read input data into input Kafka topic 5. Start cyBERT distributed inference using Dask (one worker per GPU)</p>
<p>View the data processing activity on the dask dashboard by visiting <a class="reference external" href="http://localhost:8787">http://localhost:8787</a> or <code class="docutils literal notranslate"><span class="pre">&lt;host&gt;:8787</span></code></p>
<p>View the cyBERT script output in the container logs</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">docker</span> <span class="n">logs</span> <span class="o">--</span><span class="n">follow</span> <span class="n">cybert</span><span class="o">-</span><span class="n">streamz</span>
</pre></div>
</div>
<p>Processed data will be pushed to the kafka topic named <code class="docutils literal notranslate"><span class="pre">output</span></code>. To view all processed output run:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">docker</span> <span class="n">exec</span> <span class="n">cybert</span><span class="o">-</span><span class="n">streamz</span> <span class="n">bash</span> <span class="o">-</span><span class="n">c</span> <span class="s1">'source activate rapids &amp;&amp; $KAFKA_HOME/bin/kafka-console-consumer.sh --bootstrap-server localhost:9092 --topic output --from-beginning'</span>
</pre></div>
</div>
</div>
<div class="section" id="Capturing-Benchmarks">
<h2>Capturing Benchmarks<a class="headerlink" href="#Capturing-Benchmarks" title="Permalink to this headline">¶</a></h2>
<p>To capture benchmarks add the benchmark flag along with average log size (kb), for throughput (mb/s) and average batch size (mb) estimates, to the docker run command above</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">docker</span> <span class="n">run</span> <span class="o">-</span><span class="n">it</span>
<span class="o">--</span><span class="n">gpus</span> <span class="s1">'"device=0,1,2"'</span> \
<span class="o">-</span><span class="n">p</span> <span class="mi">8787</span><span class="p">:</span><span class="mi">8787</span> \
<span class="o">--</span><span class="n">name</span> <span class="n">cybert</span><span class="o">-</span><span class="n">streamz</span> <span class="o">-</span><span class="n">d</span> <span class="n">cybert</span><span class="o">-</span><span class="n">streamz</span><span class="p">:</span><span class="n">latest</span> \
<span class="o">--</span><span class="n">broker</span> <span class="n">localhost</span><span class="p">:</span><span class="mi">9092</span> \
<span class="o">--</span><span class="n">group_id</span> <span class="n">streamz</span> \
<span class="o">--</span><span class="n">input_topic</span> <span class="nb">input</span> \
<span class="o">--</span><span class="n">output_topic</span> <span class="n">output</span> \
<span class="o">--</span><span class="n">model_file</span> <span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">model</span><span class="o">.</span><span class="n">pth</span> \
<span class="o">--</span><span class="n">label_file</span> <span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">label</span><span class="o">.</span><span class="n">json</span> \
<span class="o">--</span><span class="n">poll_interval</span> <span class="mi">1</span><span class="n">s</span> \
<span class="o">--</span><span class="n">max_batch_size</span> <span class="mi">1000</span> \
<span class="o">--</span><span class="n">data</span> <span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">dataset</span> \
<span class="o">--</span><span class="n">benchmark</span> <span class="mi">20</span>
</pre></div>
</div>
<p>To print benchmarks to the docker logs send a SIGINT signal to the running cybert process</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span># To get the PID
$ docker exec cybert-streamz ps aux | grep "cybert\.py" | awk '{print $2}'
# Kill process
$ docker exec cybert-streamz kill -SIGINT &lt;pid&gt;
$ docker logs cybert-streamz
</pre></div>
</div>
</div>
<div class="section" id="Run-cyBERT-Streamz-Example-on-Apache-Logs">
<h2>Run cyBERT Streamz Example on Apache Logs<a class="headerlink" href="#Run-cyBERT-Streamz-Example-on-Apache-Logs" title="Permalink to this headline">¶</a></h2>
<p>Your Quickstart Docker container includes the data and model required to run cyBERT stream processing on a sample of Apache logs.</p>
<p>The following command can be used to run the pipeline over two GPUs:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">docker</span> <span class="n">run</span> <span class="o">-</span><span class="n">it</span> <span class="o">--</span><span class="n">gpus</span> <span class="s1">'"device=0,1"'</span> \
<span class="o">-</span><span class="n">p</span> <span class="mi">9787</span><span class="p">:</span><span class="mi">8787</span> \
<span class="o">-</span><span class="n">v</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">efajardo</span><span class="o">/</span><span class="n">dockershare</span><span class="p">:</span><span class="o">/</span><span class="n">rapids</span><span class="o">/</span><span class="n">clx</span><span class="o">/</span><span class="n">my_data</span> \
<span class="o">--</span><span class="n">name</span> <span class="n">cybert_streamz</span> \
<span class="o">-</span><span class="n">d</span> <span class="n">clx</span><span class="o">-</span><span class="n">streamz</span><span class="p">:</span><span class="n">latest</span> \
<span class="o">-</span><span class="n">b</span> <span class="n">localhost</span><span class="p">:</span><span class="mi">9092</span> \
<span class="o">-</span><span class="n">g</span> <span class="n">streamz</span> \
<span class="o">-</span><span class="n">i</span> <span class="nb">input</span> \
<span class="o">-</span><span class="n">o</span> <span class="n">output</span> \
<span class="o">-</span><span class="n">d</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">cybert</span><span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">apache_raw_sample_1k</span><span class="o">.</span><span class="n">txt</span> \
<span class="o">-</span><span class="n">m</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">cybert</span><span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">pytorch_model</span><span class="o">.</span><span class="n">bin</span> \
<span class="o">-</span><span class="n">l</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">cybert</span><span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">config</span><span class="o">.</span><span class="n">json</span> \
<span class="o">-</span><span class="n">p</span> <span class="mi">1</span><span class="n">s</span> \
<span class="o">--</span><span class="n">max_batch_size</span> <span class="mi">500</span>
</pre></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
<footer>
<div aria-label="footer navigation" class="rst-footer-buttons" role="navigation">
<a accesskey="p" class="btn btn-neutral float-left" href="intro-clx-dga.html" rel="prev" title="CLX DGA Detection"><span class="fa fa-arrow-circle-left"></span> Previous</a>
</div>
<hr/>
<div role="contentinfo">
<p>
        
        © Copyright 2019, NVIDIA

    </p>
</div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
</div>
</div>
</section>
</div>
<script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
<script defer id="rapids-selector-js" src="/assets/js/custom.js"></script></body>
</html>